{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/constants/markets.ts"],"sourcesContent":["import { Market } from '@/features/trading/types';\n\nconst letterLogo = (text: string, bg: string, fg: string = '#0B0F1A') =>\n  `data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='64' height='64'><rect width='64' height='64' rx='32' ry='32' fill='${encodeURIComponent(\n    bg,\n  )}'/><text x='50%' y='54%' font-family='Inter,Arial,sans-serif' font-size='28' font-weight='700' fill='${encodeURIComponent(\n    fg,\n  )}' text-anchor='middle' dominant-baseline='middle'>${encodeURIComponent(text)}</text></svg>`;\n\nexport const ALL_MARKETS: Market[] = [\n  {\n    symbol: 'BTC',\n    tradingViewSymbol: 'BINANCE:BTCUSDT',\n    logoUrl:\n      'https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/bitcoin/info/logo.png',\n    binanceSymbol: 'BTCUSDT',\n    category: 'crypto',\n    maxLeverage: 100,\n  },\n  {\n    symbol: 'ETH',\n    tradingViewSymbol: 'BINANCE:ETHUSDT',\n    logoUrl:\n      'https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/info/logo.png',\n    binanceSymbol: 'ETHUSDT',\n    category: 'crypto',\n    maxLeverage: 100,\n  },\n  {\n    symbol: 'SOL',\n    tradingViewSymbol: 'BINANCE:SOLUSDT',\n    logoUrl:\n      'https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/solana/info/logo.png',\n    binanceSymbol: 'SOLUSDT',\n    category: 'crypto',\n    maxLeverage: 100,\n  },\n  {\n    symbol: 'AVAX',\n    tradingViewSymbol: 'BINANCE:AVAXUSDT',\n    logoUrl:\n      'https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/avalanchex/info/logo.png',\n    binanceSymbol: 'AVAXUSDT',\n    category: 'crypto',\n    maxLeverage: 100,\n  },\n  {\n    symbol: 'BNB',\n    tradingViewSymbol: 'BINANCE:BNBUSDT',\n    logoUrl:\n      'https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/binance/info/logo.png',\n    binanceSymbol: 'BNBUSDT',\n    category: 'crypto',\n    maxLeverage: 100,\n  },\n  {\n    symbol: 'XRP',\n    tradingViewSymbol: 'BINANCE:XRPUSDT',\n    logoUrl:\n      'https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ripple/info/logo.png',\n    binanceSymbol: 'XRPUSDT',\n    category: 'crypto',\n    maxLeverage: 100,\n  },\n  {\n    symbol: 'AAVE',\n    tradingViewSymbol: 'BINANCE:AAVEUSDT',\n    logoUrl:\n      'https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0x7Fc66500c84A76Ad7e9c93437bFc5Ac33E2DDaE9/logo.png',\n    binanceSymbol: 'AAVEUSDT',\n    category: 'crypto',\n    maxLeverage: 100,\n  },\n  {\n    symbol: 'ARB',\n    tradingViewSymbol: 'BINANCE:ARBUSDT',\n    logoUrl:\n      'https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/arbitrum/info/logo.png',\n    binanceSymbol: 'ARBUSDT',\n    category: 'crypto',\n    maxLeverage: 100,\n  },\n  {\n    symbol: 'CRV',\n    tradingViewSymbol: 'BINANCE:CRVUSDT',\n    logoUrl:\n      'https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0xD533a949740bb3306d119CC777fa900bA034cd52/logo.png',\n    binanceSymbol: 'CRVUSDT',\n    category: 'crypto',\n    maxLeverage: 100,\n  },\n  {\n    symbol: 'DOGE',\n    tradingViewSymbol: 'BINANCE:DOGEUSDT',\n    logoUrl:\n      'https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/doge/info/logo.png',\n    binanceSymbol: 'DOGEUSDT',\n    category: 'crypto',\n    maxLeverage: 100,\n  },\n  {\n    symbol: 'LINK',\n    tradingViewSymbol: 'BINANCE:LINKUSDT',\n    logoUrl:\n      'https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0x514910771AF9Ca656af840dff83E8264EcF986CA/logo.png',\n    binanceSymbol: 'LINKUSDT',\n    category: 'crypto',\n    maxLeverage: 100,\n  },\n  {\n    symbol: 'PEPE',\n    tradingViewSymbol: 'BINANCE:1000PEPEUSDT',\n    logoUrl:\n      'https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0x6982508145454Ce325dDbE47a25d4ec3d2311933/logo.png',\n    binanceSymbol: '1000PEPEUSDT',\n    category: 'crypto',\n    maxLeverage: 100,\n  },\n  // Forex\n  {\n    symbol: 'EURUSD',\n    tradingViewSymbol: 'OANDA:EURUSD',\n    logoUrl: letterLogo('€', '#C7D2FE', '#111827'),\n    category: 'forex',\n    maxLeverage: 100,\n  },\n  {\n    symbol: 'GBPUSD',\n    tradingViewSymbol: 'OANDA:GBPUSD',\n    logoUrl: letterLogo('£', '#BFDBFE', '#0B0F1A'),\n    category: 'forex',\n    maxLeverage: 100,\n  },\n  // Commodities\n  {\n    symbol: 'XAUUSD',\n    tradingViewSymbol: 'OANDA:XAUUSD',\n    logoUrl: letterLogo('Au', '#FDE68A', '#0B0F1A'),\n    category: 'commodities',\n    maxLeverage: 100,\n  },\n  {\n    symbol: 'XAGUSD',\n    tradingViewSymbol: 'OANDA:XAGUSD',\n    logoUrl: letterLogo('Ag', '#E5E7EB', '#0B0F1A'),\n    category: 'commodities',\n    maxLeverage: 100,\n  },\n  // Indices / ETFs\n  {\n    symbol: 'QQQUSD',\n    tradingViewSymbol: 'NASDAQ:QQQ',\n    logoUrl: letterLogo('QQQ', '#C084FC', '#0B0F1A'),\n    category: 'indices',\n    maxLeverage: 100,\n  },\n  {\n    symbol: 'SPYUSD',\n    tradingViewSymbol: 'AMEX:SPY',\n    logoUrl: letterLogo('SPY', '#A7F3D0', '#0B0F1A'),\n    category: 'indices',\n    maxLeverage: 100,\n  },\n  // Stocks\n  {\n    symbol: 'AAPLUSD',\n    tradingViewSymbol: 'NASDAQ:AAPL',\n    logoUrl: letterLogo('AAPL', '#D8B4FE', '#0B0F1A'),\n    category: 'stocks',\n    maxLeverage: 100,\n  },\n  {\n    symbol: 'GOOGLUSD',\n    tradingViewSymbol: 'NASDAQ:GOOGL',\n    logoUrl: letterLogo('GOOG', '#BFDBFE', '#0B0F1A'),\n    category: 'stocks',\n    maxLeverage: 100,\n  },\n];\n"],"names":[],"mappings":";;;;AAEA,MAAM,aAAa,CAAC,MAAc,IAAY,KAAa,SAAS,GAClE,CAAC,0IAA0I,EAAE,mBAC3I,IACA,qGAAqG,EAAE,mBACvG,IACA,kDAAkD,EAAE,mBAAmB,MAAM,aAAa,CAAC;AAExF,MAAM,cAAwB;IACnC;QACE,QAAQ;QACR,mBAAmB;QACnB,SACE;QACF,eAAe;QACf,UAAU;QACV,aAAa;IACf;IACA;QACE,QAAQ;QACR,mBAAmB;QACnB,SACE;QACF,eAAe;QACf,UAAU;QACV,aAAa;IACf;IACA;QACE,QAAQ;QACR,mBAAmB;QACnB,SACE;QACF,eAAe;QACf,UAAU;QACV,aAAa;IACf;IACA;QACE,QAAQ;QACR,mBAAmB;QACnB,SACE;QACF,eAAe;QACf,UAAU;QACV,aAAa;IACf;IACA;QACE,QAAQ;QACR,mBAAmB;QACnB,SACE;QACF,eAAe;QACf,UAAU;QACV,aAAa;IACf;IACA;QACE,QAAQ;QACR,mBAAmB;QACnB,SACE;QACF,eAAe;QACf,UAAU;QACV,aAAa;IACf;IACA;QACE,QAAQ;QACR,mBAAmB;QACnB,SACE;QACF,eAAe;QACf,UAAU;QACV,aAAa;IACf;IACA;QACE,QAAQ;QACR,mBAAmB;QACnB,SACE;QACF,eAAe;QACf,UAAU;QACV,aAAa;IACf;IACA;QACE,QAAQ;QACR,mBAAmB;QACnB,SACE;QACF,eAAe;QACf,UAAU;QACV,aAAa;IACf;IACA;QACE,QAAQ;QACR,mBAAmB;QACnB,SACE;QACF,eAAe;QACf,UAAU;QACV,aAAa;IACf;IACA;QACE,QAAQ;QACR,mBAAmB;QACnB,SACE;QACF,eAAe;QACf,UAAU;QACV,aAAa;IACf;IACA;QACE,QAAQ;QACR,mBAAmB;QACnB,SACE;QACF,eAAe;QACf,UAAU;QACV,aAAa;IACf;IACA,QAAQ;IACR;QACE,QAAQ;QACR,mBAAmB;QACnB,SAAS,WAAW,KAAK,WAAW;QACpC,UAAU;QACV,aAAa;IACf;IACA;QACE,QAAQ;QACR,mBAAmB;QACnB,SAAS,WAAW,KAAK,WAAW;QACpC,UAAU;QACV,aAAa;IACf;IACA,cAAc;IACd;QACE,QAAQ;QACR,mBAAmB;QACnB,SAAS,WAAW,MAAM,WAAW;QACrC,UAAU;QACV,aAAa;IACf;IACA;QACE,QAAQ;QACR,mBAAmB;QACnB,SAAS,WAAW,MAAM,WAAW;QACrC,UAAU;QACV,aAAa;IACf;IACA,iBAAiB;IACjB;QACE,QAAQ;QACR,mBAAmB;QACnB,SAAS,WAAW,OAAO,WAAW;QACtC,UAAU;QACV,aAAa;IACf;IACA;QACE,QAAQ;QACR,mBAAmB;QACnB,SAAS,WAAW,OAAO,WAAW;QACtC,UAAU;QACV,aAAa;IACf;IACA,SAAS;IACT;QACE,QAAQ;QACR,mBAAmB;QACnB,SAAS,WAAW,QAAQ,WAAW;QACvC,UAAU;QACV,aAAa;IACf;IACA;QACE,QAAQ;QACR,mBAAmB;QACnB,SAAS,WAAW,QAAQ,WAAW;QACvC,UAAU;QACV,aAAa;IACf;CACD"}},
    {"offset": {"line": 171, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/contexts/MarketContext.tsx"],"sourcesContent":["'use client';\n\nimport React, { createContext, useContext, useState, ReactNode } from 'react';\nimport { Market } from '@/features/trading/types';\nimport { ALL_MARKETS } from '@/features/trading/constants/markets';\n\ninterface SelectedPosition {\n  positionId: bigint;\n  symbol: string;\n  entryPrice: number;\n  isLong: boolean;\n}\n\ninterface MarketContextType {\n  activeMarket: Market;\n  setActiveMarket: (market: Market) => void;\n  currentPrice: string;\n  setCurrentPrice: (price: string) => void;\n  timeframe: string;\n  setTimeframe: (timeframe: string) => void;\n  selectedPosition: SelectedPosition | null;\n  setSelectedPosition: (position: SelectedPosition | null) => void;\n  chartPositions: boolean;\n  setChartPositions: (show: boolean) => void;\n}\n\nconst MarketContext = createContext<MarketContextType | undefined>(undefined);\n\nexport const MarketProvider: React.FC<{ children: ReactNode }> = ({ children }) => {\n  const [activeMarket, setActiveMarket] = useState<Market>(ALL_MARKETS[0]);\n  const [currentPrice, setCurrentPrice] = useState<string>('0');\n  const [timeframe, setTimeframe] = useState<string>('1'); // Default 1 minute\n  const [selectedPosition, setSelectedPosition] = useState<SelectedPosition | null>(null);\n  const [chartPositions, setChartPositions] = useState<boolean>(true);\n\n  return (\n    <MarketContext.Provider\n      value={{\n        activeMarket,\n        setActiveMarket,\n        currentPrice,\n        setCurrentPrice,\n        timeframe,\n        setTimeframe,\n        selectedPosition,\n        setSelectedPosition,\n        chartPositions,\n        setChartPositions,\n      }}\n    >\n      {children}\n    </MarketContext.Provider>\n  );\n};\n\nexport const useMarket = () => {\n  const context = useContext(MarketContext);\n  if (context === undefined) {\n    throw new Error('useMarket must be used within a MarketProvider');\n  }\n  return context;\n};\n"],"names":[],"mappings":";;;;;;;AAEA;AAEA;AAJA;;;;AA0BA,MAAM,8BAAgB,IAAA,sNAAa,EAAgC;AAE5D,MAAM,iBAAoD,CAAC,EAAE,QAAQ,EAAE;IAC5E,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAS,iKAAW,CAAC,EAAE;IACvE,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAS;IACzD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAS,MAAM,mBAAmB;IAC5E,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,iNAAQ,EAA0B;IAClF,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,iNAAQ,EAAU;IAE9D,qBACE,8OAAC,cAAc,QAAQ;QACrB,OAAO;YACL;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;QACF;kBAEC;;;;;;AAGP;AAEO,MAAM,YAAY;IACvB,MAAM,UAAU,IAAA,mNAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT"}},
    {"offset": {"line": 222, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/hooks/useGridTradingUI.ts"],"sourcesContent":["'use client';\n\nimport { useState, useCallback, useMemo } from 'react';\nimport {\n  GridConfig,\n  GridCell,\n  GridOrder,\n  TapToTradeState,\n  DEFAULT_GRID_CONFIG,\n} from '@/types/gridTrading';\n\ninterface UseGridTradingProps {\n  currentPrice: number;\n  interval: string; // Timeframe interval (1, 5, 15, 60, 240, D)\n}\n\nexport const useGridTrading = ({ currentPrice, interval }: UseGridTradingProps) => {\n  const [gridConfig, setGridConfig] = useState<GridConfig>(DEFAULT_GRID_CONFIG);\n  const [selectedCells, setSelectedCells] = useState<Set<string>>(new Set());\n  const [pendingOrders, setPendingOrders] = useState<GridOrder[]>([]);\n\n  // Calculate grid price levels based on current price and config\n  const calculatePriceLevels = useCallback(\n    (numLevels: number = 20): number[] => {\n      if (!currentPrice || currentPrice <= 0) return [];\n\n      const levels: number[] = [];\n      const { priceGridSize, priceGridType } = gridConfig;\n\n      for (let i = -numLevels; i <= numLevels; i++) {\n        let price: number;\n\n        if (priceGridType === 'percentage') {\n          // Percentage-based grid\n          const percentChange = (priceGridSize / 100) * i;\n          price = currentPrice * (1 + percentChange);\n        } else {\n          // Absolute value grid\n          price = currentPrice + priceGridSize * i;\n        }\n\n        levels.push(price);\n      }\n\n      return levels.sort((a, b) => b - a); // Sort descending (highest to lowest)\n    },\n    [currentPrice, gridConfig],\n  );\n\n  // Get interval in milliseconds\n  const getIntervalMs = useCallback((): number => {\n    const map: Record<string, number> = {\n      '1': 60 * 1000,\n      '3': 3 * 60 * 1000,\n      '5': 5 * 60 * 1000,\n      '15': 15 * 60 * 1000,\n      '30': 30 * 60 * 1000,\n      '60': 60 * 60 * 1000,\n      '120': 2 * 60 * 60 * 1000,\n      '240': 4 * 60 * 60 * 1000,\n      D: 24 * 60 * 60 * 1000,\n      W: 7 * 24 * 60 * 60 * 1000,\n    };\n    return (map[interval] || 60 * 60 * 1000) * gridConfig.timeMultiplier;\n  }, [interval, gridConfig.timeMultiplier]);\n\n  // Calculate grid cells based on visible chart area\n  const calculateGridCells = useCallback(\n    (visibleCandles: Array<{ time: number; close: number }>, priceLevels: number[]): GridCell[] => {\n      const cells: GridCell[] = [];\n      const intervalMs = getIntervalMs();\n\n      // For each visible time point (considering timeMultiplier)\n      for (let i = 0; i < visibleCandles.length; i += gridConfig.timeMultiplier) {\n        const candle = visibleCandles[i];\n\n        // For each price level\n        priceLevels.forEach((priceLevel, levelIndex) => {\n          const cellId = `cell-${i}-${levelIndex}`;\n          const isAboveCurrentPrice = priceLevel > currentPrice;\n\n          cells.push({\n            id: cellId,\n            timeIndex: i,\n            priceLevel,\n            timestamp: candle.time,\n            isAboveCurrentPrice,\n          });\n        });\n      }\n\n      return cells;\n    },\n    [currentPrice, getIntervalMs, gridConfig.timeMultiplier],\n  );\n\n  // Handle cell tap/click (simplified version)\n  const handleCellTap = useCallback(\n    (cellId: string, price: number, isAbovePrice: boolean) => {\n      if (!gridConfig.enabled) return;\n\n      setSelectedCells((prev) => {\n        const newSet = new Set(prev);\n\n        if (newSet.has(cellId)) {\n          // Remove cell and cancel order if exists\n          newSet.delete(cellId);\n          setPendingOrders((orders) => orders.filter((o) => o.cellId !== cellId));\n        } else {\n          // Add cell and create order\n          newSet.add(cellId);\n\n          const orderType = isAbovePrice ? 'sell' : 'buy';\n          const newOrder: GridOrder = {\n            cellId,\n            orderType,\n            price,\n            amount: 0, // Will be set by user or default\n            timestamp: Date.now(),\n            status: 'pending',\n          };\n\n          setPendingOrders((orders) => [...orders, newOrder]);\n        }\n\n        return newSet;\n      });\n    },\n    [gridConfig.enabled],\n  );\n\n  // Update grid configuration\n  const updateGridConfig = useCallback((updates: Partial<GridConfig>) => {\n    setGridConfig((prev) => ({ ...prev, ...updates }));\n  }, []);\n\n  // Toggle grid enabled state\n  const toggleGrid = useCallback(() => {\n    setGridConfig((prev) => ({ ...prev, enabled: !prev.enabled }));\n\n    if (gridConfig.enabled) {\n      // Disable grid - clear selections\n      setSelectedCells(new Set());\n      setPendingOrders([]);\n    }\n  }, [gridConfig.enabled]);\n\n  // Clear all selected cells\n  const clearAllCells = useCallback(() => {\n    setSelectedCells(new Set());\n    setPendingOrders([]);\n  }, []);\n\n  // Place orders (to be integrated with smart contract)\n  const placeGridOrders = useCallback(async () => {\n    // TODO: Integrate with smart contract to place orders\n    // For now, just log\n    pendingOrders.forEach((order) => {});\n  }, [pendingOrders]);\n\n  // Get statistics\n  const stats = useMemo(() => {\n    const buyOrders = pendingOrders.filter((o) => o.orderType === 'buy').length;\n    const sellOrders = pendingOrders.filter((o) => o.orderType === 'sell').length;\n\n    return {\n      totalCells: selectedCells.size,\n      buyOrders,\n      sellOrders,\n      totalOrders: pendingOrders.length,\n    };\n  }, [selectedCells, pendingOrders]);\n\n  return {\n    // State\n    gridConfig,\n    selectedCells,\n    pendingOrders,\n    stats,\n\n    // Calculations\n    calculatePriceLevels,\n    calculateGridCells,\n    getIntervalMs,\n\n    // Actions\n    handleCellTap,\n    updateGridConfig,\n    toggleGrid,\n    clearAllCells,\n    placeGridOrders,\n  };\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 403, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/wallet/hooks/useSessionKey.ts"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { keccak256, toHex, hashMessage, recoverMessageAddress, encodePacked } from 'viem';\nimport { privateKeyToAccount } from 'viem/accounts';\n\nexport interface SessionKey {\n  privateKey: `0x${string}`;\n  address: string;\n  expiresAt: number;\n  authorizedBy: string;\n  authSignature: string;\n  createdAt: number;\n}\n\nconst SESSION_STORAGE_KEY = 'dash_session_key';\nconst DEFAULT_SESSION_DURATION = 30 * 60 * 1000; // 30 minutes\n\nexport function useSessionKey() {\n  const [sessionKey, setSessionKey] = useState<SessionKey | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n\n  // Load session key from localStorage on mount\n  useEffect(() => {\n    const stored = localStorage.getItem(SESSION_STORAGE_KEY);\n    if (stored) {\n      try {\n        const parsed: SessionKey = JSON.parse(stored);\n        // Check if expired\n        if (parsed.expiresAt > Date.now()) {\n          setSessionKey(parsed);\n        } else {\n          localStorage.removeItem(SESSION_STORAGE_KEY);\n        }\n      } catch (err) {\n        console.error('Failed to parse session key:', err);\n        localStorage.removeItem(SESSION_STORAGE_KEY);\n      }\n    }\n  }, []);\n\n  /**\n   * Check if current session is valid (exists and not expired)\n   */\n  const isSessionValid = (): boolean => {\n    if (!sessionKey) return false;\n    if (sessionKey.expiresAt <= Date.now()) {\n      clearSession();\n      return false;\n    }\n    return true;\n  };\n\n  /**\n   * Create a new session key\n   * User must sign a message authorizing this ephemeral key\n   */\n  const createSession = async (\n    userAddress: string,\n    walletClient: any,\n    durationMs: number = DEFAULT_SESSION_DURATION,\n  ): Promise<SessionKey | null> => {\n    try {\n      setIsLoading(true);\n\n      // Generate random private key for session\n      const randomBytes = crypto.getRandomValues(new Uint8Array(32));\n      const privateKey = `0x${Array.from(randomBytes)\n        .map((b) => b.toString(16).padStart(2, '0'))\n        .join('')}` as `0x${string}`;\n\n      // Derive address from private key\n      const sessionAccount = privateKeyToAccount(privateKey);\n      const sessionAddress = sessionAccount.address;\n\n      const expiresAt = Date.now() + durationMs;\n      const expiresAtSeconds = Math.floor(expiresAt / 1000);\n\n      const authMessageHash = keccak256(\n        encodePacked(\n          ['string', 'address', 'string', 'uint256'],\n          [\n            'Authorize session key ',\n            sessionAddress as `0x${string}`,\n            ' for Dash Tap-to-Trade until ',\n            BigInt(expiresAtSeconds),\n          ],\n        ),\n      );\n\n      // User signs authorization (this is the ONLY signature needed!)\n      const authSignature = await walletClient.request({\n        method: 'personal_sign',\n        params: [authMessageHash, userAddress],\n      });\n\n      const newSession: SessionKey = {\n        privateKey,\n        address: sessionAddress,\n        expiresAt,\n        authorizedBy: userAddress.toLowerCase(),\n        authSignature: authSignature as string,\n        createdAt: Date.now(),\n      };\n\n      // Store in state and localStorage\n      setSessionKey(newSession);\n      localStorage.setItem(SESSION_STORAGE_KEY, JSON.stringify(newSession));\n\n      return newSession;\n    } catch (err: any) {\n      console.error('Session creation failed:', err);\n      return null;\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  /**\n   * Sign a message using the session key (no user prompt!)\n   * IMPORTANT: Uses hashMessage to match ethers.verifyMessage behavior\n   */\n  const signWithSession = async (messageHash: `0x${string}`): Promise<string | null> => {\n    if (!isSessionValid()) {\n      return null;\n    }\n\n    try {\n      const sessionAccount = privateKeyToAccount(sessionKey!.privateKey);\n\n      // Hash the message with Ethereum signed message prefix\n      // This creates the same hash that ethers.verifyMessage expects\n      const digest = hashMessage({ raw: messageHash });\n\n      // Sign the digest using raw ECDSA (no additional hashing)\n      const signature = await sessionAccount.sign({ hash: digest });\n\n      return signature;\n    } catch (err) {\n      console.error('Failed to sign with session:', err);\n      return null;\n    }\n  };\n\n  /**\n   * Clear current session\n   */\n  const clearSession = () => {\n    setSessionKey(null);\n    localStorage.removeItem(SESSION_STORAGE_KEY);\n  };\n\n  /**\n   * Get time remaining in session (milliseconds)\n   */\n  const getTimeRemaining = (): number => {\n    if (!sessionKey) return 0;\n    return Math.max(0, sessionKey.expiresAt - Date.now());\n  };\n\n  return {\n    sessionKey,\n    isSessionValid,\n    createSession,\n    signWithSession,\n    clearSession,\n    getTimeRemaining,\n    isLoading,\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 550, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/contexts/TapToTradeContext.tsx"],"sourcesContent":["'use client';\n\nimport React, { createContext, useContext, useState, ReactNode, useEffect, useRef } from 'react';\nimport { usePrivy, useWallets } from '@privy-io/react-auth';\nimport { keccak256, encodePacked, encodeFunctionData, toHex } from 'viem';\nimport { useSessionKey } from '@/features/wallet/hooks/useSessionKey';\nimport { TAP_TO_TRADE_EXECUTOR_ADDRESS, MARKET_EXECUTOR_ADDRESS } from '@/config/contracts';\n\ninterface GridSession {\n  id: string;\n  trader: string;\n  symbol: string;\n  marginTotal: string;\n  leverage: number;\n  timeframeSeconds: number;\n  gridSizeX: number;\n  gridSizeYPercent: number;\n  referenceTime: number;\n  referencePrice: string;\n  isActive: boolean;\n  createdAt: number;\n}\n\ninterface CellOrderInfo {\n  cellX: number;\n  cellY: number;\n  orderCount: number;\n  triggerPrice: string;\n  startTime: number;\n  endTime: number;\n  isLong: boolean;\n}\n\ntype TradeMode = 'open-position' | 'one-tap-profit';\n\ninterface TapToTradeContextType {\n  // Mode state\n  isEnabled: boolean;\n  tradeMode: TradeMode;\n  setTradeMode: (mode: TradeMode) => void;\n  toggleMode: (params?: {\n    symbol: string;\n    margin: string;\n    leverage: number;\n    timeframe: string;\n    currentPrice: number;\n  }) => Promise<void>;\n\n  // Binary trading state (for OneTapProfit mode)\n  isBinaryTradingEnabled: boolean;\n  setIsBinaryTradingEnabled: (enabled: boolean) => void;\n\n  // Grid settings\n  gridSizeX: number; // Number of candles per grid column\n  gridSizeY: number; // Price step per grid row (in %)\n  setGridSizeX: (size: number) => void;\n  setGridSizeY: (size: number) => void;\n\n  // Bet amount for OneTapProfit mode\n  betAmount: string;\n  setBetAmount: (amount: string) => void;\n\n  // Cell interactions - NEW: immediate order creation\n  handleCellClick: (cellX: number, cellY: number) => Promise<void>;\n  cellOrders: Map<string, CellOrderInfo>; // Track orders per cell\n\n  // Session key state\n  sessionKey: any | null; // Session key for signature-less trading\n  sessionTimeRemaining: number; // Time remaining in milliseconds\n  signWithSession: (messageHash: `0x${string}`) => Promise<string | null>;\n  createSession: (\n    userAddress: string,\n    walletClient: any,\n    durationMs?: number,\n  ) => Promise<any | null>;\n\n  // Backend integration\n  gridSession: GridSession | null;\n  isLoading: boolean;\n  error: string | null;\n}\n\nconst TapToTradeContext = createContext<TapToTradeContextType | undefined>(undefined);\n\nconst BACKEND_API_URL = process.env.NEXT_PUBLIC_BACKEND_URL || 'http://localhost:3001';\nconst EXPECTED_CHAIN_ID = BigInt(process.env.NEXT_PUBLIC_CHAIN_ID || '84532');\nconst RPC_URL = process.env.NEXT_PUBLIC_RPC_URL;\n\nexport const TapToTradeProvider: React.FC<{ children: ReactNode }> = ({ children }) => {\n  const { user } = usePrivy();\n  const { wallets } = useWallets();\n  const [isEnabled, setIsEnabled] = useState(false);\n  const [tradeMode, setTradeMode] = useState<TradeMode>('one-tap-profit');\n  const [gridSizeX, setGridSizeX] = useState(1); // 1 candle per column by default\n  const [gridSizeY, setGridSizeY] = useState(0); // 0.5% per row by default\n  const [cellOrders, setCellOrders] = useState<Map<string, CellOrderInfo>>(new Map());\n  const [betAmount, setBetAmount] = useState('10'); // Default 10 USDC for OneTapProfit\n  const [isBinaryTradingEnabled, setIsBinaryTradingEnabled] = useState(false); // Binary trading toggle\n\n  // Backend integration state\n  const [gridSession, setGridSession] = useState<GridSession | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Track nonce locally to avoid race conditions with multiple orders\n  const [localNonce, setLocalNonce] = useState<bigint>(BigInt(0));\n  const [isCreatingOrder, setIsCreatingOrder] = useState(false);\n  const resignIntervalRef = useRef<NodeJS.Timeout | null>(null);\n  const attemptedResignOrders = useRef<Set<string>>(new Set()); // Track orders we've already attempted to re-sign\n\n  // Session key for signature-less tap-to-trade\n  const {\n    sessionKey,\n    isSessionValid,\n    createSession,\n    signWithSession,\n    clearSession,\n    getTimeRemaining,\n  } = useSessionKey();\n\n  /**\n   * Initialize nonce from contract\n   */\n  const initializeNonce = async () => {\n    try {\n      const embeddedWallet = wallets.find((w) => w.walletClientType === 'privy');\n      if (!embeddedWallet) {\n        console.warn('Cannot initialize nonce: embedded wallet not found');\n        return;\n      }\n\n      const traderAddress = embeddedWallet.address;\n      const walletClient = await embeddedWallet.getEthereumProvider();\n      if (!walletClient) {\n        console.warn('Cannot initialize nonce: wallet client not available');\n        return;\n      }\n\n      const MarketExecutorABI = [\n        {\n          inputs: [{ name: '', type: 'address' }],\n          name: 'metaNonces',\n          outputs: [{ name: '', type: 'uint256' }],\n          stateMutability: 'view',\n          type: 'function',\n        },\n      ];\n\n      const nonceData = encodeFunctionData({\n        abi: MarketExecutorABI,\n        functionName: 'metaNonces',\n        args: [traderAddress as `0x${string}`],\n      });\n\n      const nonceResult = await walletClient.request({\n        method: 'eth_call',\n        params: [\n          {\n            to: TAP_TO_TRADE_EXECUTOR_ADDRESS,\n            data: nonceData,\n          },\n          'latest',\n        ],\n      });\n\n      // Handle empty result (0x means 0)\n      const currentNonce =\n        nonceResult === '0x' || !nonceResult ? BigInt(0) : BigInt(nonceResult as string);\n\n      setLocalNonce(currentNonce);\n    } catch (err) {\n      console.error('Failed to initialize nonce:', err);\n    }\n  };\n\n  // NOTE: authorizeSessionKeyOnChain() removed for 100% gasless experience\n  // Session keys are validated off-chain by backend only\n  // Contract execution happens via keeper role (backend pays gas)\n\n  /**\n   * Auto re-sign orders that need re-signing (nonce mismatch)\n   */\n  const checkAndResignOrders = async () => {\n    if (!isEnabled || !gridSession || !user?.wallet?.address) {\n      return;\n    }\n\n    try {\n      // Get Privy embedded wallet\n      const embeddedWallet = wallets.find((w) => w.walletClientType === 'privy');\n      if (!embeddedWallet) {\n        return;\n      }\n\n      const traderAddress = embeddedWallet.address;\n\n      // Fetch orders that need re-signing\n      const response = await fetch(\n        `${BACKEND_API_URL}/api/tap-to-trade/orders?trader=${traderAddress}&status=NEEDS_RESIGN`,\n      );\n      const result = await response.json();\n\n      if (!result.success || !result.data || result.data.length === 0) {\n        return;\n      }\n\n      // Re-sign each order (only once per order)\n      for (const order of result.data) {\n        // Skip if we've already attempted to re-sign this order\n        if (attemptedResignOrders.current.has(order.id)) {\n          continue;\n        }\n\n        // Mark as attempted\n        attemptedResignOrders.current.add(order.id);\n        try {\n          const walletClient = await embeddedWallet.getEthereumProvider();\n          if (!walletClient) {\n            continue;\n          }\n\n          // Fetch fresh nonce\n          const MarketExecutorABI = [\n            {\n              inputs: [{ name: '', type: 'address' }],\n              name: 'metaNonces',\n              outputs: [{ name: '', type: 'uint256' }],\n              stateMutability: 'view',\n              type: 'function',\n            },\n          ];\n\n          const nonceData = encodeFunctionData({\n            abi: MarketExecutorABI,\n            functionName: 'metaNonces',\n            args: [traderAddress as `0x${string}`],\n          });\n\n          const nonceResult = await walletClient.request({\n            method: 'eth_call',\n            params: [\n              {\n                to: TAP_TO_TRADE_EXECUTOR_ADDRESS,\n                data: nonceData,\n              },\n              'latest',\n            ],\n          });\n\n          // Handle empty result (0x means 0)\n          const freshNonce =\n            nonceResult === '0x' || !nonceResult ? BigInt(0) : BigInt(nonceResult as string);\n\n          // Create new signature with fresh nonce\n          const messageHash = keccak256(\n            encodePacked(\n              ['address', 'string', 'bool', 'uint256', 'uint256', 'uint256', 'address'],\n              [\n                traderAddress as `0x${string}`,\n                order.symbol,\n                order.isLong,\n                BigInt(order.collateral),\n                BigInt(order.leverage),\n                freshNonce,\n                TAP_TO_TRADE_EXECUTOR_ADDRESS as `0x${string}`,\n              ],\n            ),\n          );\n\n          // User will see signature request popup here\n          const newSignature = await walletClient.request({\n            method: 'personal_sign',\n            params: [messageHash, traderAddress],\n          });\n\n          // Update signature in backend\n          const updateResponse = await fetch(\n            `${BACKEND_API_URL}/api/tap-to-trade/update-signature`,\n            {\n              method: 'POST',\n              headers: { 'Content-Type': 'application/json' },\n              body: JSON.stringify({\n                orderId: order.id,\n                nonce: freshNonce.toString(),\n                signature: newSignature,\n                trader: traderAddress,\n              }),\n            },\n          );\n\n          const updateResult = await updateResponse.json();\n          if (updateResult.success) {\n            // Remove from attempted list on success so it can be re-attempted if needed again\n            attemptedResignOrders.current.delete(order.id);\n          } else {\n            console.error(\n              `\\u274c Failed to update signature for order ${order.id}:`,\n              updateResult.error,\n            );\n          }\n        } catch (err: any) {\n          // User cancelled signature or error occurred\n          if (err.code === 4001 || err.message?.includes('User rejected')) {\n            console.warn(`\\u274c User cancelled re-signing order ${order.id}`);\n            // Mark as cancelled in backend\n            try {\n              await fetch(`${BACKEND_API_URL}/api/tap-to-trade/cancel-order`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                  orderId: order.id,\n                  trader: traderAddress,\n                }),\n              });\n            } catch (cancelErr) {\n              console.error('Failed to cancel order:', cancelErr);\n            }\n          } else {\n            console.error(`\\u274c Error re-signing order ${order.id}:`, err);\n          }\n        }\n      }\n    } catch (err) {\n      console.error('Error checking for orders to re-sign:', err);\n    }\n  };\n\n  // Poll for orders that need re-signing\n  useEffect(() => {\n    if (isEnabled && gridSession) {\n      // Check immediately\n      checkAndResignOrders();\n\n      // Then check every 15 seconds (not too frequent to avoid spam)\n      resignIntervalRef.current = setInterval(checkAndResignOrders, 15000);\n\n      return () => {\n        if (resignIntervalRef.current) {\n          clearInterval(resignIntervalRef.current);\n        }\n      };\n    }\n  }, [isEnabled, gridSession, user?.wallet?.address, wallets]);\n\n  // Auto-disable tap-to-trade when session expires\n  useEffect(() => {\n    if (!isEnabled || !sessionKey) return;\n\n    const checkSessionExpiry = () => {\n      if (!isSessionValid()) {\n        // Auto-disable tap-to-trade mode\n        toggleMode();\n      }\n    };\n\n    // Check every 10 seconds\n    const interval = setInterval(checkSessionExpiry, 10000);\n\n    return () => clearInterval(interval);\n  }, [isEnabled, sessionKey, isSessionValid]);\n\n  const toggleMode = async (params?: {\n    symbol: string;\n    margin: string;\n    leverage: number;\n    timeframe: string;\n    currentPrice: number;\n  }) => {\n    if (isEnabled) {\n      // DISABLE mode - Cancel grid session\n      if (gridSession) {\n        try {\n          setIsLoading(true);\n\n          // Get Privy embedded wallet\n          const embeddedWallet = wallets.find((w) => w.walletClientType === 'privy');\n          const traderAddress = embeddedWallet?.address || gridSession.trader;\n\n          await fetch(`${BACKEND_API_URL}/api/grid/cancel-session`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n              gridId: gridSession.id,\n              trader: traderAddress,\n            }),\n          });\n\n          setGridSession(null);\n        } catch (err: any) {\n          console.error('Failed to cancel grid session:', err);\n        } finally {\n          setIsLoading(false);\n        }\n      }\n\n      // Clear cell orders when disabling\n      setCellOrders(new Map());\n      setIsEnabled(false);\n      setError(null);\n      setLocalNonce(BigInt(0)); // Reset nonce\n      attemptedResignOrders.current.clear(); // Clear attempted re-sign tracking\n\n      // Clear session key\n      if (sessionKey) {\n        clearSession();\n      }\n    } else {\n      // ENABLE mode - Create grid session\n      if (!params) {\n        setError('Missing parameters to enable tap-to-trade');\n        return;\n      }\n\n      if (!user?.wallet?.address) {\n        setError('Wallet not connected');\n        return;\n      }\n\n      // Get Privy embedded wallet for tap-to-trade\n      const embeddedWallet = wallets.find((w) => w.walletClientType === 'privy');\n      if (!embeddedWallet) {\n        setError('Privy embedded wallet not found. Tap-to-trade requires Privy AA wallet.');\n        return;\n      }\n\n      const traderAddress = embeddedWallet.address;\n\n      setIsLoading(true);\n      setError(null);\n\n      try {\n        // Convert timeframe to seconds\n        const timeframeMap: { [key: string]: number } = {\n          '1': 60,\n          '5': 300,\n          '15': 900,\n          '30': 1800,\n          '60': 3600,\n          '240': 14400,\n          D: 86400,\n          W: 604800,\n        };\n        const timeframeSeconds = timeframeMap[params.timeframe] || 60;\n\n        // Convert price to 8 decimals (contract format)\n        const priceWith8Decimals = Math.round(params.currentPrice * 100000000).toString();\n\n        // Convert margin to base units (6 decimals for USDC)\n        const marginInBaseUnits = (parseFloat(params.margin) * 1000000).toString();\n\n        // Convert gridSizeY from % to basis points (0.5% = 50 basis points)\n        const gridSizeYPercent = Math.round(gridSizeY * 100);\n\n        // Calculate reference time - snap to start of current timeframe window\n        const nowSeconds = Math.floor(Date.now() / 1000);\n        const columnDurationSeconds = gridSizeX * timeframeSeconds;\n        const referenceTimeSnapped =\n          Math.floor(nowSeconds / columnDurationSeconds) * columnDurationSeconds;\n\n        const response = await fetch(`${BACKEND_API_URL}/api/grid/create-session`, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            trader: traderAddress,\n            symbol: params.symbol,\n            marginTotal: marginInBaseUnits,\n            leverage: params.leverage,\n            timeframeSeconds,\n            gridSizeX,\n            gridSizeYPercent,\n            referenceTime: referenceTimeSnapped,\n            referencePrice: priceWith8Decimals,\n          }),\n        });\n\n        const result = await response.json();\n\n        if (!result.success) {\n          throw new Error(result.error || 'Failed to create grid session');\n        }\n\n        const session = result.data as GridSession;\n        setGridSession(session);\n\n        setIsEnabled(true);\n\n        // Initialize nonce from contract when enabling\n        await initializeNonce();\n\n        // Create session key ONLY for open-position mode (tap-to-trade)\n        // One Tap Profit mode doesn't need session key (signs each trade)\n        if (tradeMode === 'open-position') {\n          try {\n            const walletClient = await embeddedWallet.getEthereumProvider();\n            if (!walletClient) {\n              throw new Error('Could not get wallet client');\n            }\n\n            const newSession = await createSession(\n              traderAddress,\n              walletClient,\n              30 * 60 * 1000, // 30 minutes\n            );\n\n            if (!newSession) {\n              throw new Error('Failed to create session key');\n            }\n\n            // Step 2: Register session key with backend (NO ON-CHAIN TX!)\n\n            try {\n              // We skip on-chain authorization for 100% gasless experience\n              // Backend will validate session signature for each order\n              const sessionDurationSeconds = 30 * 60; // 30 minutes in seconds\n              const expiresAtSeconds = Math.floor(newSession.expiresAt / 1000);\n\n              // Create authorization message EXACTLY matching smart contract format\n              // Smart contract uses: keccak256(abi.encodePacked(\"Authorize session key \", address, \" for Dash Tap-to-Trade until \", uint256))\n              // We need to encode address and uint256 as bytes, not as string!\n\n              // IMPORTANT: Convert address to checksum format\n              const sessionAddressChecksum = newSession.address as `0x${string}`;\n\n              const authMessageHash = keccak256(\n                encodePacked(\n                  ['string', 'address', 'string', 'uint256'],\n                  [\n                    'Authorize session key ',\n                    sessionAddressChecksum,\n                    ' for Dash Tap-to-Trade until ',\n                    BigInt(expiresAtSeconds),\n                  ],\n                ),\n              );\n\n              // IMPORTANT: Use the authSignature that was already created in createSession()\n              // Don't sign again here - it will create different signature!\n              const authSignature = newSession.authSignature;\n\n              // DEBUG: Verify signature locally before sending to contract\n              try {\n                const { recoverMessageAddress } = await import('viem');\n                const recovered = await recoverMessageAddress({\n                  message: { raw: authMessageHash },\n                  signature: authSignature as `0x${string}`,\n                });\n\n                if (recovered.toLowerCase() !== traderAddress.toLowerCase()) {\n                  throw new Error(\n                    `Signature mismatch! Recovered: ${recovered}, Expected: ${traderAddress}`,\n                  );\n                }\n              } catch (verifyErr: any) {\n                console.error('❌ Local verification failed:', verifyErr);\n                throw verifyErr;\n              }\n\n              // Call authorizeSessionKey on TapToTradeExecutor contract\n              const TapToTradeExecutorABI = [\n                {\n                  inputs: [\n                    { name: 'sessionKeyAddress', type: 'address' },\n                    { name: 'duration', type: 'uint256' },\n                    { name: 'authSignature', type: 'bytes' },\n                  ],\n                  name: 'authorizeSessionKey',\n                  outputs: [],\n                  stateMutability: 'nonpayable',\n                  type: 'function',\n                },\n              ];\n\n              const authData = encodeFunctionData({\n                abi: TapToTradeExecutorABI,\n                functionName: 'authorizeSessionKey',\n                args: [\n                  newSession.address as `0x${string}`,\n                  BigInt(sessionDurationSeconds),\n                  authSignature as `0x${string}`,\n                ],\n              });\n\n              // Send authorization request to backend\n              // Backend will call authorizeSessionKey() on contract and pay gas!\n              // Skip backend authorization - we only need local session storage!\n              // Backend will validate session signature when orders are executed\n\n              // No need to call backend for authorization\n              // Session is stored in localStorage and validated by backend on each order\n            } catch (authErr: any) {\n              clearSession();\n              throw new Error(`Session setup failed: ${authErr.message}. Please try again.`);\n            }\n          } catch (sessionErr: any) {\n            // Don't fail the entire enable if session creation fails\n            // User can still use with regular signatures\n            setError(`Session setup failed: ${sessionErr.message}`);\n          }\n        } else {\n        }\n      } catch (err: any) {\n        setError(err.message || 'Failed to enable tap-to-trade');\n      } finally {\n        setIsLoading(false);\n      }\n    }\n  };\n\n  /**\n   * Handle cell click - immediately create order in backend\n   * Each click creates a new order (accumulate, not toggle)\n   */\n  const handleCellClick = async (cellX: number, cellY: number) => {\n    if (!isEnabled || !gridSession || !user?.wallet?.address) {\n      console.warn('Cannot create order: mode not enabled or session not found');\n      return;\n    }\n\n    // Prevent multiple orders from being created simultaneously (nonce collision)\n    if (isCreatingOrder) {\n      console.warn('⏳ Please wait, another order is being created...');\n      return;\n    }\n\n    setIsCreatingOrder(true);\n    setIsLoading(true);\n    setError(null);\n\n    try {\n      // Calculate trigger price based on grid position\n      const referencePrice = parseFloat(gridSession.referencePrice) / 100000000; // Convert from 8 decimals\n      const gridSizeYPercent = gridSession.gridSizeYPercent / 100; // Convert from basis points to %\n      const priceChange = ((cellY * gridSizeYPercent) / 100) * referencePrice;\n      const triggerPrice = referencePrice + priceChange;\n      const triggerPriceWith8Decimals = Math.round(triggerPrice * 100000000).toString();\n\n      // Calculate time window based on grid position\n      const columnDurationSeconds = Math.max(\n        1,\n        gridSession.gridSizeX * gridSession.timeframeSeconds,\n      );\n      const startTime = gridSession.referenceTime + cellX * columnDurationSeconds;\n      const endTime = startTime + columnDurationSeconds;\n\n      // Determine if LONG or SHORT based on trigger price vs reference price\n      // LONG: buy when price is LOW (trigger below reference) - profit when price goes UP\n      // SHORT: sell when price is HIGH (trigger above reference) - profit when price goes DOWN\n      const isLong = cellY < 0; // Below reference = LONG, Above reference = SHORT\n\n      // Each cell click = 1 full order with entire margin amount\n      // If user taps same cell 2x, it creates 2 separate orders with full margin each\n      const collateralPerOrder = gridSession.marginTotal;\n\n      // ALWAYS use Privy embedded wallet for tap-to-trade (gasless with AA)\n      const embeddedWallet = wallets.find((w) => w.walletClientType === 'privy');\n\n      if (!embeddedWallet) {\n        console.error('❌ No Privy embedded wallet found in wallets array');\n        throw new Error('Privy embedded wallet not found. Tap-to-trade requires Privy AA wallet.');\n      }\n\n      // Use embedded wallet address as trader (not the currently active wallet)\n      const traderAddress = embeddedWallet.address;\n\n      // Get wallet provider (EIP-1193)\n      const walletClient = await embeddedWallet.getEthereumProvider();\n      if (!walletClient) {\n        throw new Error('Could not get wallet client');\n      }\n\n      // ALWAYS fetch fresh nonce from contract for each order\n      // This prevents signature failures due to stale nonce\n      const MarketExecutorABI = [\n        {\n          inputs: [{ name: '', type: 'address' }],\n          name: 'metaNonces',\n          outputs: [{ name: '', type: 'uint256' }],\n          stateMutability: 'view',\n          type: 'function',\n        },\n      ];\n\n      const nonceData = encodeFunctionData({\n        abi: MarketExecutorABI,\n        functionName: 'metaNonces',\n        args: [traderAddress as `0x${string}`],\n      });\n\n      const nonceResult = await walletClient.request({\n        method: 'eth_call',\n        params: [\n          {\n            to: TAP_TO_TRADE_EXECUTOR_ADDRESS,\n            data: nonceData,\n          },\n          'latest',\n        ],\n      });\n\n      // Handle empty result (0x means 0)\n      const currentNonce =\n        nonceResult === '0x' || !nonceResult ? BigInt(0) : BigInt(nonceResult as string);\n\n      // Sign order message\n      const messageHash = keccak256(\n        encodePacked(\n          ['address', 'string', 'bool', 'uint256', 'uint256', 'uint256', 'address'],\n          [\n            traderAddress as `0x${string}`,\n            gridSession.symbol,\n            isLong,\n            BigInt(collateralPerOrder),\n            BigInt(gridSession.leverage),\n            currentNonce,\n            TAP_TO_TRADE_EXECUTOR_ADDRESS as `0x${string}`,\n          ],\n        ),\n      );\n\n      let signature: string;\n      let usedSessionKey = false; // Track if we actually used session key\n\n      // Use session key if available and valid (NO POPUP!)\n      if (isSessionValid()) {\n        const sessionSignature = await signWithSession(messageHash);\n\n        if (!sessionSignature) {\n          console.warn('⚠️ Session signature failed, falling back to traditional signature...');\n          // Fallback to traditional signature if session fails\n          const userSignature = await walletClient.request({\n            method: 'personal_sign',\n            params: [messageHash, traderAddress],\n          });\n          signature = userSignature as string;\n          usedSessionKey = false;\n        } else {\n          signature = sessionSignature;\n          usedSessionKey = true; // Mark that we used session key\n        }\n      } else {\n        // Fallback: request signature from user (with popup)\n        const userSignature = await walletClient.request({\n          method: 'personal_sign',\n          params: [messageHash, traderAddress],\n        });\n\n        if (!userSignature) {\n          throw new Error('Failed to obtain signature');\n        }\n\n        signature = userSignature as string;\n      }\n\n      // Create order in backend\n      const cellId = `${cellX},${cellY}`;\n\n      // Prepare order data with optional session key info\n      const orderData: any = {\n        gridSessionId: gridSession.id,\n        cellId,\n        trader: traderAddress,\n        symbol: gridSession.symbol,\n        isLong,\n        collateral: collateralPerOrder,\n        leverage: gridSession.leverage,\n        triggerPrice: triggerPriceWith8Decimals,\n        startTime,\n        endTime,\n        nonce: currentNonce.toString(),\n        signature,\n      };\n\n      // ONLY add session key info if we actually used session key for signing\n      if (usedSessionKey && sessionKey) {\n        orderData.sessionKey = {\n          address: sessionKey.address,\n          expiresAt: sessionKey.expiresAt,\n          authorizedBy: sessionKey.authorizedBy,\n          authSignature: sessionKey.authSignature,\n        };\n      }\n\n      const response = await fetch(`${BACKEND_API_URL}/api/tap-to-trade/batch-create`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          gridSessionId: gridSession.id,\n          orders: [orderData],\n        }),\n      });\n\n      const result = await response.json();\n\n      if (!result.success) {\n        throw new Error(result.error || 'Failed to create order');\n      }\n\n      // Update cell order count for visual feedback\n      setCellOrders((prev) => {\n        const newMap = new Map(prev);\n        const existing = newMap.get(cellId);\n        if (existing) {\n          newMap.set(cellId, {\n            ...existing,\n            orderCount: existing.orderCount + 1,\n          });\n        } else {\n          newMap.set(cellId, {\n            cellX,\n            cellY,\n            orderCount: 1,\n            triggerPrice: triggerPriceWith8Decimals,\n            startTime,\n            endTime,\n            isLong,\n          });\n        }\n        return newMap;\n      });\n    } catch (err: any) {\n      setError(err.message || 'Failed to create order');\n      console.error('Failed to create order:', err);\n    } finally {\n      setIsLoading(false);\n      setIsCreatingOrder(false);\n    }\n  };\n\n  return (\n    <TapToTradeContext.Provider\n      value={{\n        isEnabled,\n        tradeMode,\n        setTradeMode,\n        toggleMode,\n        gridSizeX,\n        gridSizeY,\n        setGridSizeX,\n        setGridSizeY,\n        betAmount,\n        setBetAmount,\n        handleCellClick,\n        cellOrders,\n        sessionKey,\n        sessionTimeRemaining: getTimeRemaining(),\n        gridSession,\n        isLoading,\n        error,\n        isBinaryTradingEnabled,\n        setIsBinaryTradingEnabled,\n        signWithSession,\n        createSession, // Export createSession\n      }}\n    >\n      {children}\n    </TapToTradeContext.Provider>\n  );\n};\n\nexport const useTapToTrade = () => {\n  const context = useContext(TapToTradeContext);\n  if (context === undefined) {\n    throw new Error('useTapToTrade must be used within a TapToTradeProvider');\n  }\n  return context;\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1305, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/hooks/useMarketWebSocket.ts"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { FuturesData, MarketData, Market } from '@/features/trading/types';\n\ninterface OraclePrice {\n  symbol: string;\n  price: number;\n  confidence?: number;\n  timestamp: number;\n  source: string;\n}\n\ninterface UseMarketWebSocketReturn {\n  allPrices: Record<string, string>;\n  marketDataMap: Record<string, MarketData>;\n  futuresDataMap: Record<string, FuturesData>;\n  oraclePrices: Record<string, OraclePrice>;\n}\n\n/**\n * Custom hook to manage WebSocket connections for market data\n * Handles both Binance spot prices and Pyth Oracle prices\n */\nexport function useMarketWebSocket(markets: Market[]): UseMarketWebSocketReturn {\n  const [allPrices, setAllPrices] = useState<Record<string, string>>({});\n  const [marketDataMap, setMarketDataMap] = useState<Record<string, MarketData>>({});\n  const [futuresDataMap, setFuturesDataMap] = useState<Record<string, FuturesData>>({});\n  const [oraclePrices, setOraclePrices] = useState<Record<string, OraclePrice>>({});\n\n  // Seed oracle prices from REST once (covers new env feeds before WS ticks)\n  useEffect(() => {\n    const seedOracle = async () => {\n      try {\n        const backendUrl = process.env.NEXT_PUBLIC_BACKEND_URL || 'http://localhost:3001';\n        const res = await fetch(`${backendUrl}/api/price/all`);\n        if (!res.ok) return;\n        const body = await res.json();\n        if (body?.data) {\n          const seeded: Record<string, OraclePrice> = {};\n          Object.keys(body.data).forEach((symbol: string) => {\n            const p = body.data[symbol];\n            seeded[symbol.toUpperCase()] = {\n              symbol: p.symbol || symbol.toUpperCase(),\n              price: p.price,\n              confidence: p.confidence,\n              timestamp: p.timestamp,\n              source: p.source || 'pyth',\n            };\n          });\n          setOraclePrices((prev) => ({ ...prev, ...seeded }));\n        }\n      } catch (err) {\n        console.warn('Seed oracle price failed', err);\n      }\n    };\n    seedOracle();\n  }, []);\n\n  // Fetch Futures Data (Funding Rate, Open Interest)\n  useEffect(() => {\n    const fetchFuturesData = async () => {\n      try {\n        const symbols = markets.map((m) => m.binanceSymbol);\n\n        const results = await Promise.all(\n          symbols.map(async (symbol) => {\n            if (!symbol) return null;\n            try {\n              // Fetch funding rate\n              const fundingResponse = await fetch(\n                `https://fapi.binance.com/fapi/v1/premiumIndex?symbol=${symbol}`,\n              );\n              const fundingData = await fundingResponse.json();\n\n              // Fetch open interest\n              const oiResponse = await fetch(\n                `https://fapi.binance.com/fapi/v1/openInterest?symbol=${symbol}`,\n              );\n              const oiData = await oiResponse.json();\n\n              // Get current price for OI value calculation\n              const priceResponse = await fetch(\n                `https://fapi.binance.com/fapi/v1/ticker/price?symbol=${symbol}`,\n              );\n              const priceData = await priceResponse.json();\n\n              const openInterestValue = (\n                parseFloat(oiData.openInterest || '0') * parseFloat(priceData.price || '0')\n              ).toString();\n\n              return {\n                symbol,\n                data: {\n                  fundingRate: fundingData.lastFundingRate || '0',\n                  nextFundingTime: fundingData.nextFundingTime || 0,\n                  openInterest: oiData.openInterest || '0',\n                  openInterestValue,\n                },\n              };\n            } catch (error) {\n              console.error(`Error fetching futures data for ${symbol}:`, error);\n              return null;\n            }\n          }),\n        );\n\n        const newFuturesData: Record<string, FuturesData> = {};\n        results.forEach((result) => {\n          if (result) {\n            newFuturesData[result.symbol] = result.data;\n          }\n        });\n\n        setFuturesDataMap(newFuturesData);\n      } catch (error) {\n        console.error('Error fetching futures data:', error);\n      }\n    };\n\n    fetchFuturesData();\n    const interval = setInterval(fetchFuturesData, 10000); // Update every 10 seconds\n\n    return () => clearInterval(interval);\n  }, [markets]);\n\n  // WebSocket for real-time spot prices (Binance) with ping mechanism\n  useEffect(() => {\n    const ws = new WebSocket('wss://stream.binance.com:9443/ws/!ticker@arr');\n    let pingInterval: NodeJS.Timeout | null = null;\n\n    ws.onopen = () => {\n      // Start ping interval to keep connection alive (every 3 minutes)\n      pingInterval = setInterval(() => {\n        if (ws.readyState === WebSocket.OPEN) {\n          ws.send(JSON.stringify({ method: 'ping' }));\n        }\n      }, 180000); // 3 minutes (180000ms)\n    };\n\n    ws.onmessage = (event) => {\n      const tickers = JSON.parse(event.data);\n      const newPrices: Record<string, string> = {};\n      const newMarketData: Record<string, MarketData> = {};\n\n      for (const ticker of tickers) {\n        newPrices[ticker.s] = parseFloat(ticker.c).toString();\n        newMarketData[ticker.s] = {\n          price: parseFloat(ticker.c).toString(),\n          priceChange: parseFloat(ticker.p).toString(),\n          priceChangePercent: parseFloat(ticker.P).toString(),\n          high24h: parseFloat(ticker.h).toString(),\n          low24h: parseFloat(ticker.l).toString(),\n          volume24h: parseFloat(ticker.q).toString(),\n        };\n      }\n\n      setAllPrices(newPrices);\n      setMarketDataMap(newMarketData);\n    };\n\n    ws.onerror = (error) => console.error('❌ Binance WebSocket error:', error);\n\n    ws.onclose = () => {\n      // Clear ping interval when connection closes\n      if (pingInterval) {\n        clearInterval(pingInterval);\n        pingInterval = null;\n      }\n    };\n\n    return () => {\n      // Clear ping interval on cleanup\n      if (pingInterval) {\n        clearInterval(pingInterval);\n      }\n\n      if (ws.readyState === WebSocket.OPEN) {\n        ws.close();\n      }\n    };\n  }, []);\n\n  // WebSocket for Pyth Oracle prices\n  useEffect(() => {\n    let ws: WebSocket | null = null;\n\n    const connectWebSocket = () => {\n      try {\n        const wsUrl =\n          (process.env.NEXT_PUBLIC_BACKEND_URL || 'http://localhost:3001').replace(/^http/, 'ws') +\n          '/ws/price';\n        ws = new WebSocket(wsUrl);\n\n        ws.onmessage = (event) => {\n          try {\n            const message = JSON.parse(event.data);\n\n            if (message.type === 'price_update' && message.data) {\n              setOraclePrices((prev) => {\n                const next: Record<string, OraclePrice> = { ...prev };\n                Object.keys(message.data).forEach((symbol) => {\n                  const priceData = message.data[symbol];\n                  next[symbol.toUpperCase()] = {\n                    symbol: priceData.symbol,\n                    price: priceData.price,\n                    confidence: priceData.confidence,\n                    timestamp: priceData.timestamp,\n                    source: priceData.source,\n                  };\n                });\n                return next;\n              });\n            }\n          } catch (error) {\n            console.error('Error parsing Oracle message:', error);\n          }\n        };\n\n        ws.onerror = () => {\n          // Silently handle error - backend might not be running\n          console.warn('⚠️ Oracle WebSocket not available (backend offline?)');\n        };\n      } catch (error) {\n        console.warn('⚠️ Could not connect to Oracle WebSocket:', error);\n      }\n    };\n\n    connectWebSocket();\n\n    return () => {\n      if (ws && ws.readyState === WebSocket.OPEN) {\n        ws.close();\n      }\n    };\n  }, []);\n\n  return {\n    allPrices,\n    marketDataMap,\n    futuresDataMap,\n    oraclePrices,\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1504, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/charts/TradingViewWidget.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useRef, memo } from 'react';\n\ninterface TradingViewWidgetProps {\n  // Full TradingView symbol (e.g. BINANCE:BTCUSDT, OANDA:EURUSD)\n  symbol: string;\n}\n\nconst TradingViewWidget: React.FC<TradingViewWidgetProps> = memo(({ symbol }) => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const scriptLoadedRef = useRef(false);\n\n  useEffect(() => {\n    if (!containerRef.current) return;\n\n    // Clear container\n    containerRef.current.innerHTML = '';\n\n    // Create container div for widget\n    const widgetContainer = document.createElement('div');\n    widgetContainer.id = `tradingview_${Date.now()}`;\n    widgetContainer.style.height = '100%';\n    widgetContainer.style.width = '100%';\n    containerRef.current.appendChild(widgetContainer);\n\n    const initWidget = () => {\n      if (typeof (window as any).TradingView === 'undefined') return;\n\n      const isMobile =\n        /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n          navigator.userAgent,\n        ) || (window.innerWidth < 768 && 'ontouchstart' in window);\n\n      const tvSymbol = symbol.includes(':') ? symbol : `BINANCE:${symbol}`;\n\n      new (window as any).TradingView.widget({\n        autosize: true,\n        symbol: tvSymbol,\n        interval: '240', // 4h default\n        timezone: 'Asia/Jakarta',\n        theme: 'dark',\n        style: '1',\n        locale: 'en',\n        toolbar_bg: '#171B26',\n        enable_publishing: false,\n        hide_side_toolbar: isMobile,\n        allow_symbol_change: true,\n        details: false,\n        hotlist: false,\n        calendar: false,\n        container_id: widgetContainer.id,\n        disabled_features: ['use_localstorage_for_settings', 'timeframes_toolbar'],\n        enabled_features: [\n          'header_widget',\n          'header_resolutions',\n          'header_interval_dialog_button',\n          'show_interval_dialog_on_key_press',\n        ],\n        overrides: {\n          'paneProperties.background': '#171B26',\n          'paneProperties.backgroundGradientStartColor': '#171B26',\n          'paneProperties.backgroundGradientEndColor': '#171B26',\n          'paneProperties.backgroundType': 'solid',\n          'paneProperties.vertGridProperties.color': '#1E2433',\n          'paneProperties.horzGridProperties.color': '#1E2433',\n          'scalesProperties.backgroundColor': '#171B26',\n          'scalesProperties.textColor': '#94A3B8',\n          'scalesProperties.lineColor': '#1E2433',\n          'symbolWatermarkProperties.transparency': 90,\n          'symbolWatermarkProperties.color': '#171B26',\n          'mainSeriesProperties.candleStyle.upColor': '#22c55e',\n          'mainSeriesProperties.candleStyle.downColor': '#ef4444',\n          'mainSeriesProperties.candleStyle.borderUpColor': '#22c55e',\n          'mainSeriesProperties.candleStyle.borderDownColor': '#ef4444',\n          'mainSeriesProperties.candleStyle.wickUpColor': '#22c55e',\n          'mainSeriesProperties.candleStyle.wickDownColor': '#ef4444',\n        },\n        loading_screen: {\n          backgroundColor: '#171B26',\n          foregroundColor: '#171B26',\n        },\n      });\n    };\n\n    // Load TradingView script if not already loaded\n    const loadScript = () => {\n      if (scriptLoadedRef.current) {\n        initWidget();\n        return;\n      }\n\n      const script = document.createElement('script');\n      script.src = 'https://s3.tradingview.com/tv.js';\n      script.async = true;\n      script.onload = () => {\n        scriptLoadedRef.current = true;\n        initWidget();\n      };\n      document.head.appendChild(script);\n    };\n\n    loadScript();\n\n    return () => {\n      if (containerRef.current) {\n        containerRef.current.innerHTML = '';\n      }\n    };\n  }, [symbol]);\n\n  return (\n    <div\n      ref={containerRef}\n      className=\"w-full h-full\"\n      style={{\n        position: 'relative',\n        width: '100%',\n        height: '100%',\n        zIndex: 1,\n      }}\n    />\n  );\n});\n\nTradingViewWidget.displayName = 'TradingViewWidget';\n\nexport default TradingViewWidget;\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AASA,MAAM,kCAAsD,IAAA,6MAAI,EAAC,CAAC,EAAE,MAAM,EAAE;IAC1E,MAAM,eAAe,IAAA,+MAAM,EAAiB;IAC5C,MAAM,kBAAkB,IAAA,+MAAM,EAAC;IAE/B,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,aAAa,OAAO,EAAE;QAE3B,kBAAkB;QAClB,aAAa,OAAO,CAAC,SAAS,GAAG;QAEjC,kCAAkC;QAClC,MAAM,kBAAkB,SAAS,aAAa,CAAC;QAC/C,gBAAgB,EAAE,GAAG,CAAC,YAAY,EAAE,KAAK,GAAG,IAAI;QAChD,gBAAgB,KAAK,CAAC,MAAM,GAAG;QAC/B,gBAAgB,KAAK,CAAC,KAAK,GAAG;QAC9B,aAAa,OAAO,CAAC,WAAW,CAAC;QAEjC,MAAM,aAAa;YACjB,IAAI,OAAO,AAAC,OAAe,WAAW,KAAK,aAAa;YAExD,MAAM,WACJ,iEAAiE,IAAI,CACnE,UAAU,SAAS,KACf,OAAO,UAAU,GAAG,OAAO,kBAAkB;YAErD,MAAM,WAAW,OAAO,QAAQ,CAAC,OAAO,SAAS,CAAC,QAAQ,EAAE,QAAQ;YAEpE,IAAI,AAAC,OAAe,WAAW,CAAC,MAAM,CAAC;gBACrC,UAAU;gBACV,QAAQ;gBACR,UAAU;gBACV,UAAU;gBACV,OAAO;gBACP,OAAO;gBACP,QAAQ;gBACR,YAAY;gBACZ,mBAAmB;gBACnB,mBAAmB;gBACnB,qBAAqB;gBACrB,SAAS;gBACT,SAAS;gBACT,UAAU;gBACV,cAAc,gBAAgB,EAAE;gBAChC,mBAAmB;oBAAC;oBAAiC;iBAAqB;gBAC1E,kBAAkB;oBAChB;oBACA;oBACA;oBACA;iBACD;gBACD,WAAW;oBACT,6BAA6B;oBAC7B,+CAA+C;oBAC/C,6CAA6C;oBAC7C,iCAAiC;oBACjC,2CAA2C;oBAC3C,2CAA2C;oBAC3C,oCAAoC;oBACpC,8BAA8B;oBAC9B,8BAA8B;oBAC9B,0CAA0C;oBAC1C,mCAAmC;oBACnC,4CAA4C;oBAC5C,8CAA8C;oBAC9C,kDAAkD;oBAClD,oDAAoD;oBACpD,gDAAgD;oBAChD,kDAAkD;gBACpD;gBACA,gBAAgB;oBACd,iBAAiB;oBACjB,iBAAiB;gBACnB;YACF;QACF;QAEA,gDAAgD;QAChD,MAAM,aAAa;YACjB,IAAI,gBAAgB,OAAO,EAAE;gBAC3B;gBACA;YACF;YAEA,MAAM,SAAS,SAAS,aAAa,CAAC;YACtC,OAAO,GAAG,GAAG;YACb,OAAO,KAAK,GAAG;YACf,OAAO,MAAM,GAAG;gBACd,gBAAgB,OAAO,GAAG;gBAC1B;YACF;YACA,SAAS,IAAI,CAAC,WAAW,CAAC;QAC5B;QAEA;QAEA,OAAO;YACL,IAAI,aAAa,OAAO,EAAE;gBACxB,aAAa,OAAO,CAAC,SAAS,GAAG;YACnC;QACF;IACF,GAAG;QAAC;KAAO;IAEX,qBACE,8OAAC;QACC,KAAK;QACL,WAAU;QACV,OAAO;YACL,UAAU;YACV,OAAO;YACP,QAAQ;YACR,QAAQ;QACV;;;;;;AAGN;AAEA,kBAAkB,WAAW,GAAG;uCAEjB"}},
    {"offset": {"line": 1626, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/lib/formatters.ts"],"sourcesContent":["/**\n * Formatting utilities for trading chart data\n */\n\n/**\n * Format price with currency symbol\n * @param price - Price value to format\n * @returns Formatted price string (e.g., \"$1,234.56\")\n */\nexport const formatPrice = (price: number): string => {\n  if (price === 0) return '$--';\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2,\n  }).format(price);\n};\n\n/**\n * Format volume with K/M/B suffixes\n * @param volume - Volume value to format\n * @returns Formatted volume string (e.g., \"$1.23M\")\n */\nexport const formatVolume = (volume: number): string => {\n  if (volume === 0) return '--';\n  if (volume >= 1e9) return `$${(volume / 1e9).toFixed(2)}B`;\n  if (volume >= 1e6) return `$${(volume / 1e6).toFixed(2)}M`;\n  if (volume >= 1e3) return `$${(volume / 1e3).toFixed(2)}K`;\n  return `$${volume.toFixed(2)}`;\n};\n\n/**\n * Format funding rate as percentage\n * @param rate - Funding rate value\n * @returns Formatted rate string (e.g., \"0.0100%\")\n */\nexport const formatFundingRate = (rate: number): string => {\n  return `${(rate * 100).toFixed(4)}%`;\n};\n\n/**\n * Format timestamp to time until string\n * @param timestamp - Unix timestamp in milliseconds\n * @returns Formatted time string (e.g., \"2h 30m\")\n */\nexport const formatTimeUntil = (timestamp: number): string => {\n  const now = Date.now();\n  const diff = timestamp - now;\n  if (diff <= 0) return 'Now';\n\n  const hours = Math.floor(diff / (1000 * 60 * 60));\n  const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));\n\n  return `${hours}h ${minutes}m`;\n};\n"],"names":[],"mappings":"AAAA;;CAEC,GAED;;;;CAIC;;;;;;;;;;AACM,MAAM,cAAc,CAAC;IAC1B,IAAI,UAAU,GAAG,OAAO;IACxB,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;QACpC,OAAO;QACP,UAAU;QACV,uBAAuB;QACvB,uBAAuB;IACzB,GAAG,MAAM,CAAC;AACZ;AAOO,MAAM,eAAe,CAAC;IAC3B,IAAI,WAAW,GAAG,OAAO;IACzB,IAAI,UAAU,KAAK,OAAO,CAAC,CAAC,EAAE,CAAC,SAAS,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;IAC1D,IAAI,UAAU,KAAK,OAAO,CAAC,CAAC,EAAE,CAAC,SAAS,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;IAC1D,IAAI,UAAU,KAAK,OAAO,CAAC,CAAC,EAAE,CAAC,SAAS,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;IAC1D,OAAO,CAAC,CAAC,EAAE,OAAO,OAAO,CAAC,IAAI;AAChC;AAOO,MAAM,oBAAoB,CAAC;IAChC,OAAO,GAAG,CAAC,OAAO,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;AACtC;AAOO,MAAM,kBAAkB,CAAC;IAC9B,MAAM,MAAM,KAAK,GAAG;IACpB,MAAM,OAAO,YAAY;IACzB,IAAI,QAAQ,GAAG,OAAO;IAEtB,MAAM,QAAQ,KAAK,KAAK,CAAC,OAAO,CAAC,OAAO,KAAK,EAAE;IAC/C,MAAM,UAAU,KAAK,KAAK,CAAC,AAAC,OAAO,CAAC,OAAO,KAAK,EAAE,IAAK,CAAC,OAAO,EAAE;IAEjE,OAAO,GAAG,MAAM,EAAE,EAAE,QAAQ,CAAC,CAAC;AAChC"}},
    {"offset": {"line": 1673, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/lib/marketUtils.ts"],"sourcesContent":["import { Market } from '@/features/trading/types';\n\nconst CATEGORY_ORDER: Market['category'][] = [\n  'crypto',\n  'forex',\n  'indices',\n  'commodities',\n  'stocks',\n];\n\nconst FOREX_BASES = ['EUR', 'GBP', 'JPY', 'AUD', 'NZD', 'CAD', 'CHF'];\nconst STOCK_LIKE = ['AAPL', 'GOOGL', 'TSLA', 'NVDA', 'MSFT', 'AMZN'];\nconst INDEX_LIKE = ['SPY', 'QQQ', 'DXY'];\nconst COMMODITY_LIKE = ['XAU', 'XAG', 'WTI', 'BRENT'];\n\nexport function formatMarketPair(symbol: string): string {\n  const upper = symbol.toUpperCase();\n  if (upper.endsWith('USD') && upper.length > 3) {\n    const base = symbol.slice(0, -3);\n    return `${base}/USD`;\n  }\n  return `${symbol}/USD`;\n}\n\nexport function inferMarketCategory(symbol: string): Market['category'] {\n  const upper = symbol.toUpperCase();\n  const base = upper.endsWith('USD') ? upper.slice(0, -3) : upper;\n\n  if (FOREX_BASES.includes(base) && upper.endsWith('USD')) return 'forex';\n  if (COMMODITY_LIKE.includes(base)) return 'commodities';\n  if (INDEX_LIKE.includes(base)) return 'indices';\n  if (STOCK_LIKE.includes(base)) return 'stocks';\n\n  // Default: treat unknown as stocks if it looks like equity ticker, otherwise crypto\n  if (upper.endsWith('USD') && base.length <= 5) return 'stocks';\n  return 'crypto';\n}\n\nexport function inferTradingViewSymbol(symbol: string, category: Market['category']): string {\n  const upper = symbol.toUpperCase();\n  const base = upper.endsWith('USD') ? upper.slice(0, -3) : upper;\n\n  // Explicit mappings\n  const explicit: Record<string, string> = {\n    EURUSD: 'OANDA:EURUSD',\n    GBPUSD: 'OANDA:GBPUSD',\n    XAUUSD: 'OANDA:XAUUSD',\n    XAGUSD: 'OANDA:XAGUSD',\n    QQQUSD: 'NASDAQ:QQQ',\n    SPYUSD: 'AMEX:SPY',\n    AAPLUSD: 'NASDAQ:AAPL',\n    GOOGLUSD: 'NASDAQ:GOOGL',\n    NVDAUSD: 'NASDAQ:NVDA',\n    TSLAUSD: 'NASDAQ:TSLA',\n  };\n  if (explicit[upper]) return explicit[upper];\n\n  if (category === 'forex') return `OANDA:${upper}`;\n  if (category === 'commodities') return `OANDA:${upper}`;\n  if (category === 'indices') return `AMEX:${base}`;\n  if (category === 'stocks') return `NASDAQ:${base}`;\n\n  // Crypto fallback\n  return `BINANCE:${base}USDT`;\n}\n\nexport function mergeMarketsWithOracle(\n  baseMarkets: Market[],\n  oracleSymbols: string[],\n): Market[] {\n  const map = new Map<string, Market>();\n  baseMarkets.forEach((m) => map.set(m.symbol.toUpperCase(), m));\n\n  oracleSymbols.forEach((rawSymbol) => {\n    const symbol = rawSymbol.toUpperCase();\n    if (map.has(symbol)) return;\n\n    const category = inferMarketCategory(symbol);\n    map.set(symbol, {\n      symbol,\n      category,\n      tradingViewSymbol: inferTradingViewSymbol(symbol, category),\n      maxLeverage: 100,\n    });\n  });\n\n  const markets = Array.from(map.values());\n  markets.sort((a, b) => {\n    const catOrder = CATEGORY_ORDER.indexOf(a.category) - CATEGORY_ORDER.indexOf(b.category);\n    if (catOrder !== 0) return catOrder;\n    return a.symbol.localeCompare(b.symbol);\n  });\n  return markets;\n}\n\nexport function formatDynamicUsd(value: number): string {\n  if (!Number.isFinite(value)) return '$--';\n  const intPart = Math.floor(Math.abs(value));\n  const digits = intPart >= 10 ? 2 : 5;\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: digits,\n    maximumFractionDigits: digits,\n  }).format(value);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1800, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/charts/MarketSelector.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { FuturesData, Market, MarketData } from '@/features/trading/types';\nimport { formatVolume } from '@/features/trading/lib/formatters';\nimport { formatDynamicUsd, formatMarketPair } from '@/features/trading/lib/marketUtils';\nimport Image from 'next/image';\nimport { Search, Star, X, Coins, Banknote, LineChart, Gem, Building2 } from 'lucide-react';\n\ninterface MarketSelectorProps {\n  isOpen: boolean;\n  onClose: () => void;\n  markets: Market[];\n  onSelect: (symbol: string) => void;\n  allPrices: Record<string, string>;\n  marketDataMap: Record<string, MarketData>;\n  futuresDataMap: Record<string, FuturesData>;\n  oraclePrices: Record<string, { price: number }>;\n  triggerRef?: React.RefObject<HTMLButtonElement | null>;\n}\n\ntype TabKey = 'starred' | Market['category'];\n\nconst CATEGORY_TABS: { id: TabKey; label: string; icon: React.ReactNode }[] = [\n  { id: 'starred', label: 'Starred', icon: <Star size={14} /> },\n  { id: 'crypto', label: 'Crypto', icon: <Coins size={14} /> },\n  { id: 'forex', label: 'Forex', icon: <Banknote size={14} /> },\n  { id: 'indices', label: 'Indices', icon: <LineChart size={14} /> },\n  { id: 'commodities', label: 'Commodities', icon: <Gem size={14} /> },\n  { id: 'stocks', label: 'Stocks', icon: <Building2 size={14} /> },\n];\n\nfunction MarketLogo({ market }: { market: Market }) {\n  if (market.logoUrl) {\n    return (\n      <Image\n        src={market.logoUrl}\n        alt={market.symbol}\n        width={24}\n        height={24}\n        className=\"w-6 h-6 rounded-full bg-trading-surface\"\n        onError={(e) => {\n          const target = e.currentTarget;\n          target.onerror = null;\n          target.style.visibility = 'hidden';\n        }}\n      />\n    );\n  }\n\n  const initials = (market.symbol || '?').slice(0, 3).toUpperCase();\n  return (\n    <div className=\"w-6 h-6 rounded-full bg-trading-elevated text-[11px] font-semibold text-center leading-6 text-text-primary\">\n      {initials}\n    </div>\n  );\n}\n\nexport default function MarketSelector(props: MarketSelectorProps) {\n  const [searchTerm, setSearchTerm] = useState('');\n  const [activeTab, setActiveTab] = useState<TabKey>('crypto');\n  const [favorites, setFavorites] = useState<Set<string>>(new Set());\n  const panelRef = useRef<HTMLDivElement>(null);\n\n  // Load favorites from localStorage\n  useEffect(() => {\n    const stored = localStorage.getItem('dash_favorite_markets');\n    if (stored) {\n      try {\n        setFavorites(new Set(JSON.parse(stored)));\n      } catch {\n        setFavorites(new Set());\n      }\n    }\n  }, []);\n\n  // Persist favorites\n  useEffect(() => {\n    localStorage.setItem('dash_favorite_markets', JSON.stringify(Array.from(favorites)));\n  }, [favorites]);\n\n  const toggleFavorite = (symbol: string) => {\n    setFavorites((prev) => {\n      const next = new Set(prev);\n      if (next.has(symbol)) {\n        next.delete(symbol);\n      } else {\n        next.add(symbol);\n      }\n      return next;\n    });\n  };\n\n  const filteredMarkets = useMemo(() => {\n    const matchesTab = (market: Market) => {\n      if (activeTab === 'starred') return favorites.has(market.symbol);\n      return market.category === activeTab;\n    };\n\n    const term = searchTerm.toLowerCase();\n    const filtered = props.markets.filter(\n      (m) =>\n        matchesTab(m) &&\n        (m.symbol.toLowerCase().includes(term) ||\n          formatMarketPair(m.symbol).toLowerCase().includes(term)),\n    );\n\n    return filtered.sort((a, b) => {\n      const aFav = favorites.has(a.symbol);\n      const bFav = favorites.has(b.symbol);\n      if (aFav && !bFav) return -1;\n      if (!aFav && bFav) return 1;\n      return a.symbol.localeCompare(b.symbol);\n    });\n  }, [props.markets, favorites, activeTab, searchTerm]);\n\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      const target = event.target as Node;\n      if (\n        (panelRef.current && panelRef.current.contains(target)) ||\n        (props.triggerRef?.current && props.triggerRef.current.contains(target))\n      ) {\n        return;\n      }\n      props.onClose();\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [props]);\n\n  if (!props.isOpen) return null;\n\n  return (\n    <div\n      ref={panelRef}\n      className=\"absolute top-full mt-2 left-0 w-screen max-w-[95vw] lg:max-w-[900px] bg-trading-panel border border-border-default rounded-xl shadow-2xl flex flex-col overflow-hidden max-h-[520px]\"\n      style={{ zIndex: 9999 }}\n    >\n      <div className=\"flex items-center gap-3 px-4 py-3 border-b border-border-muted bg-trading-elevated\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted\" />\n          <input\n            type=\"text\"\n            placeholder=\"Search markets\"\n            className=\"w-full pl-9 pr-3 py-2 bg-input-bg border border-input-border rounded-md text-sm text-text-primary placeholder-input-placeholder focus:outline-none focus:ring-1 focus:ring-border-focus\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            autoFocus\n          />\n        </div>\n        <button\n          onClick={props.onClose}\n          className=\"p-2 rounded-md hover:bg-trading-surface text-text-muted\"\n          aria-label=\"Close\"\n        >\n          <X size={16} />\n        </button>\n      </div>\n\n      <div className=\"flex items-center gap-2 px-4 py-3 overflow-x-auto bg-trading-panel border-b border-border-muted custom-scrollbar-slate\">\n        {CATEGORY_TABS.map((tab) => {\n          const hasMarkets =\n            tab.id === 'starred'\n              ? favorites.size > 0\n              : props.markets.some((m) => m.category === tab.id);\n          return (\n            <button\n              key={tab.id}\n              onClick={() => setActiveTab(tab.id)}\n              disabled={!hasMarkets && tab.id !== 'starred'}\n              className={`flex items-center gap-2 px-3 py-1.5 rounded-full text-sm border transition-all ${activeTab === tab.id\n                  ? 'bg-primary/10 border-primary text-primary'\n                  : 'bg-trading-surface border-border-muted text-text-secondary hover:text-text-primary'\n                } ${!hasMarkets && tab.id !== 'starred' ? 'opacity-50 cursor-not-allowed' : ''}`}\n            >\n              {tab.icon}\n              <span>{tab.label}</span>\n            </button>\n          );\n        })}\n      </div>\n\n      <div className=\"grid grid-cols-12 gap-2 px-4 py-2 text-xs font-semibold text-text-secondary bg-trading-elevated border-b border-border-default sticky top-0\">\n        <div className=\"col-span-5\">Market</div>\n        <div className=\"col-span-2 text-center\">Lev.</div>\n        <div className=\"col-span-3 text-right\">Price</div>\n        <div className=\"col-span-2 text-right\">Change</div>\n      </div>\n\n      <div className=\"flex-grow overflow-y-auto custom-scrollbar-slate max-h-[360px]\">\n        {filteredMarkets.length > 0 ? (\n          filteredMarkets.map((market) => {\n            const oraclePrice = props.oraclePrices[market.symbol]?.price;\n            const spotPrice = market.binanceSymbol\n              ? parseFloat(props.allPrices[market.binanceSymbol] || '0')\n              : undefined;\n            const price = oraclePrice ?? spotPrice;\n\n            const marketData = market.binanceSymbol\n              ? props.marketDataMap[market.binanceSymbol]\n              : undefined;\n            const priceChangePercent = marketData?.priceChangePercent\n              ? parseFloat(marketData.priceChangePercent)\n              : undefined;\n            const isPositive = (priceChangePercent || 0) >= 0;\n            const formattedPrice = price ? formatDynamicUsd(price) : '--';\n\n            return (\n              <div\n                key={market.symbol}\n                onClick={() => {\n                  props.onSelect(market.symbol);\n                  props.onClose();\n                }}\n                className=\"grid grid-cols-12 items-center gap-2 px-4 py-3 text-sm border-b border-border-muted hover:bg-trading-elevated cursor-pointer transition-colors\"\n              >\n                <div className=\"col-span-5 flex items-center gap-3\">\n                  <button\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      toggleFavorite(market.symbol);\n                    }}\n                    className=\"p-1 rounded-full hover:bg-trading-surface text-text-muted\"\n                    aria-label=\"Toggle favorite\"\n                  >\n                    <Star\n                      size={14}\n                      className={`${favorites.has(market.symbol) ? 'fill-yellow-400 text-yellow-400' : ''\n                        }`}\n                    />\n                  </button>\n                  <MarketLogo market={market} />\n                  <div className=\"flex flex-col\">\n                    <span className=\"font-bold text-text-primary\">\n                      {formatMarketPair(market.symbol)}\n                    </span>\n                    <span className=\"text-[11px] text-text-secondary capitalize\">\n                      {market.category}\n                    </span>\n                  </div>\n                </div>\n                <div className=\"col-span-2 text-center\">\n                  <span className=\"px-2 py-1 rounded-full text-xs bg-trading-surface text-text-primary border border-border-muted\">\n                    {market.maxLeverage ? `${market.maxLeverage}x` : '—'}\n                  </span>\n                </div>\n                <div className=\"col-span-3 text-right font-mono text-text-primary\">\n                  {formattedPrice}\n                </div>\n                <div className=\"col-span-2 text-right font-mono\">\n                  {priceChangePercent !== undefined ? (\n                    <span className={isPositive ? 'text-success' : 'text-error'}>\n                      {isPositive ? '+' : ''}\n                      {priceChangePercent.toFixed(2)}%\n                    </span>\n                  ) : (\n                    <span className=\"text-text-muted\">--</span>\n                  )}\n                </div>\n              </div>\n            );\n          })\n        ) : (\n          <div className=\"flex justify-center items-center h-32 text-text-secondary\">\n            No markets found.\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2273, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/charts/ChartHeader.tsx"],"sourcesContent":["'use client';\n\nimport React from 'react';\nimport { FuturesData, Market, MarketData } from '@/features/trading/types';\nimport {\n  formatPrice,\n  formatVolume,\n  formatFundingRate,\n  formatTimeUntil,\n} from '@/features/trading/lib/formatters';\nimport MarketSelector from './MarketSelector';\nimport RealTimeClock from './RealTimeClock';\nimport Image from 'next/image';\nimport { formatDynamicUsd, formatMarketPair } from '@/features/trading/lib/marketUtils';\n\ninterface OraclePrice {\n  symbol: string;\n  price: number;\n  confidence?: number;\n  timestamp: number;\n  source: string;\n}\n\ninterface ChartHeaderProps {\n  activeMarket: Market | null;\n  marketData: MarketData | null;\n  futuresData: FuturesData | null;\n  allPrices: Record<string, string>;\n  marketDataMap: Record<string, MarketData>;\n  futuresDataMap: Record<string, FuturesData>;\n  oraclePrice: OraclePrice | null;\n  oraclePrices: Record<string, { price: number }>;\n  onSymbolChangeClick: () => void;\n  isMarketSelectorOpen: boolean;\n  onClose: () => void;\n  markets: Market[];\n  onSelect: (symbol: string) => void;\n  triggerRef: React.RefObject<HTMLButtonElement | null>;\n  disabled?: boolean;\n}\n\nexport default function ChartHeader(props: ChartHeaderProps) {\n  // Use Oracle price data if available, otherwise fallback to Binance\n  const oraclePriceValue = props.oraclePrice?.price ?? undefined;\n  const displayPrice = Number.isFinite(oraclePriceValue)\n    ? oraclePriceValue\n    : props.marketData?.price\n    ? parseFloat(props.marketData.price)\n    : NaN;\n  const priceChangePercent = props.marketData?.priceChangePercent\n    ? parseFloat(props.marketData.priceChangePercent)\n    : 0;\n  const isPositive = priceChangePercent >= 0;\n  const fundingRate = props.futuresData ? parseFloat(props.futuresData.fundingRate) : 0;\n  const isFundingPositive = fundingRate >= 0;\n  const isCrypto = props.activeMarket?.category === 'crypto';\n\n  const formatUsd = (value: number) => formatDynamicUsd(value);\n\n  return (\n    <div\n      className=\"flex flex-wrap items-center justify-between md:px-4 px-2 md:py-2 py-1.5\"\n      style={{\n        gap: '0.75rem',\n        flexShrink: 0,\n        position: 'relative',\n        zIndex: 10,\n      }}\n    >\n      <div className=\"flex items-center md:gap-x-6 md:gap-y-3 gap-3 flex-wrap\">\n        <div className=\"relative\" style={{ zIndex: 11 }}>\n          <button\n            ref={props.triggerRef}\n            onClick={() => !props.disabled && props.onSymbolChangeClick()}\n            disabled={props.disabled}\n            className={`flex items-center gap-2 bg-gradient-to-r from-trading-surface to-trading-elevated border border-border-default rounded-lg px-4 py-2.5 text-sm font-bold text-text-primary transition-all duration-200 shadow-lg ${'hover:from-trading-elevated hover:to-trading-surface hover:border-border-light hover:shadow-xl cursor-pointer'}`}\n          >\n            {props.activeMarket && (\n              <Image\n                src={`${props.activeMarket.logoUrl || '/icons/usdc.png'}`}\n                alt={`${props.activeMarket.symbol}`}\n                width={24}\n                height={24}\n                className=\"w-6 h-6 rounded-full bg-trading-surface ring-2 ring-border-light\"\n                onError={(e) => {\n                  const target = e.currentTarget;\n                  target.onerror = null;\n                  target.style.visibility = 'hidden';\n                }}\n              />\n            )}\n            <span className=\"text-base\">\n              {props.activeMarket ? formatMarketPair(props.activeMarket.symbol) : ''}\n            </span>\n            <svg\n              className={`w-4 h-4 transition-transform duration-200 ${\n                props.isMarketSelectorOpen ? 'rotate-180' : ''\n              }`}\n              fill=\"none\"\n              stroke=\"currentColor\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M19 9l-7 7-7-7\"\n              />\n            </svg>\n          </button>\n          <MarketSelector\n            isOpen={props.isMarketSelectorOpen}\n            onClose={props.onClose}\n            markets={props.markets}\n            onSelect={props.onSelect}\n            allPrices={props.allPrices}\n            marketDataMap={props.marketDataMap}\n            futuresDataMap={props.futuresDataMap}\n            oraclePrices={props.oraclePrices}\n            triggerRef={props.triggerRef}\n          />\n        </div>\n\n        <div className=\"flex flex-col \">\n          <span className=\"font-semibold font-mono md:text-lg text-base text-text-primary\">\n            {Number.isFinite(displayPrice) ? formatUsd(displayPrice as number) : '$--'}\n          </span>\n          {isCrypto && (\n            <span\n              className={`font-semibold font-mono md:text-sm text-xs ${\n                isPositive ? 'text-success' : 'text-error'\n              }`}\n            >\n              {props.marketData?.priceChangePercent\n                ? `${isPositive ? '+' : ''}${parseFloat(\n                    props.marketData.priceChangePercent,\n                  ).toFixed(2)}%`\n                : '--'}\n            </span>\n          )}\n        </div>\n\n        {isCrypto && (\n          <>\n            <div className=\"md:flex flex-col hidden\">\n              <span className=\"text-xs text-text-secondary\">24H HIGH</span>\n              <div className=\"flex items-center gap-1\">\n                <span className=\"text-success text-xs\">▲</span>\n                <span className=\"font-semibold font-mono text-sm text-text-primary\">\n                  {props.marketData?.high24h\n                    ? formatPrice(parseFloat(props.marketData.high24h))\n                    : '$--'}\n                </span>\n              </div>\n            </div>\n\n            <div className=\"md:flex flex-col hidden\">\n              <span className=\"text-xs text-text-secondary\">24H LOW</span>\n              <div className=\"flex items-center gap-1\">\n                <span className=\"text-error text-xs\">▼</span>\n                <span className=\"font-semibold font-mono text-sm text-text-primary\">\n                  {props.marketData?.low24h\n                    ? formatPrice(parseFloat(props.marketData.low24h))\n                    : '$--'}\n                </span>\n              </div>\n            </div>\n\n            <div className=\"md:flex flex-col hidden\">\n              <span className=\"text-xs text-text-secondary\">24H VOLUME</span>\n              <span className=\"font-semibold font-mono text-sm text-text-primary\">\n                {props.marketData?.volume24h\n                  ? formatVolume(parseFloat(props.marketData.volume24h))\n                  : '--'}\n              </span>\n            </div>\n          </>\n        )}\n      </div>\n\n      {/* Mobile: Info Button - Top Right Corner */}\n      <button\n        className=\"md:hidden absolute top-2 right-2 flex items-center justify-center p-2 bg-trading-surface rounded-lg hover:bg-trading-elevated transition-colors\"\n        onClick={() => {\n          // Toggle mobile coin info panel with market data\n          const event = new CustomEvent('toggleMobileCoinInfo', {\n            detail: {\n              marketData: {\n                ...props.marketData,\n                openInterestValue: props.futuresData?.openInterestValue,\n              },\n              activeMarket: props.activeMarket,\n            },\n          });\n          window.dispatchEvent(event);\n        }}\n      >\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          className=\"h-5 w-5 text-text-secondary\"\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n          stroke=\"currentColor\"\n        >\n          <path\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            strokeWidth={2}\n            d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\n          />\n        </svg>\n      </button>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2589, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/hooks/useOneTapProfitBetting.ts"],"sourcesContent":["'use client';\n\nimport { useState, useCallback, useEffect, useRef } from 'react';\nimport { usePrivy, useWallets } from '@privy-io/react-auth';\nimport { useSessionKey } from '@/features/wallet/hooks/useSessionKey';\nimport {\n  encodeFunctionData,\n  parseUnits,\n  createWalletClient,\n  custom,\n  keccak256,\n  encodePacked,\n} from 'viem';\nimport { baseSepolia } from 'viem/chains';\nimport axios from 'axios';\nimport { toast } from 'sonner';\n\nconst BACKEND_URL = process.env.NEXT_PUBLIC_BACKEND_URL || 'http://localhost:3001';\nconst ONE_TAP_PROFIT_ADDRESS = process.env.NEXT_PUBLIC_ONE_TAP_PROFIT_ADDRESS as `0x${string}`;\nconst USDC_ADDRESS = process.env.NEXT_PUBLIC_USDC_TOKEN_ADDRESS as `0x${string}`;\n\nconst USDC_ABI = [\n  {\n    inputs: [\n      { name: 'spender', type: 'address' },\n      { name: 'amount', type: 'uint256' },\n    ],\n    name: 'approve',\n    outputs: [{ name: '', type: 'bool' }],\n    stateMutability: 'nonpayable',\n    type: 'function',\n  },\n  {\n    inputs: [\n      { name: 'owner', type: 'address' },\n      { name: 'spender', type: 'address' },\n    ],\n    name: 'allowance',\n    outputs: [{ name: '', type: 'uint256' }],\n    stateMutability: 'view',\n    type: 'function',\n  },\n] as const;\n\ninterface PlaceBetParams {\n  symbol: string;\n  betAmount: string;\n  targetPrice: string;\n  targetTime: number;\n  entryPrice: string;\n  entryTime: number;\n}\n\nexport interface Bet {\n  betId: string;\n  trader: string;\n  symbol: string;\n  betAmount: string;\n  targetPrice: string;\n  targetTime: number;\n  entryPrice: string;\n  entryTime: number;\n  multiplier: number;\n  status: 'ACTIVE' | 'WON' | 'LOST' | 'CANCELLED';\n  settledAt?: number;\n  settlePrice?: string;\n}\n\ninterface MultiplierResult {\n  multiplier: number;\n  priceDistance: string;\n  timeDistance: number;\n}\n\nexport const useOneTapProfit = () => {\n  const { user, authenticated } = usePrivy();\n  const { wallets } = useWallets();\n  const [isPlacingBet, setIsPlacingBet] = useState(false);\n  const [activeBets, setActiveBets] = useState<Bet[]>([]);\n  const [isLoadingBets, setIsLoadingBets] = useState(false);\n  const prevActiveBetsRef = useRef<Bet[]>([]);\n  const hasInitializedRef = useRef(false);\n\n  const embeddedWallet = wallets.find((w) => w.walletClientType === 'privy');\n\n  const [sessionPnL, setSessionPnL] = useState<number>(0);\n\n  // Poll for active bets to update status and detect wins\n  useEffect(() => {\n    if (!authenticated || !user || !embeddedWallet) return;\n\n    const intervalId = setInterval(() => {\n      fetchActiveBets();\n    }, 2000); // Poll every 2 seconds\n\n    return () => clearInterval(intervalId);\n  }, [authenticated, user, embeddedWallet]);\n\n  // Win detection logic\n  useEffect(() => {\n    // Skip first run to avoid false positives on page load\n    if (!hasInitializedRef.current) {\n      if (activeBets.length > 0) hasInitializedRef.current = true;\n      prevActiveBetsRef.current = activeBets;\n      return;\n    }\n\n    // Find bets that were active but are now gone\n    const missingBets = prevActiveBetsRef.current.filter(\n      (prevBet: Bet) => !activeBets.find((currBet: Bet) => currBet.betId === prevBet.betId),\n    );\n\n    if (missingBets.length > 0) {\n      // Check status of missing bets to see if they won\n      missingBets.forEach(async (bet: Bet) => {\n        try {\n          const response = await axios.get(`${BACKEND_URL}/api/one-tap/bet/${bet.betId}`);\n          const status = response.data.data.status;\n\n          if (status === 'WON') {\n            // Play win sound\n            try {\n              const audio = new Audio('/sounds/win.mp3');\n              audio.volume = 0.6;\n              await audio.play();\n            } catch (e) {\n              console.warn(\n                'Win sound failed to play (might be missing file or browser policy):',\n                e,\n              );\n            }\n\n            // Update Session PnL (Profit = Payout - Bet Amount)\n            // Payout = BetAmount * Multiplier / 100\n            const betAmountVal = parseFloat(bet.betAmount);\n            const profit = (betAmountVal * bet.multiplier) / 100 - betAmountVal;\n            setSessionPnL((prev) => prev + profit);\n\n            toast.success(`You won! +$${profit.toFixed(2)}`, {\n              description: `${(bet.multiplier / 100).toFixed(2)}x on ${bet.symbol}`,\n              position: 'top-center',\n              duration: 3000,\n            });\n          } else if (status === 'LOST') {\n            // Update Session PnL (Loss = Bet Amount)\n            const betAmountVal = parseFloat(bet.betAmount);\n            setSessionPnL((prev) => prev - betAmountVal);\n\n            toast.error(`You lost $${betAmountVal.toFixed(2)}`, {\n              description: `Better luck next time on ${bet.symbol}`,\n              position: 'top-center',\n              duration: 3000,\n            });\n          }\n        } catch (err) {\n          console.error('Failed to check status of finished bet:', err);\n        }\n      });\n    }\n\n    prevActiveBetsRef.current = activeBets;\n  }, [activeBets]);\n\n  // Session key hook for gasless trading\n  const {\n    sessionKey,\n    isSessionValid,\n    createSession,\n    signWithSession,\n    clearSession,\n    getTimeRemaining,\n  } = useSessionKey();\n\n  /**\n   * Calculate multiplier for given parameters\n   */\n  const calculateMultiplier = useCallback(\n    async (\n      entryPrice: string,\n      targetPrice: string,\n      entryTime: number,\n      targetTime: number,\n    ): Promise<MultiplierResult> => {\n      try {\n        const response = await axios.post(`${BACKEND_URL}/api/one-tap/calculate-multiplier`, {\n          entryPrice,\n          targetPrice,\n          entryTime,\n          targetTime,\n        });\n\n        return response.data.data;\n      } catch (error) {\n        console.error('Failed to calculate multiplier:', error);\n        throw error;\n      }\n    },\n    [],\n  );\n\n  /**\n   * Place bet with session key (fully gasless)\n   */\n  /**\n   * Place bet with session key (fully gasless)\n   * Can accept sessionKey/signer from arguments (preferred) or use internal state (fallback)\n   */\n  const placeBetWithSession = useCallback(\n    async (\n      params: PlaceBetParams,\n      sessionOptions?: {\n        sessionKey: any;\n        sessionSigner: (hash: `0x${string}`) => Promise<string | null>;\n      },\n    ) => {\n      if (!authenticated || !user || !embeddedWallet) {\n        throw new Error('Wallet not connected');\n      }\n\n      // Use provided session options OR internal hook state\n      const activeSessionKey = sessionOptions?.sessionKey || sessionKey;\n      const signer = sessionOptions?.sessionSigner || signWithSession;\n\n      // Basic validation check (internal isSessionValid might be stale, so check object existence)\n      if (!activeSessionKey || activeSessionKey.expiresAt <= Date.now()) {\n        // Fallback to internal check if no options provided\n        if (!sessionOptions && !isSessionValid()) {\n          throw new Error(\n            'Session key expired or not created. Please enable Binary Trading again.',\n          );\n        } else if (sessionOptions) {\n          throw new Error('Session key provided is invalid or expired.');\n        }\n      }\n\n      setIsPlacingBet(true);\n\n      try {\n        const userAddress = embeddedWallet.address;\n\n        // Sign bet parameters with session key\n        const messageHash = keccak256(\n          encodePacked(\n            ['address', 'string', 'uint256', 'uint256', 'uint256'],\n            [\n              userAddress as `0x${string}`,\n              params.symbol,\n              parseUnits(params.betAmount, 6),\n              parseUnits(params.targetPrice, 8),\n              BigInt(Math.floor(params.targetTime)),\n            ],\n          ),\n        );\n\n        const sessionSignature = await signer(messageHash);\n\n        // Call backend endpoint (session validation happens off-chain)\n        const response = await axios.post(`${BACKEND_URL}/api/one-tap/place-bet-with-session`, {\n          trader: userAddress,\n          symbol: params.symbol,\n          betAmount: params.betAmount,\n          targetPrice: params.targetPrice,\n          targetTime: params.targetTime,\n          entryPrice: params.entryPrice,\n          entryTime: params.entryTime,\n          sessionSignature,\n        });\n\n        // Refresh active bets\n        await fetchActiveBets();\n\n        return response.data.data;\n      } catch (error) {\n        console.error('Failed to place bet with session:', error);\n        throw error;\n      } finally {\n        setIsPlacingBet(false);\n      }\n    },\n    [\n      authenticated,\n      user,\n      embeddedWallet,\n      isSessionValid,\n      createSession,\n      signWithSession,\n      sessionKey,\n    ],\n  );\n\n  /**\n   * Place a bet (legacy method with user signature)\n   */\n  const placeBet = useCallback(\n    async (params: PlaceBetParams) => {\n      if (!authenticated || !user || !embeddedWallet) {\n        throw new Error('Wallet not connected');\n      }\n\n      setIsPlacingBet(true);\n\n      try {\n        const ethereumProvider = await embeddedWallet.getEthereumProvider();\n        const userAddress = embeddedWallet.address as `0x${string}`;\n\n        // Create wallet client\n        const walletClient = createWalletClient({\n          account: userAddress,\n          chain: baseSepolia,\n          transport: custom(ethereumProvider),\n        });\n\n        // Fetch nonce from contract\n        const nonceData = encodeFunctionData({\n          abi: [\n            {\n              inputs: [{ name: 'trader', type: 'address' }],\n              name: 'metaNonces',\n              outputs: [{ name: '', type: 'uint256' }],\n              stateMutability: 'view',\n              type: 'function',\n            },\n          ],\n          functionName: 'metaNonces',\n          args: [userAddress],\n        });\n\n        const nonceResult = await ethereumProvider.request({\n          method: 'eth_call',\n          params: [\n            {\n              to: ONE_TAP_PROFIT_ADDRESS,\n              data: nonceData,\n            },\n            'latest',\n          ],\n        });\n\n        const nonce = BigInt(nonceResult as string);\n\n        // Create message hash matching contract's expectation:\n        // keccak256(abi.encodePacked(trader, symbol, betAmount, targetPrice, targetTime, nonce, contractAddress))\n        const messageHash = keccak256(\n          encodePacked(\n            ['address', 'string', 'uint256', 'uint256', 'uint256', 'uint256', 'address'],\n            [\n              userAddress,\n              params.symbol,\n              parseUnits(params.betAmount, 6),\n              parseUnits(params.targetPrice, 8),\n              BigInt(Math.floor(params.targetTime)),\n              nonce,\n              ONE_TAP_PROFIT_ADDRESS,\n            ],\n          ),\n        );\n\n        // Sign the message hash\n        const signature = await walletClient.signMessage({\n          account: userAddress,\n          message: { raw: messageHash },\n        });\n\n        // Check USDC allowance\n        const allowanceData = encodeFunctionData({\n          abi: USDC_ABI,\n          functionName: 'allowance',\n          args: [userAddress, ONE_TAP_PROFIT_ADDRESS],\n        });\n\n        const allowanceResult = await ethereumProvider.request({\n          method: 'eth_call',\n          params: [\n            {\n              to: USDC_ADDRESS,\n              data: allowanceData,\n            },\n            'latest',\n          ],\n        });\n\n        const allowance = BigInt(allowanceResult as string);\n\n        // Approve infinite USDC if needed (only once)\n        if (allowance === 0n) {\n          // Use max uint256 for infinite approval\n          const maxApproval = BigInt(\n            '0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff',\n          );\n\n          const approveData = encodeFunctionData({\n            abi: USDC_ABI,\n            functionName: 'approve',\n            args: [ONE_TAP_PROFIT_ADDRESS, maxApproval],\n          });\n\n          const approveTxHash = await walletClient.sendTransaction({\n            account: userAddress,\n            to: USDC_ADDRESS,\n            data: approveData,\n          });\n\n          await new Promise((resolve) => setTimeout(resolve, 3000));\n        }\n\n        // Call backend to place bet\n        const response = await axios.post(`${BACKEND_URL}/api/one-tap/place-bet`, {\n          trader: userAddress,\n          symbol: params.symbol,\n          betAmount: params.betAmount,\n          targetPrice: params.targetPrice,\n          targetTime: params.targetTime,\n          entryPrice: params.entryPrice,\n          entryTime: params.entryTime,\n          nonce: nonce.toString(),\n          userSignature: signature,\n        });\n\n        // Refresh active bets\n        await fetchActiveBets();\n\n        return response.data.data;\n      } catch (error) {\n        console.error('Failed to place bet:', error);\n        throw error;\n      } finally {\n        setIsPlacingBet(false);\n      }\n    },\n    [authenticated, user, embeddedWallet],\n  );\n\n  /**\n   * Fetch active bets\n   */\n  const fetchActiveBets = useCallback(async () => {\n    if (!authenticated || !user || !embeddedWallet) {\n      return;\n    }\n\n    setIsLoadingBets(true);\n\n    try {\n      const userAddress = embeddedWallet.address;\n\n      const response = await axios.get(`${BACKEND_URL}/api/one-tap/bets`, {\n        params: {\n          trader: userAddress,\n          status: 'ACTIVE',\n        },\n      });\n\n      setActiveBets(response.data.data || []);\n    } catch (error) {\n      console.error('Failed to fetch active bets:', error);\n    } finally {\n      setIsLoadingBets(false);\n    }\n  }, [authenticated, user, embeddedWallet]);\n\n  /**\n   * Fetch user's bet history\n   */\n  const fetchBetHistory = useCallback(async () => {\n    if (!authenticated || !user || !embeddedWallet) {\n      return [];\n    }\n\n    try {\n      const userAddress = embeddedWallet.address;\n\n      const response = await axios.get(`${BACKEND_URL}/api/one-tap/bets`, {\n        params: {\n          trader: userAddress,\n        },\n      });\n\n      return response.data.data || [];\n    } catch (error) {\n      console.error('Failed to fetch bet history:', error);\n      return [];\n    }\n  }, [authenticated, user, embeddedWallet]);\n\n  /**\n   * Get statistics\n   */\n  const fetchStats = useCallback(async () => {\n    try {\n      const response = await axios.get(`${BACKEND_URL}/api/one-tap/stats`);\n      return response.data.data;\n    } catch (error) {\n      console.error('Failed to fetch stats:', error);\n      return null;\n    }\n  }, []);\n\n  return {\n    placeBet,\n    placeBetWithSession, // New: fully gasless method\n    calculateMultiplier,\n    fetchActiveBets,\n    fetchBetHistory,\n    fetchStats,\n    activeBets,\n    isPlacingBet,\n    isLoadingBets,\n    // Session key info\n    sessionKey,\n    isSessionValid,\n    createSession,\n    clearSession,\n    sessionTimeRemaining: getTimeRemaining(),\n    sessionPnL,\n  };\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3050, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/charts/TradingChart.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useRef, useState, useMemo } from 'react';\nimport { useMarket } from '@/features/trading/contexts/MarketContext';\nimport { useTapToTrade } from '@/features/trading/contexts/TapToTradeContext';\nimport { Market } from '@/features/trading/types';\nimport { ALL_MARKETS } from '@/features/trading/constants/markets';\nimport { useMarketWebSocket } from '@/features/trading/hooks/useMarketWebSocket';\nimport TradingViewWidget from './TradingViewWidget';\nimport PerSecondChart from '@/components/charts/PerSecondChart';\nimport ChartHeader from './ChartHeader';\nimport { mergeMarketsWithOracle } from '@/features/trading/lib/marketUtils';\nimport { useOneTapProfit } from '@/features/trading/hooks/useOneTapProfitBetting';\nimport { formatDynamicUsd, formatMarketPair } from '@/features/trading/lib/marketUtils';\nimport Image from 'next/image';\nimport { useUSDCBalance } from '@/hooks/data/useUSDCBalance';\nimport { Settings2 } from 'lucide-react';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n  DropdownMenuCheckboxItem,\n} from '@/components/ui/dropdown-menu';\nimport { Button } from '@/components/ui/button';\n\nconst TradingChart: React.FC = () => {\n  const {\n    activeMarket: contextActiveMarket,\n    setActiveMarket,\n    setCurrentPrice,\n    timeframe,\n  } = useMarket();\n\n  const baseMarkets = useMemo<Market[]>(() => ALL_MARKETS, []);\n  const [activeSymbol, setActiveSymbol] = useState<string>(\n    contextActiveMarket?.symbol || baseMarkets[0].symbol,\n  );\n  const [isMarketSelectorOpen, setIsMarketSelectorOpen] = useState(false);\n  const triggerButtonRef = useRef<HTMLButtonElement>(null);\n\n  const tapToTrade = useTapToTrade();\n  const { placeBetWithSession, isPlacingBet, activeBets, sessionPnL } = useOneTapProfit();\n  const { usdcBalance } = useUSDCBalance();\n\n  // Axis Configuration\n  const [axisConfig, setAxisConfig] = useState({\n    showX: true,\n    showY: true,\n    ySide: 'right' as 'left' | 'right',\n  });\n\n  // Set default axis side based on screen width\n  useEffect(() => {\n    const handleResize = () => {\n      if (window.innerWidth < 1024) {\n        setAxisConfig((prev) => ({ ...prev, showX: false, showY: false }));\n      } else {\n        setAxisConfig((prev) => ({ ...prev, ySide: 'right' }));\n      }\n    };\n\n    // Initial check\n    handleResize();\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  const { allPrices, marketDataMap, futuresDataMap, oraclePrices } =\n    useMarketWebSocket(baseMarkets);\n\n  const oracleSymbolsKey = useMemo(\n    () =>\n      Object.keys(oraclePrices || {})\n        .sort()\n        .join('|'),\n    [oraclePrices],\n  );\n\n  const markets = useMemo(\n    () => mergeMarketsWithOracle(baseMarkets, Object.keys(oraclePrices || {})),\n    [baseMarkets, oracleSymbolsKey],\n  );\n\n  useEffect(() => {\n    if (contextActiveMarket && contextActiveMarket.symbol !== activeSymbol) {\n      setActiveSymbol(contextActiveMarket.symbol);\n    }\n  }, [contextActiveMarket, activeSymbol]);\n\n  const activeMarket = useMemo(\n    () => markets.find((m) => m.symbol === activeSymbol) || markets[0],\n    [markets, activeSymbol],\n  );\n\n  const currentMarketData = activeMarket?.binanceSymbol\n    ? marketDataMap[activeMarket.binanceSymbol]\n    : null;\n  const currentFuturesData = activeMarket?.binanceSymbol\n    ? futuresDataMap[activeMarket.binanceSymbol]\n    : null;\n  const currentOraclePrice = activeMarket ? oraclePrices[activeMarket.symbol] : null;\n\n  // Update context when market changes\n  useEffect(() => {\n    if (activeMarket) {\n      setActiveMarket(activeMarket);\n    }\n  }, [activeMarket, setActiveMarket]);\n\n  // Update context when price changes - prioritize Oracle price\n  useEffect(() => {\n    // Use Oracle price if available, fallback to Binance price\n    if (currentOraclePrice?.price) {\n      setCurrentPrice(currentOraclePrice.price.toString());\n    } else if (currentMarketData?.price) {\n      setCurrentPrice(currentMarketData.price);\n    }\n  }, [currentOraclePrice?.price, currentMarketData?.price, setCurrentPrice]);\n\n  const handleMarketSelect = (symbol: string) => {\n    const selectedMarket = markets.find((m) => m.symbol === symbol);\n    if (selectedMarket) {\n      setActiveSymbol(symbol);\n      setActiveMarket(selectedMarket);\n    }\n    setIsMarketSelectorOpen(false);\n  };\n\n  // Handle tap to trade cell click\n  const handleTapCellClick = (cellId: string) => {\n    // Extract cellX and cellY from cellId (format: \"cellX,cellY\")\n    const parts = cellId.split(',');\n    if (parts.length === 2) {\n      const cellX = parseInt(parts[0]);\n      const cellY = parseInt(parts[1]);\n\n      tapToTrade.handleCellClick(cellX, cellY);\n    } else {\n      console.error('❌ Invalid cellId format:', cellId);\n    }\n  };\n\n  // derived values for minimal header\n  const headerDisplayPrice =\n    currentOraclePrice?.price ??\n    (currentMarketData?.price ? parseFloat(currentMarketData.price) : 0);\n  const headerPriceChange = currentMarketData?.priceChangePercent\n    ? parseFloat(currentMarketData.priceChangePercent)\n    : 0;\n  const isHeaderPositive = headerPriceChange >= 0;\n\n  return (\n    <div\n      className=\"w-full h-[95vh] flex flex-col bg-trading-dark text-text-primary relative\"\n      style={{ borderRadius: '0.5rem' }}\n    >\n      {/* Header with market info and controls */}\n      {!tapToTrade.isEnabled ? (\n        <div\n          style={{\n            flexShrink: 0,\n            flexGrow: 0,\n            borderTopLeftRadius: '0.5rem',\n            borderTopRightRadius: '0.5rem',\n            position: 'relative',\n            zIndex: 10,\n          }}\n        >\n          <ChartHeader\n            activeMarket={activeMarket}\n            marketData={currentMarketData}\n            futuresData={currentFuturesData}\n            allPrices={allPrices}\n            marketDataMap={marketDataMap}\n            futuresDataMap={futuresDataMap}\n            oraclePrice={currentOraclePrice}\n            oraclePrices={oraclePrices}\n            onSymbolChangeClick={() => setIsMarketSelectorOpen(!isMarketSelectorOpen)}\n            isMarketSelectorOpen={isMarketSelectorOpen}\n            onClose={() => setIsMarketSelectorOpen(false)}\n            markets={markets}\n            onSelect={handleMarketSelect}\n            triggerRef={triggerButtonRef}\n            disabled={tapToTrade.isEnabled}\n          />\n        </div>\n      ) : (\n        /* Distraction-Free Overlay (Header + PnL) */\n        <>\n          {/* Minimal Header */}\n          <div className=\"flex items-start justify-between px-4 py-3 absolute top-0 left-0 right-0 z-20 pointer-events-none\">\n            {/* Left: Logo, Name & Balance */}\n            <div className=\"flex flex-col gap-1 pointer-events-auto\">\n              <div className=\"flex items-center gap-3\">\n                {activeMarket && (\n                  <Image\n                    src={`${activeMarket.logoUrl || '/icons/usdc.png'}`}\n                    alt={`${activeMarket.symbol}`}\n                    width={26}\n                    height={26}\n                    className=\"w-8 h-8 rounded-full\"\n                    onError={(e) => {\n                      const target = e.currentTarget;\n                      target.style.display = 'none';\n                    }}\n                  />\n                )}\n                <span className=\"font-bold text-text-primary text-2xl\">\n                  {activeMarket ? formatMarketPair(activeMarket.symbol) : ''}\n                </span>\n              </div>\n\n              {/* Wallet Balance */}\n              <div className=\"flex flex-col gap-1 pt-3\">\n                <div className=\"flex gap-2\">\n                  <span className=\"text-background text-sm font-medium\">Your Balance</span>\n                  <button\n                    className=\"w-5 h-5 rounded-full bg-primary hover:bg-primary-hover flex items-center justify-center text-white transition-colors\"\n                    onClick={() => {\n                      /* TODO: Open deposit modal logic  */\n                    }}\n                  >\n                    <svg\n                      width=\"10\"\n                      height=\"10\"\n                      viewBox=\"0 0 10 10\"\n                      fill=\"none\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                    >\n                      <path\n                        d=\"M5 1V9M1 5H9\"\n                        stroke=\"currentColor\"\n                        strokeWidth=\"1.5\"\n                        strokeLinecap=\"round\"\n                        strokeLinejoin=\"round\"\n                      />\n                    </svg>\n                  </button>\n                </div>\n\n                <span className=\"text-text-primary text-xl font-bold\">${usdcBalance}</span>\n              </div>\n            </div>\n\n            {/* Right: Price & Change + Settings */}\n            <div className=\"flex flex-col items-end pointer-events-auto rounded-xl gap-2\">\n              <div className=\"flex flex-col items-end -mt-3 py-4 pl-6 rounded-bl-xl\">\n                <span className=\"font-mono font-bold text-2xl text-text-primary\">\n                  {formatDynamicUsd(headerDisplayPrice)}\n                </span>\n                <span\n                  className={`font-mono text-base font-semibold ${\n                    isHeaderPositive ? 'text-success' : 'text-error'\n                  }`}\n                >\n                  {isHeaderPositive ? '+' : ''}\n                  {headerPriceChange.toFixed(2)}%\n                </span>\n              </div>\n\n              {/* Chart Settings Dropdown */}\n              <DropdownMenu>\n                <DropdownMenuTrigger asChild>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    className=\"h-8 w-8 bg-black/50 hover:bg-black text-text-secondary rounded-full\"\n                  >\n                    <Settings2 size={16} />\n                  </Button>\n                </DropdownMenuTrigger>\n                <DropdownMenuContent\n                  align=\"end\"\n                  className=\"w-56 bg-zinc-950 border-zinc-800 text-slate-200\"\n                >\n                  <DropdownMenuLabel>Chart Settings</DropdownMenuLabel>\n                  <DropdownMenuSeparator />\n                  <DropdownMenuCheckboxItem\n                    checked={axisConfig.showX}\n                    onCheckedChange={(checked) =>\n                      setAxisConfig((prev) => ({ ...prev, showX: checked }))\n                    }\n                  >\n                    Show Time Axis (X)\n                  </DropdownMenuCheckboxItem>\n                  <DropdownMenuCheckboxItem\n                    checked={axisConfig.showY}\n                    onCheckedChange={(checked) =>\n                      setAxisConfig((prev) => ({ ...prev, showY: checked }))\n                    }\n                  >\n                    Show Price Axis (Y)\n                  </DropdownMenuCheckboxItem>\n                  <DropdownMenuSeparator />\n                  <DropdownMenuLabel>Y-Axis Position</DropdownMenuLabel>\n                  <DropdownMenuItem\n                    onClick={() => setAxisConfig((prev) => ({ ...prev, ySide: 'left' }))}\n                    className=\"flex justify-between\"\n                  >\n                    Left {axisConfig.ySide === 'left' && '✓'}\n                  </DropdownMenuItem>\n                  <DropdownMenuItem\n                    onClick={() => setAxisConfig((prev) => ({ ...prev, ySide: 'right' }))}\n                    className=\"flex justify-between\"\n                  >\n                    Right {axisConfig.ySide === 'right' && '✓'}\n                  </DropdownMenuItem>\n                </DropdownMenuContent>\n              </DropdownMenu>\n            </div>\n          </div>\n\n          {/* Bottom Session PnL */}\n          <div\n            className={`absolute lg:bottom-1/10 bottom-20 pointer-events-auto px-4 py-2 rounded-full flex flex-col items-center gap-2 shadow-lg z-10 transition-all duration-300 ${\n              tapToTrade.tradeMode === 'one-tap-profit'\n                ? 'left-1/2 -translate-x-1/2' // Center for Tap Profit\n                : 'left-4' // Left for Open Position\n            }`}\n          >\n            <span className=\"text-lg font-medium text-text-secondary\">Session PnL</span>\n            <span\n              className={`font-mono font-bold text-4xl ${\n                sessionPnL >= 0 ? 'text-success' : 'text-error'\n              }`}\n            >\n              {sessionPnL >= 0 ? '+' : ''}\n              {formatDynamicUsd(sessionPnL)}\n            </span>\n          </div>\n        </>\n      )}\n\n      {/* Chart container */}\n      <div\n        className=\"trading-chart-container w-full\"\n        style={{\n          flex: '1 1 auto',\n          minHeight: 0,\n          position: 'relative',\n          zIndex: 1,\n        }}\n      >\n        {activeMarket && (\n          <>\n            {tapToTrade.isEnabled && activeMarket?.binanceSymbol ? (\n              <PerSecondChart\n                key={`${activeMarket.symbol}-smooth-chart`}\n                symbol={activeMarket.symbol}\n                currentPrice={parseFloat(\n                  currentOraclePrice?.price?.toString() || currentMarketData?.price || '0',\n                )}\n                betAmount={tapToTrade.betAmount}\n                isBinaryTradingEnabled={tapToTrade.isBinaryTradingEnabled}\n                isPlacingBet={isPlacingBet}\n                logoUrl={activeMarket.logoUrl}\n                activeBets={activeBets} // Pass active bets\n                tradeMode={tapToTrade.tradeMode} // Pass tradeMode explicitly\n                // Pass axis props\n                yAxisSide={axisConfig.ySide}\n                showXAxis={axisConfig.showX}\n                showYAxis={axisConfig.showY}\n                {...(tapToTrade.tradeMode === 'open-position' && tapToTrade.gridSession\n                  ? {\n                      gridIntervalSeconds:\n                        tapToTrade.gridSession.gridSizeX * tapToTrade.gridSession.timeframeSeconds,\n                      gridPriceStep:\n                        (parseFloat(tapToTrade.gridSession.referencePrice) / 100000000) *\n                        (tapToTrade.gridSession.gridSizeYPercent / 10000),\n                      gridAnchorPrice:\n                        parseFloat(tapToTrade.gridSession.referencePrice) / 100000000,\n                      gridAnchorTime: tapToTrade.gridSession.referenceTime,\n                    }\n                  : {})}\n                onCellClick={(targetPrice, targetTime, entryPrice, entryTime) => {\n                  if (tapToTrade.tradeMode === 'one-tap-profit') {\n                    placeBetWithSession(\n                      {\n                        symbol: activeMarket.symbol,\n                        betAmount: tapToTrade.betAmount || '10',\n                        targetPrice: targetPrice.toString(),\n                        targetTime: targetTime,\n                        entryPrice: entryPrice.toString(),\n                        entryTime: entryTime,\n                      },\n                      {\n                        sessionKey: tapToTrade.sessionKey,\n                        sessionSigner: tapToTrade.signWithSession,\n                      },\n                    );\n                  } else if (tapToTrade.tradeMode === 'open-position' && tapToTrade.gridSession) {\n                    // Open Position mode - map click to grid cell\n                    const session = tapToTrade.gridSession;\n                    const refPrice = parseFloat(session.referencePrice) / 100000000;\n                    const gridPriceStep = refPrice * (session.gridSizeYPercent / 10000);\n                    const gridInterval = session.gridSizeX * session.timeframeSeconds;\n\n                    // Calculate cell indices\n                    // Cell Y: How many steps from reference price?\n                    // Note: targetPrice corresponds to the BOTTOM of the cell in PerSecondChart logic?\n                    // No, PerSecondChart logic returns CENTER of cell now?\n                    // Wait, I check PerSecondChart handleMouseUp:\n                    // const targetPrice = gridBottomPrice + GRID_Y_DOLLARS / 2;\n                    // So targetPrice is CENTER.\n\n                    // We need to find the integer index.\n                    // cellY = (center - ref) / step\n                    // This will result in X.5.\n                    // So math.floor(val) should give the index if positive?\n                    // Let's use the bottom price explicitly if we can, but we receive targetPrice (center).\n                    // Center = ref + cellY * step + step/2\n                    // Center - ref = step * (cellY + 0.5)\n                    // (Center - ref) / step = cellY + 0.5\n                    // cellY = round((Center - ref) / step - 0.5)\n\n                    const priceDiff = targetPrice - refPrice;\n                    const cellY = Math.round(priceDiff / gridPriceStep - 0.5);\n\n                    // Cell X: Time steps from reference time\n                    // targetTime in PerSecondChart is END of cell.\n                    // targetTime = start + duration\n                    // start = ref + cellX * duration\n                    // targetTime = ref + (cellX + 1) * duration\n                    // (targetTime - ref) / duration = cellX + 1\n                    // cellX = round((targetTime - ref) / duration - 1)\n\n                    const timeDiff = targetTime - session.referenceTime;\n                    const cellX = Math.round(timeDiff / gridInterval - 1);\n\n                    tapToTrade.handleCellClick(cellX, cellY);\n                  }\n                }}\n              />\n            ) : (\n              <TradingViewWidget\n                key={`${activeMarket.symbol}`}\n                symbol={activeMarket.tradingViewSymbol}\n              />\n            )}\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default TradingChart;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3648, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/wallet/hooks/useEmbeddedWallet.ts"],"sourcesContent":["/**\n * Hook to get Privy embedded wallet address\n */\n\nimport { usePrivy } from '@privy-io/react-auth';\nimport { useMemo } from 'react';\n\ninterface EmbeddedWalletAccount {\n  type: string;\n  imported: boolean;\n  id?: string;\n  address: string;\n}\n\nexport function useEmbeddedWallet() {\n  const { user } = usePrivy();\n\n  const embeddedWallet = useMemo(() => {\n    if (!user?.linkedAccounts) return null;\n\n    const wallets = user.linkedAccounts.filter(\n      (account: unknown) => {\n        const acc = account as { type: string; imported: boolean; id?: string };\n        return acc.type === 'wallet' && acc.imported === false && acc.id !== undefined;\n      }\n    ) as EmbeddedWalletAccount[];\n\n    return wallets?.[0] || null;\n  }, [user]);\n\n  return {\n    address: embeddedWallet?.address as `0x${string}` | undefined,\n    hasEmbeddedWallet: !!embeddedWallet,\n    embeddedWallet,\n  };\n}\n"],"names":[],"mappings":"AAAA;;CAEC;;;;AAED;AACA;;;AASO,SAAS;IACd,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,mOAAQ;IAEzB,MAAM,iBAAiB,IAAA,gNAAO,EAAC;QAC7B,IAAI,CAAC,MAAM,gBAAgB,OAAO;QAElC,MAAM,UAAU,KAAK,cAAc,CAAC,MAAM,CACxC,CAAC;YACC,MAAM,MAAM;YACZ,OAAO,IAAI,IAAI,KAAK,YAAY,IAAI,QAAQ,KAAK,SAAS,IAAI,EAAE,KAAK;QACvE;QAGF,OAAO,SAAS,CAAC,EAAE,IAAI;IACzB,GAAG;QAAC;KAAK;IAET,OAAO;QACL,SAAS,gBAAgB;QACzB,mBAAmB,CAAC,CAAC;QACrB;IACF;AACF"}},
    {"offset": {"line": 3680, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/hooks/useMarketOrder.ts"],"sourcesContent":["/**\n * Hooks for Market Order Trading with MarketExecutor\n */\n\nimport { useReadContract, useWaitForTransactionReceipt } from 'wagmi';\nimport { parseUnits, encodeFunctionData, keccak256, encodePacked } from 'viem';\nimport { useState, useCallback, useEffect } from 'react';\nimport { baseSepolia } from 'wagmi/chains';\nimport { useWallets } from '@privy-io/react-auth';\nimport { MARKET_EXECUTOR_ADDRESS, USDC_ADDRESS, USDC_DECIMALS } from '@/config/contracts';\nimport MarketExecutorJSON from '@/contracts/abis/MarketExecutor.json';\nimport MockUSDCABI from '@/contracts/abis/MockUSDC.json';\n\n// Extract ABI array from MarketExecutor JSON (has {abi: [...]} structure)\n// MockUSDC is already array format\nconst MarketExecutorABI = (MarketExecutorJSON as any).abi;\nimport { getSignedPrice, SignedPriceData } from '@/lib/priceApi';\nimport { relayTransaction } from '@/lib/relayApi';\nimport { toast } from 'sonner';\nimport { useEmbeddedWallet } from '@/features/wallet/hooks/useEmbeddedWallet';\n\nexport interface OpenPositionParams {\n  symbol: string;\n  isLong: boolean;\n  collateral: string; // USDC amount\n  leverage: number;\n}\n\nexport interface ClosePositionParams {\n  positionId: bigint;\n  symbol: string;\n}\n\n/**\n * Hook to check and approve USDC for MarketExecutor\n */\nexport function useApproveUSDCForTrading() {\n  const { address } = useEmbeddedWallet();\n  const { wallets } = useWallets();\n  const [hash, setHash] = useState<`0x${string}` | undefined>();\n  const [isPending, setIsPending] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const { isLoading: isConfirming, isSuccess } = useWaitForTransactionReceipt({\n    hash,\n  });\n\n  // Check current allowance - with auto-polling every 2 seconds for real-time updates\n  const { data: allowance, refetch: refetchAllowance } = useReadContract({\n    address: USDC_ADDRESS,\n    abi: MockUSDCABI,\n    functionName: 'allowance',\n    args: address ? [address, MARKET_EXECUTOR_ADDRESS] : undefined,\n    query: {\n      enabled: !!address,\n      refetchInterval: 2000, // Poll every 2 seconds for real-time allowance updates\n    },\n  });\n\n  const approve = async (amount: string) => {\n    try {\n      setIsPending(true);\n      setError(null);\n\n      const embeddedWallet = wallets.find(\n        (w) => w.walletClientType === 'privy' && w.address === address,\n      );\n\n      if (!embeddedWallet) {\n        throw new Error('Embedded wallet not found');\n      }\n\n      await embeddedWallet.switchChain(baseSepolia.id);\n      const walletClient = await embeddedWallet.getEthereumProvider();\n\n      if (!walletClient) {\n        throw new Error('Could not get wallet client');\n      }\n\n      const amountBigInt = parseUnits(amount, USDC_DECIMALS);\n\n      const data = encodeFunctionData({\n        abi: MockUSDCABI,\n        functionName: 'approve',\n        args: [MARKET_EXECUTOR_ADDRESS, amountBigInt],\n      });\n\n      // Estimate gas\n      const gasEstimate = await walletClient.request({\n        method: 'eth_estimateGas',\n        params: [\n          {\n            from: address,\n            to: USDC_ADDRESS,\n            data,\n          },\n        ],\n      });\n      const gasLimit = (BigInt(gasEstimate as string) * 120n) / 100n;\n\n      const txHash = await walletClient.request({\n        method: 'eth_sendTransaction',\n        params: [\n          {\n            from: address,\n            to: USDC_ADDRESS,\n            data,\n            gas: '0x' + gasLimit.toString(16),\n          },\n        ],\n      });\n\n      setHash(txHash as `0x${string}`);\n    } catch (err) {\n      console.error('❌ Approve error:', err);\n      setError(err as Error);\n    } finally {\n      setIsPending(false);\n    }\n  };\n\n  const hasAllowance = (requiredAmount: string): boolean => {\n    if (!allowance) return false;\n    const required = parseUnits(requiredAmount, USDC_DECIMALS);\n    return (allowance as bigint) >= required;\n  };\n\n  // Auto-refetch allowance when approval transaction is confirmed\n  useEffect(() => {\n    if (isSuccess) {\n      refetchAllowance();\n    }\n  }, [isSuccess, refetchAllowance]);\n\n  return {\n    approve,\n    isPending,\n    isConfirming,\n    isSuccess,\n    error,\n    hash,\n    allowance: allowance as bigint | undefined,\n    hasAllowance,\n    refetchAllowance,\n  };\n}\n\n/**\n * Hook to open a market position\n */\nexport function useOpenMarketPosition() {\n  const { address } = useEmbeddedWallet();\n  const { wallets } = useWallets();\n  const [isLoadingPrice, setIsLoadingPrice] = useState(false);\n  const [hash, setHash] = useState<`0x${string}` | undefined>();\n  const [isPending, setIsPending] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const { isLoading: isConfirming, isSuccess } = useWaitForTransactionReceipt({\n    hash,\n  });\n\n  const openPosition = useCallback(\n    async (params: OpenPositionParams) => {\n      try {\n        setIsLoadingPrice(true);\n        setIsPending(true);\n        setError(null);\n\n        // Get signed price from backend\n        const signedPrice: SignedPriceData = await getSignedPrice(params.symbol);\n\n        setIsLoadingPrice(false);\n\n        // Parse collateral\n        const collateralBigInt = parseUnits(params.collateral, USDC_DECIMALS);\n\n        // Calculate total fee (trading fee)\n        const positionSize = collateralBigInt * BigInt(params.leverage);\n        const tradingFee = (positionSize * 5n) / 10000n; // 0.05% = 5 basis points\n\n        // Total amount needed: collateral + fee\n        const totalAmount = collateralBigInt + tradingFee;\n\n        // Find embedded wallet\n        const embeddedWallet = wallets.find(\n          (w) => w.walletClientType === 'privy' && w.address === address,\n        );\n\n        if (!embeddedWallet) {\n          throw new Error('Embedded wallet not found');\n        }\n\n        await embeddedWallet.switchChain(baseSepolia.id);\n        const walletClient = await embeddedWallet.getEthereumProvider();\n\n        if (!walletClient) {\n          throw new Error('Could not get wallet client');\n        }\n\n        // Encode function call\n        const data = encodeFunctionData({\n          abi: MarketExecutorABI,\n          functionName: 'openMarketPosition',\n          args: [\n            params.symbol,\n            params.isLong,\n            collateralBigInt,\n            BigInt(params.leverage),\n            {\n              symbol: params.symbol, // Contract expects symbol string, not assetId\n              price: BigInt(signedPrice.price),\n              timestamp: BigInt(signedPrice.timestamp),\n              signature: signedPrice.signature as `0x${string}`,\n            },\n          ],\n        });\n\n        const now = Math.floor(Date.now() / 1000);\n        const timeDiff = signedPrice.timestamp - now;\n\n        if (timeDiff > 0) {\n          throw new Error(\n            `Price timestamp is ${timeDiff}s in the future! Backend clock may be wrong.`,\n          );\n        }\n\n        // Check USDC allowance\n        try {\n          const allowanceCheck = await walletClient.request({\n            method: 'eth_call',\n            params: [\n              {\n                to: USDC_ADDRESS,\n                data: encodeFunctionData({\n                  abi: MockUSDCABI,\n                  functionName: 'allowance',\n                  args: [address, MARKET_EXECUTOR_ADDRESS],\n                }),\n              },\n              'latest',\n            ],\n          });\n          const allowanceBigInt = BigInt(allowanceCheck as string);\n\n          if (allowanceBigInt < totalAmount) {\n            throw new Error(\n              `Insufficient USDC allowance. Have: ${allowanceBigInt}, Need: ${totalAmount}. Please approve USDC first.`,\n            );\n          }\n        } catch (err: any) {\n          console.error('❌ Allowance check failed:', err);\n          if (err.message?.includes('Insufficient')) throw err;\n        }\n\n        // Check USDC balance\n        try {\n          const balanceCheck = await walletClient.request({\n            method: 'eth_call',\n            params: [\n              {\n                to: USDC_ADDRESS,\n                data: encodeFunctionData({\n                  abi: MockUSDCABI,\n                  functionName: 'balanceOf',\n                  args: [address],\n                }),\n              },\n              'latest',\n            ],\n          });\n          const balanceBigInt = BigInt(balanceCheck as string);\n\n          if (balanceBigInt < totalAmount) {\n            throw new Error(\n              `Insufficient USDC balance. Have: ${balanceBigInt}, Need: ${totalAmount}`,\n            );\n          }\n        } catch (err: any) {\n          console.error('❌ Balance check failed:', err);\n          if (err.message?.includes('Insufficient')) throw err;\n        }\n\n        // Estimate gas first\n        let gasEstimate: bigint;\n        try {\n          const estimate = await walletClient.request({\n            method: 'eth_estimateGas',\n            params: [\n              {\n                from: address,\n                to: MARKET_EXECUTOR_ADDRESS,\n                data,\n              },\n            ],\n          });\n          gasEstimate = typeof estimate === 'string' ? BigInt(estimate) : (estimate as bigint);\n        } catch (err) {\n          console.error('❌ Gas estimation failed:', err);\n          throw new Error(\n            'Transaction will fail. Check: 1) Signature validity 2) Sufficient allowance 3) Contract state',\n          );\n        }\n\n        // Add 20% buffer to gas estimate\n        const gasLimit = (gasEstimate * 120n) / 100n;\n\n        // Send transaction with gas limit\n        const txHash = await walletClient.request({\n          method: 'eth_sendTransaction',\n          params: [\n            {\n              from: address,\n              to: MARKET_EXECUTOR_ADDRESS,\n              data,\n              gas: '0x' + gasLimit.toString(16),\n            },\n          ],\n        });\n\n        setHash(txHash as `0x${string}`);\n      } catch (err) {\n        setIsLoadingPrice(false);\n        console.error('❌ Error opening position:', err);\n        setError(err as Error);\n        toast.error('Failed to open position: ' + (err as Error).message);\n        throw err;\n      } finally {\n        setIsPending(false);\n      }\n    },\n    [address, wallets],\n  );\n\n  return {\n    openPosition,\n    isPending: isPending || isLoadingPrice,\n    isConfirming,\n    isSuccess,\n    error,\n    hash,\n    isLoadingPrice,\n  };\n}\n\n/**\n * Hook to close a market position (non-gasless version - user pays gas)\n * Use this as fallback when gasless version has issues\n */\nexport function useCloseMarketPosition() {\n  const { address } = useEmbeddedWallet();\n  const { wallets } = useWallets();\n  const [isLoadingPrice, setIsLoadingPrice] = useState(false);\n  const [hash, setHash] = useState<`0x${string}` | undefined>();\n  const [isPending, setIsPending] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const { isLoading: isConfirming, isSuccess } = useWaitForTransactionReceipt({\n    hash,\n  });\n\n  const closePosition = useCallback(\n    async (params: ClosePositionParams) => {\n      try {\n        setIsLoadingPrice(true);\n        setIsPending(true);\n        setError(null);\n\n        if (!address) {\n          throw new Error('Wallet not connected');\n        }\n\n        // Find embedded wallet\n        const embeddedWallet = wallets.find(\n          (w) => w.walletClientType === 'privy' && w.address === address,\n        );\n\n        if (!embeddedWallet) {\n          throw new Error('Embedded wallet not found');\n        }\n\n        // Get signed price from backend\n        const signedPrice: SignedPriceData = await getSignedPrice(params.symbol);\n\n        setIsLoadingPrice(false);\n\n        await embeddedWallet.switchChain(baseSepolia.id);\n        const walletClient = await embeddedWallet.getEthereumProvider();\n\n        if (!walletClient) {\n          throw new Error('Could not get wallet client');\n        }\n\n        // Encode function call\n        const data = encodeFunctionData({\n          abi: MarketExecutorABI,\n          functionName: 'closeMarketPosition',\n          args: [\n            params.positionId,\n            {\n              symbol: params.symbol,\n              price: BigInt(signedPrice.price),\n              timestamp: BigInt(signedPrice.timestamp),\n              signature: signedPrice.signature as `0x${string}`,\n            },\n          ],\n        });\n\n        // Estimate gas\n        const gasEstimate = await walletClient.request({\n          method: 'eth_estimateGas',\n          params: [\n            {\n              from: address,\n              to: MARKET_EXECUTOR_ADDRESS,\n              data,\n            },\n          ],\n        });\n\n        const gasLimit = (BigInt(gasEstimate as string) * 120n) / 100n; // 20% buffer\n\n        // Send transaction (user pays gas)\n        const txHash = await walletClient.request({\n          method: 'eth_sendTransaction',\n          params: [\n            {\n              from: address,\n              to: MARKET_EXECUTOR_ADDRESS,\n              data,\n              gas: '0x' + gasLimit.toString(16),\n            },\n          ],\n        });\n\n        setHash(txHash as `0x${string}`);\n      } catch (err) {\n        setIsLoadingPrice(false);\n        console.error('\\u274c Error closing position:', err);\n        setError(err as Error);\n        toast.error('Failed to close position: ' + (err as Error).message);\n        throw err;\n      } finally {\n        setIsPending(false);\n      }\n    },\n    [address, wallets],\n  );\n\n  return {\n    closePosition,\n    isPending: isPending || isLoadingPrice,\n    isConfirming,\n    isSuccess,\n    error,\n    hash,\n    isLoadingPrice,\n  };\n}\n\n/**\n * Hook to get trading fees\n */\nexport function useTradingFees() {\n  const { data, isLoading } = useReadContract({\n    address: MARKET_EXECUTOR_ADDRESS,\n    abi: MarketExecutorABI,\n    functionName: 'tradingFeeBps',\n  });\n\n  const tradingFeeBps = data as bigint | undefined;\n\n  return {\n    tradingFeeBps,\n    tradingFeePercent: tradingFeeBps ? Number(tradingFeeBps) / 100 : 0.05, // Default 0.05%\n    isLoading,\n  };\n}\n\n/**\n * Calculate total cost for opening a position (collateral + fee)\n */\nexport function calculatePositionCost(\n  collateralUsd: string,\n  leverage: number,\n  tradingFeeBps: number = 5, // Default 0.05%\n): { totalCost: string; tradingFee: string; positionSize: string } {\n  try {\n    const collateral = parseFloat(collateralUsd);\n    if (isNaN(collateral) || collateral <= 0) {\n      return { totalCost: '0', tradingFee: '0', positionSize: '0' };\n    }\n\n    const positionSize = collateral * leverage;\n    const tradingFee = (positionSize * tradingFeeBps) / 100000;\n    const totalCost = collateral + tradingFee;\n\n    return {\n      totalCost: totalCost.toFixed(6),\n      tradingFee: tradingFee.toFixed(6),\n      positionSize: positionSize.toFixed(2),\n    };\n  } catch (error) {\n    console.error('Error calculating position cost:', error);\n    return { totalCost: '0', tradingFee: '0', positionSize: '0' };\n  }\n}\n\n/**\n * Combined hook for complete market order flow\n */\nexport function useMarketOrderFlow() {\n  const {\n    approve,\n    hasAllowance,\n    isSuccess: isApproveSuccess,\n    isPending: isApprovePending,\n    refetchAllowance,\n  } = useApproveUSDCForTrading();\n\n  const {\n    openPosition,\n    isSuccess: isOpenSuccess,\n    isPending: isOpenPending,\n    hash: openHash,\n    error: openError,\n  } = useOpenMarketPosition();\n\n  const [step, setStep] = useState<'idle' | 'approving' | 'opening' | 'success' | 'error'>('idle');\n  const [pendingParams, setPendingParams] = useState<OpenPositionParams | null>(null);\n\n  /**\n   * Execute full flow: check allowance -> approve if needed -> open position\n   */\n  const executeMarketOrder = useCallback(\n    async (params: OpenPositionParams) => {\n      try {\n        setStep('idle');\n        setPendingParams(params); // Save params for retry after approval\n\n        // Calculate total amount needed\n        const { totalCost } = calculatePositionCost(params.collateral, params.leverage);\n\n        // Check if allowance is sufficient\n        if (!hasAllowance(totalCost)) {\n          setStep('approving');\n          toast.loading('Approving USDC...', { id: 'market-order' });\n          await approve(totalCost);\n          // Wait for approval - will auto-continue via useEffect\n          return;\n        }\n\n        // Open position\n        setStep('opening');\n        toast.loading('Opening position...', { id: 'market-order' });\n        await openPosition(params);\n        setPendingParams(null); // Clear after successful open\n      } catch (error) {\n        setStep('error');\n        setPendingParams(null);\n        console.error('Error executing market order:', error);\n        toast.error('Failed to execute market order', { id: 'market-order' });\n      }\n    },\n    [approve, hasAllowance, openPosition],\n  );\n\n  // Handle approval success - auto-continue to open position\n  useEffect(() => {\n    if (isApproveSuccess && step === 'approving' && pendingParams) {\n      refetchAllowance();\n      toast.success('USDC approved! Opening position...', { id: 'market-order' });\n\n      // Continue with opening position\n      setStep('opening');\n      openPosition(pendingParams)\n        .then(() => {\n          setPendingParams(null);\n        })\n        .catch((err) => {\n          console.error('Error opening position after approval:', err);\n          setStep('error');\n          setPendingParams(null);\n          toast.error('Failed to open position', { id: 'market-order' });\n        });\n    }\n  }, [isApproveSuccess, step, pendingParams, refetchAllowance, openPosition]);\n\n  // Handle open success\n  useEffect(() => {\n    if (isOpenSuccess && step === 'opening') {\n      setStep('success');\n      toast.success('Position opened successfully!', { id: 'market-order' });\n    }\n  }, [isOpenSuccess, step]);\n\n  // Handle open error\n  useEffect(() => {\n    if (openError && step === 'opening') {\n      setStep('error');\n      toast.error('Failed to open position', { id: 'market-order' });\n    }\n  }, [openError, step]);\n\n  return {\n    executeMarketOrder,\n    step,\n    isProcessing: isApprovePending || isOpenPending,\n    openHash,\n    openError,\n  };\n}\n\n/**\n| * Hook for GASLESS market orders using relay service\n| * User pays gas in USDC from paymaster deposit\n| */\nexport function useRelayMarketOrder() {\n  const { address } = useEmbeddedWallet();\n  const { wallets } = useWallets();\n  const [hash, setHash] = useState<`0x${string}` | undefined>();\n  const [isPending, setIsPending] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const [isSuccess, setIsSuccess] = useState(false);\n  const [usdcCharged, setUsdcCharged] = useState<string>('0');\n  const [metaNonce, setMetaNonce] = useState<bigint>(0n);\n  const [positionId, setPositionId] = useState<number | undefined>();\n\n  const openPositionGasless = useCallback(\n    async (params: OpenPositionParams) => {\n      try {\n        setIsPending(true);\n        setError(null);\n        setIsSuccess(false);\n\n        if (!address) {\n          throw new Error('Wallet not connected');\n        }\n\n        // Find embedded wallet\n        const embeddedWallet = wallets.find(\n          (w) => w.walletClientType === 'privy' && w.address === address,\n        );\n\n        if (!embeddedWallet) {\n          throw new Error('Embedded wallet not found');\n        }\n\n        await embeddedWallet.switchChain(baseSepolia.id);\n        const walletClient = await embeddedWallet.getEthereumProvider();\n\n        if (!walletClient) {\n          throw new Error('Could not get wallet client');\n        }\n\n        // Get signed price from backend\n        const signedPrice: SignedPriceData = await getSignedPrice(params.symbol);\n\n        // Parse collateral\n        const collateralBigInt = parseUnits(params.collateral, USDC_DECIMALS);\n\n        // Fetch current nonce for this user from contract (ALWAYS fetch fresh nonce!)\n        let currentNonce: bigint;\n        try {\n          const nonceData = encodeFunctionData({\n            abi: MarketExecutorABI,\n            functionName: 'metaNonces',\n            args: [address],\n          });\n\n          const nonceResult = await walletClient.request({\n            method: 'eth_call',\n            params: [\n              {\n                to: MARKET_EXECUTOR_ADDRESS,\n                data: nonceData,\n              },\n              'latest',\n            ],\n          });\n\n          currentNonce = BigInt(nonceResult as string);\n          setMetaNonce(currentNonce);\n        } catch (err) {\n          console.error('❌ Error fetching nonce:', err);\n          throw new Error('Failed to fetch nonce from contract');\n        }\n\n        // Create message to sign (must match contract's message format)\n        const messageHash = keccak256(\n          encodePacked(\n            ['address', 'string', 'bool', 'uint256', 'uint256', 'uint256', 'address'],\n            [\n              address,\n              params.symbol,\n              params.isLong,\n              collateralBigInt,\n              BigInt(params.leverage),\n              currentNonce, // Use freshly fetched nonce\n              MARKET_EXECUTOR_ADDRESS,\n            ],\n          ),\n        );\n\n        // Request signature from user\n        const userSignature = await walletClient.request({\n          method: 'personal_sign',\n          params: [messageHash, address],\n        });\n\n        // Encode meta-transaction function call\n        const data = encodeFunctionData({\n          abi: MarketExecutorABI,\n          functionName: 'openMarketPositionMeta',\n          args: [\n            address, // trader\n            params.symbol,\n            params.isLong,\n            collateralBigInt,\n            BigInt(params.leverage),\n            {\n              symbol: params.symbol,\n              price: BigInt(signedPrice.price),\n              timestamp: BigInt(signedPrice.timestamp),\n              signature: signedPrice.signature as `0x${string}`,\n            },\n            userSignature as `0x${string}`, // user's signature\n          ],\n        });\n\n        // Relay transaction through backend (gasless!)\n        const result = await relayTransaction({\n          to: MARKET_EXECUTOR_ADDRESS,\n          data,\n          userAddress: address,\n        });\n\n        setHash(result.txHash as `0x${string}`);\n        setUsdcCharged(result.usdcChargedFormatted);\n        // Note: positionId needs to be extracted from transaction receipt or logs\n        // For now, we'll set to 0 as a placeholder\n        setPositionId(0);\n        setIsSuccess(true);\n\n        // Don't show toast here - let the component handle it with more details\n      } catch (err) {\n        console.error('❌ Error opening position (gasless):', err);\n        setError(err as Error);\n        toast.error((err as Error).message || 'Failed to open position');\n        throw err;\n      } finally {\n        setIsPending(false);\n      }\n    },\n    [address, wallets],\n  );\n\n  return {\n    openPositionGasless,\n    isPending,\n    isSuccess,\n    error,\n    hash,\n    usdcCharged,\n    positionId,\n  };\n}\n\n/**\n * Hook for GASLESS close position using relay service\n */\nexport function useRelayClosePosition() {\n  const { address } = useEmbeddedWallet();\n  const { wallets } = useWallets();\n  const [hash, setHash] = useState<`0x${string}` | undefined>();\n  const [isPending, setIsPending] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const [isSuccess, setIsSuccess] = useState(false);\n\n  const closePositionGasless = useCallback(\n    async (params: ClosePositionParams) => {\n      try {\n        setIsPending(true);\n        setError(null);\n        setIsSuccess(false);\n\n        if (!address) {\n          throw new Error('Wallet not connected');\n        }\n\n        // Find embedded wallet\n        const embeddedWallet = wallets.find(\n          (w) => w.walletClientType === 'privy' && w.address === address,\n        );\n\n        if (!embeddedWallet) {\n          throw new Error('Embedded wallet not found');\n        }\n\n        await embeddedWallet.switchChain(baseSepolia.id);\n        const walletClient = await embeddedWallet.getEthereumProvider();\n\n        if (!walletClient) {\n          throw new Error('Could not get wallet client');\n        }\n\n        // Get signed price from backend\n        const signedPrice: SignedPriceData = await getSignedPrice(params.symbol);\n\n        // Fetch current nonce for this user from contract (ALWAYS fetch fresh nonce!)\n        let currentNonce: bigint;\n        try {\n          const nonceData = encodeFunctionData({\n            abi: MarketExecutorABI,\n            functionName: 'metaNonces',\n            args: [address],\n          });\n\n          const nonceResult = await walletClient.request({\n            method: 'eth_call',\n            params: [\n              {\n                to: MARKET_EXECUTOR_ADDRESS,\n                data: nonceData,\n              },\n              'latest',\n            ],\n          });\n\n          currentNonce = BigInt(nonceResult as string);\n        } catch (err) {\n          console.error('\\u274c Error fetching nonce:', err);\n          throw new Error('Failed to fetch nonce from contract');\n        }\n\n        // Create message to sign (must match contract's message format for closeMarketPositionMeta)\n        const packedData = encodePacked(\n          ['address', 'uint256', 'uint256', 'address'],\n          [address, params.positionId, currentNonce, MARKET_EXECUTOR_ADDRESS],\n        );\n        const messageHash = keccak256(packedData);\n\n        // Request signature from user\n        const userSignature = await walletClient.request({\n          method: 'personal_sign',\n          params: [messageHash, address],\n        });\n\n        // Encode close position meta function call\n        const data = encodeFunctionData({\n          abi: MarketExecutorABI,\n          functionName: 'closeMarketPositionMeta',\n          args: [\n            address, // trader\n            params.positionId,\n            {\n              symbol: params.symbol,\n              price: BigInt(signedPrice.price),\n              timestamp: BigInt(signedPrice.timestamp),\n              signature: signedPrice.signature as `0x${string}`,\n            },\n            userSignature as `0x${string}`, // user's signature\n          ],\n        });\n\n        // Relay transaction through backend (gasless!)\n        const result = await relayTransaction({\n          to: MARKET_EXECUTOR_ADDRESS,\n          data,\n          userAddress: address,\n        });\n\n        setHash(result.txHash as `0x${string}`);\n        setIsSuccess(true);\n\n        toast.success(`Position closed successfully!`, { duration: 5000 });\n      } catch (err) {\n        console.error('\\u274c Error closing position (gasless):', err);\n        setError(err as Error);\n        toast.error((err as Error).message || 'Failed to close position');\n        throw err;\n      } finally {\n        setIsPending(false);\n      }\n    },\n    [address, wallets],\n  );\n\n  return {\n    closePositionGasless,\n    isPending,\n    isSuccess,\n    error,\n    hash,\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4496, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/wallet/hooks/usePaymaster.ts"],"sourcesContent":["/**\n * Hooks for USDC Paymaster interactions\n */\n\nimport {\n  useReadContract,\n  useWaitForTransactionReceipt,\n  usePublicClient,\n  useWriteContract,\n} from 'wagmi';\nimport { parseUnits, formatUnits, encodeFunctionData } from 'viem';\nimport { useState, useEffect } from 'react';\nimport { baseSepolia } from 'wagmi/chains';\nimport { useWallets } from '@privy-io/react-auth';\nimport { USDC_PAYMASTER_ADDRESS, USDC_ADDRESS, USDC_DECIMALS } from '@/config/contracts';\nimport USDCPaymasterABI from '@/contracts/abis/USDCPaymaster.json';\nimport MockUSDCABI from '@/contracts/abis/MockUSDC.json';\nimport { useEmbeddedWallet } from './useEmbeddedWallet';\n\n/**\n * Hook to get user's USDC deposit balance in paymaster\n */\nexport function usePaymasterBalance() {\n  const { address } = useEmbeddedWallet();\n\n  const {\n    data: balance,\n    isLoading,\n    refetch,\n  } = useReadContract({\n    address: USDC_PAYMASTER_ADDRESS,\n    abi: USDCPaymasterABI,\n    functionName: 'getUserDeposit',\n    args: address ? [address] : undefined,\n    query: {\n      enabled: !!address,\n    },\n  });\n\n  return {\n    balance: balance ? formatUnits(balance as bigint, USDC_DECIMALS) : '0',\n    balanceRaw: balance as bigint | undefined,\n    isLoading,\n    refetch,\n  };\n}\n\n/**\n * Hook to deposit USDC to paymaster\n */\nexport function useDepositToPaymaster() {\n  const { address } = useEmbeddedWallet();\n  const { wallets } = useWallets();\n  const [hash, setHash] = useState<`0x${string}` | undefined>();\n  const [isPending, setIsPending] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const { isLoading: isConfirming, isSuccess } = useWaitForTransactionReceipt({\n    hash,\n  });\n\n  const deposit = async (amount: string) => {\n    try {\n      setIsPending(true);\n      setError(null);\n\n      const embeddedWallet = wallets.find(\n        (w) => w.walletClientType === 'privy' && w.address === address,\n      );\n\n      if (!embeddedWallet) {\n        throw new Error('Embedded wallet not found');\n      }\n\n      await embeddedWallet.switchChain(baseSepolia.id);\n      const walletClient = await embeddedWallet.getEthereumProvider();\n\n      if (!walletClient) {\n        throw new Error('Could not get wallet client');\n      }\n\n      const amountBigInt = parseUnits(amount, USDC_DECIMALS);\n\n      const data = encodeFunctionData({\n        abi: USDCPaymasterABI,\n        functionName: 'deposit',\n        args: [amountBigInt],\n      });\n\n      const txHash = await walletClient.request({\n        method: 'eth_sendTransaction',\n        params: [\n          {\n            from: address,\n            to: USDC_PAYMASTER_ADDRESS,\n            data,\n          },\n        ],\n      });\n\n      setHash(txHash as `0x${string}`);\n    } catch (err) {\n      console.error('❌ Deposit error:', err);\n      setError(err as Error);\n    } finally {\n      setIsPending(false);\n    }\n  };\n\n  return {\n    deposit,\n    isPending,\n    isConfirming,\n    isSuccess,\n    error,\n    hash,\n  };\n}\n\n/**\n * Hook to withdraw USDC from paymaster\n */\nexport function useWithdrawFromPaymaster() {\n  const { writeContractAsync, data: hash, isPending, error } = useWriteContract();\n  const { isLoading: isConfirming, isSuccess } = useWaitForTransactionReceipt({\n    hash,\n  });\n\n  const withdraw = async (amount: string) => {\n    const amountBigInt = parseUnits(amount, USDC_DECIMALS);\n\n    await writeContractAsync({\n      address: USDC_PAYMASTER_ADDRESS,\n      abi: USDCPaymasterABI,\n      functionName: 'withdraw',\n      args: [amountBigInt],\n      chainId: baseSepolia.id,\n    });\n  };\n\n  return {\n    withdraw,\n    isPending,\n    isConfirming,\n    isSuccess,\n    error,\n    hash,\n  };\n}\n\n/**\n * Hook to check and approve USDC for paymaster\n */\nexport function useApproveUSDCForPaymaster() {\n  const { address } = useEmbeddedWallet();\n  const { wallets } = useWallets();\n  const [hash, setHash] = useState<`0x${string}` | undefined>();\n  const [isPending, setIsPending] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const { isLoading: isConfirming, isSuccess } = useWaitForTransactionReceipt({\n    hash,\n  });\n\n  // Check current allowance\n  const { data: allowance, refetch: refetchAllowance } = useReadContract({\n    address: USDC_ADDRESS,\n    abi: MockUSDCABI,\n    functionName: 'allowance',\n    args: address ? [address, USDC_PAYMASTER_ADDRESS] : undefined,\n    query: {\n      enabled: !!address,\n    },\n  });\n\n  const approve = async (amount: string) => {\n    try {\n      setIsPending(true);\n      setError(null);\n\n      // Find embedded wallet\n      const embeddedWallet = wallets.find(\n        (w) => w.walletClientType === 'privy' && w.address === address,\n      );\n\n      if (!embeddedWallet) {\n        throw new Error('Embedded wallet not found');\n      }\n\n      const amountBigInt = parseUnits(amount, USDC_DECIMALS);\n\n      // Switch to correct chain first\n      await embeddedWallet.switchChain(baseSepolia.id);\n\n      // Get wallet client\n      const walletClient = await embeddedWallet.getEthereumProvider();\n\n      if (!walletClient) {\n        throw new Error('Could not get wallet client');\n      }\n\n      // Encode approve function call\n      const data = encodeFunctionData({\n        abi: MockUSDCABI,\n        functionName: 'approve',\n        args: [USDC_PAYMASTER_ADDRESS, amountBigInt],\n      });\n\n      // Send transaction using provider\n      const txHash = await walletClient.request({\n        method: 'eth_sendTransaction',\n        params: [\n          {\n            from: address,\n            to: USDC_ADDRESS,\n            data,\n          },\n        ],\n      });\n\n      setHash(txHash as `0x${string}`);\n    } catch (err) {\n      console.error('❌ Approve error:', err);\n      setError(err as Error);\n    } finally {\n      setIsPending(false);\n    }\n  };\n\n  const hasAllowance = (requiredAmount: string): boolean => {\n    if (!allowance) return false;\n    const required = parseUnits(requiredAmount, USDC_DECIMALS);\n    return (allowance as bigint) >= required;\n  };\n\n  return {\n    approve,\n    isPending,\n    isConfirming,\n    isSuccess,\n    error,\n    hash,\n    allowance: allowance as bigint | undefined,\n    hasAllowance,\n    refetchAllowance,\n  };\n}\n\n/**\n * Hook to get paymaster exchange rate info\n */\nexport function usePaymasterRateInfo() {\n  const { data, isLoading, refetch } = useReadContract({\n    address: USDC_PAYMASTER_ADDRESS,\n    abi: USDCPaymasterABI,\n    functionName: 'getRateInfo',\n  });\n\n  const rateData = data as [bigint, bigint] | undefined;\n\n  return {\n    usdcPerEth: rateData?.[0],\n    premiumBps: rateData?.[1],\n    isLoading,\n    refetch,\n  };\n}\n\n/**\n * Hook to calculate USDC cost for gas\n */\nexport function useCalculateGasCost(gasAmount: bigint | undefined) {\n  const { data: cost, isLoading } = useReadContract({\n    address: USDC_PAYMASTER_ADDRESS,\n    abi: USDCPaymasterABI,\n    functionName: 'calculateUsdcCost',\n    args: gasAmount ? [gasAmount] : undefined,\n    query: {\n      enabled: !!gasAmount && gasAmount > 0n,\n    },\n  });\n\n  return {\n    cost: cost as bigint | undefined,\n    costFormatted: cost ? formatUnits(cost as bigint, USDC_DECIMALS) : '0',\n    isLoading,\n  };\n}\n\n/**\n * Combined hook for paymaster flow management\n */\nexport function usePaymasterFlow() {\n  const [isApproving, setIsApproving] = useState(false);\n  const [isDepositing, setIsDepositing] = useState(false);\n\n  const { balance, balanceRaw, refetch: refetchBalance } = usePaymasterBalance();\n  const {\n    approve,\n    isSuccess: isApproveSuccess,\n    hasAllowance,\n    refetchAllowance,\n  } = useApproveUSDCForPaymaster();\n  const { deposit, isSuccess: isDepositSuccess } = useDepositToPaymaster();\n\n  // Refetch balance when deposit is successful\n  useEffect(() => {\n    if (isDepositSuccess) {\n      refetchBalance();\n      setIsDepositing(false);\n    }\n  }, [isDepositSuccess, refetchBalance]);\n\n  // Refetch allowance when approve is successful\n  useEffect(() => {\n    if (isApproveSuccess) {\n      refetchAllowance();\n      setIsApproving(false);\n    }\n  }, [isApproveSuccess, refetchAllowance]);\n\n  /**\n   * Ensure paymaster has sufficient balance\n   * Will approve and deposit if needed\n   */\n  const ensurePaymasterBalance = async (requiredAmount: string): Promise<boolean> => {\n    try {\n      // Check if balance is sufficient\n      const balanceNum = parseFloat(balance);\n      const requiredNum = parseFloat(requiredAmount);\n\n      if (balanceNum >= requiredNum) {\n        return true; // Already have enough balance\n      }\n\n      const depositAmount = (requiredNum - balanceNum + 10).toFixed(6); // Add 10 USDC buffer\n\n      // Check allowance\n      if (!hasAllowance(depositAmount)) {\n        setIsApproving(true);\n        await approve(depositAmount);\n        // Wait for approval to complete\n        return false; // Need to retry after approval\n      }\n\n      // Deposit\n      setIsDepositing(true);\n      await deposit(depositAmount);\n      return false; // Need to wait for deposit to complete\n    } catch (error) {\n      console.error('Error ensuring paymaster balance:', error);\n      setIsApproving(false);\n      setIsDepositing(false);\n      return false;\n    }\n  };\n\n  return {\n    balance,\n    balanceRaw,\n    isApproving,\n    isDepositing,\n    ensurePaymasterBalance,\n    refetchBalance,\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4824, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/hooks/useTPSL.ts"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { BACKEND_API_URL } from '@/config/contracts';\nimport { toast } from 'sonner';\n\nexport interface TPSLConfig {\n  positionId: number;\n  trader: string;\n  symbol: string;\n  isLong: boolean;\n  entryPrice: string;\n  takeProfit?: string;\n  stopLoss?: string;\n  createdAt: number;\n  updatedAt: number;\n}\n\nexport interface TPSLSetRequest {\n  positionId: number;\n  trader: string;\n  takeProfit?: string;\n  stopLoss?: string;\n}\n\n/**\n * Hook for managing TP/SL (Take Profit / Stop Loss)\n */\nexport function useTPSL() {\n  const [isPending, setIsPending] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  /**\n   * Set or update TP/SL for a position\n   */\n  const setTPSL = async (request: TPSLSetRequest): Promise<boolean> => {\n    setIsPending(true);\n    setError(null);\n\n    try {\n      const response = await fetch(`${BACKEND_API_URL}/api/tpsl/set`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(request),\n      });\n\n      const data = await response.json();\n\n      if (!response.ok || !data.success) {\n        throw new Error(data.error || 'Failed to set TP/SL');\n      }\n\n      toast.success('✅ TP/SL saved successfully!');\n      return true;\n    } catch (err: any) {\n      const errorMsg = err.message || 'Failed to set TP/SL';\n      setError(errorMsg);\n      toast.error(errorMsg);\n      return false;\n    } finally {\n      setIsPending(false);\n    }\n  };\n\n  /**\n   * Get TP/SL config for a position\n   */\n  const getTPSL = async (positionId: number): Promise<TPSLConfig | null> => {\n    try {\n      const response = await fetch(`${BACKEND_API_URL}/api/tpsl/${positionId}`);\n      const data = await response.json();\n\n      if (!response.ok || !data.success) {\n        return null;\n      }\n\n      return data.data as TPSLConfig;\n    } catch (err) {\n      console.error('Error fetching TP/SL:', err);\n      return null;\n    }\n  };\n\n  /**\n   * Delete TP/SL config for a position\n   */\n  const deleteTPSL = async (positionId: number, trader: string): Promise<boolean> => {\n    setIsPending(true);\n    setError(null);\n\n    try {\n      const response = await fetch(`${BACKEND_API_URL}/api/tpsl/${positionId}`, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ trader }),\n      });\n\n      const data = await response.json();\n\n      if (!response.ok || !data.success) {\n        throw new Error(data.error || 'Failed to delete TP/SL');\n      }\n\n      toast.success('TP/SL removed');\n      return true;\n    } catch (err: any) {\n      const errorMsg = err.message || 'Failed to delete TP/SL';\n      setError(errorMsg);\n      toast.error(errorMsg);\n      return false;\n    } finally {\n      setIsPending(false);\n    }\n  };\n\n  return {\n    setTPSL,\n    getTPSL,\n    deleteTPSL,\n    isPending,\n    error,\n  };\n}\n\n/**\n * Hook for fetching ALL TP/SL configs (batch)\n * Uses global context to avoid duplicate requests\n * @deprecated Import useTPSLContext from TPSLContext instead\n */\nexport function useAllTPSL() {\n  // This is now just a wrapper for backward compatibility\n  // Real implementation is in TPSLContext\n  console.warn('useAllTPSL is deprecated. Use useTPSLContext from TPSLContext instead.');\n\n  const [configs, setConfigs] = useState<Record<number, TPSLConfig>>({});\n  const [isLoading, setIsLoading] = useState(false);\n\n  return { configs, isLoading, refresh: async () => {} };\n}\n\n/**\n * Hook for fetching TP/SL config for a specific position\n * Uses global context to avoid duplicate requests\n */\nexport function useTPSLConfig(positionId: number | null) {\n  // Simple non-context version for components that don't have context yet\n  // Returns empty config - components should migrate to use TPSLContext\n  return {\n    config: null as TPSLConfig | null,\n    isLoading: false,\n    refresh: () => {},\n  };\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;;;;AAwBO,SAAS;IACd,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAgB;IAElD;;GAEC,GACD,MAAM,UAAU,OAAO;QACrB,aAAa;QACb,SAAS;QAET,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,GAAG,6IAAe,CAAC,aAAa,CAAC,EAAE;gBAC9D,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,MAAM,KAAK,SAAS,CAAC;YACvB;YAEA,MAAM,OAAO,MAAM,SAAS,IAAI;YAEhC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,KAAK,OAAO,EAAE;gBACjC,MAAM,IAAI,MAAM,KAAK,KAAK,IAAI;YAChC;YAEA,iJAAK,CAAC,OAAO,CAAC;YACd,OAAO;QACT,EAAE,OAAO,KAAU;YACjB,MAAM,WAAW,IAAI,OAAO,IAAI;YAChC,SAAS;YACT,iJAAK,CAAC,KAAK,CAAC;YACZ,OAAO;QACT,SAAU;YACR,aAAa;QACf;IACF;IAEA;;GAEC,GACD,MAAM,UAAU,OAAO;QACrB,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,GAAG,6IAAe,CAAC,UAAU,EAAE,YAAY;YACxE,MAAM,OAAO,MAAM,SAAS,IAAI;YAEhC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,KAAK,OAAO,EAAE;gBACjC,OAAO;YACT;YAEA,OAAO,KAAK,IAAI;QAClB,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,yBAAyB;YACvC,OAAO;QACT;IACF;IAEA;;GAEC,GACD,MAAM,aAAa,OAAO,YAAoB;QAC5C,aAAa;QACb,SAAS;QAET,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,GAAG,6IAAe,CAAC,UAAU,EAAE,YAAY,EAAE;gBACxE,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,MAAM,KAAK,SAAS,CAAC;oBAAE;gBAAO;YAChC;YAEA,MAAM,OAAO,MAAM,SAAS,IAAI;YAEhC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,KAAK,OAAO,EAAE;gBACjC,MAAM,IAAI,MAAM,KAAK,KAAK,IAAI;YAChC;YAEA,iJAAK,CAAC,OAAO,CAAC;YACd,OAAO;QACT,EAAE,OAAO,KAAU;YACjB,MAAM,WAAW,IAAI,OAAO,IAAI;YAChC,SAAS;YACT,iJAAK,CAAC,KAAK,CAAC;YACZ,OAAO;QACT,SAAU;YACR,aAAa;QACf;IACF;IAEA,OAAO;QACL;QACA;QACA;QACA;QACA;IACF;AACF;AAOO,SAAS;IACd,wDAAwD;IACxD,wCAAwC;IACxC,QAAQ,IAAI,CAAC;IAEb,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAA6B,CAAC;IACpE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAE3C,OAAO;QAAE;QAAS;QAAW,SAAS,WAAa;IAAE;AACvD;AAMO,SAAS,cAAc,UAAyB;IACrD,wEAAwE;IACxE,sEAAsE;IACtE,OAAO;QACL,QAAQ;QACR,WAAW;QACX,SAAS,KAAO;IAClB;AACF"}},
    {"offset": {"line": 4947, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/utils/formatUtils.ts"],"sourcesContent":["/**\n * Format utilities for order panel components\n */\n\nexport const formatPrice = (price: number): string => {\n  if (isNaN(price) || price === 0) return '$0.00';\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2,\n  }).format(price);\n};\n\nexport const formatTokenAmount = (amount: number): string => {\n  if (isNaN(amount) || amount === 0) return '0.0';\n  return amount.toFixed(6);\n};\n\nexport const formatLeverage = (lev: number): string => {\n  return lev.toFixed(1);\n};\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;;;AAEM,MAAM,cAAc,CAAC;IAC1B,IAAI,MAAM,UAAU,UAAU,GAAG,OAAO;IACxC,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;QACpC,OAAO;QACP,UAAU;QACV,uBAAuB;QACvB,uBAAuB;IACzB,GAAG,MAAM,CAAC;AACZ;AAEO,MAAM,oBAAoB,CAAC;IAChC,IAAI,MAAM,WAAW,WAAW,GAAG,OAAO;IAC1C,OAAO,OAAO,OAAO,CAAC;AACxB;AAEO,MAAM,iBAAiB,CAAC;IAC7B,OAAO,IAAI,OAAO,CAAC;AACrB"}},
    {"offset": {"line": 4977, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/components/CollateralInput.tsx"],"sourcesContent":["import React from 'react';\nimport { Button } from '@/components/ui/button';\nimport { formatPrice } from '../utils/formatUtils';\nimport Image from 'next/image';\n\ninterface CollateralInputProps {\n  value: string;\n  onChange: (e: React.ChangeEvent<HTMLInputElement>) => void;\n  balance: string | number;\n  isLoadingBalance?: boolean;\n  onMaxClick: () => void;\n  label?: string;\n  disabled?: boolean;\n  tokenSymbol?: string;\n  tokenIcon?: string;\n}\n\nexport const CollateralInput: React.FC<CollateralInputProps> = ({\n  value,\n  onChange,\n  balance,\n  isLoadingBalance = false,\n  onMaxClick,\n  label = 'Collateral',\n  disabled = false,\n  tokenSymbol = 'USDC',\n  tokenIcon = '/icons/usdc.png',\n}) => {\n  const usdValue = value ? parseFloat(value) : 0;\n\n  return (\n    <div\n      className={`bg-trading-surface border border-border-default rounded-lg p-3 grid ${\n        disabled ? 'opacity-50 pointer-events-none' : ''\n      }`}\n    >\n      {label && <label className=\"text-xs text-text-secondary mb-2 block\">{label}</label>}\n\n      <div className=\"flex justify-between items-center mb-2\">\n        <input\n          type=\"text\"\n          placeholder=\"0.0\"\n          value={value}\n          onChange={onChange}\n          disabled={disabled}\n          className=\"bg-transparent text-2xl text-text-primary outline-none disabled:cursor-not-allowed placeholder-text-muted flex-1 w-full min-w-0\"\n        />\n        <div className=\"flex items-center gap-2 shrink-0 ml-2\">\n          <Image\n            src={tokenIcon}\n            alt={tokenSymbol}\n            width={28}\n            height={28}\n            className=\"rounded-full\"\n            onError={(e) => {\n              const target = e.currentTarget;\n              target.style.display = 'none';\n            }}\n          />\n          <span className=\"font-medium text-text-primary\">{tokenSymbol}</span>\n        </div>\n      </div>\n\n      <div className=\"flex justify-between items-center text-xs\">\n        <span className=\"text-text-muted\">{formatPrice(usdValue)}</span>\n        <div className=\"flex items-center gap-2 max-w-[60%] justify-end\">\n          <span className=\"text-text-muted truncate\">\n            {isLoadingBalance ? 'Loading...' : `${balance} ${tokenSymbol}`}\n          </span>\n          <Button\n            onClick={onMaxClick}\n            disabled={disabled}\n            size=\"sm\"\n            className=\"h-6 px-2 text-xs text-white\"\n          >\n            Max\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n};\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;;;;;AAcO,MAAM,kBAAkD,CAAC,EAC9D,KAAK,EACL,QAAQ,EACR,OAAO,EACP,mBAAmB,KAAK,EACxB,UAAU,EACV,QAAQ,YAAY,EACpB,WAAW,KAAK,EAChB,cAAc,MAAM,EACpB,YAAY,iBAAiB,EAC9B;IACC,MAAM,WAAW,QAAQ,WAAW,SAAS;IAE7C,qBACE,8OAAC;QACC,WAAW,CAAC,oEAAoE,EAC9E,WAAW,mCAAmC,IAC9C;;YAED,uBAAS,8OAAC;gBAAM,WAAU;0BAA0C;;;;;;0BAErE,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,MAAK;wBACL,aAAY;wBACZ,OAAO;wBACP,UAAU;wBACV,UAAU;wBACV,WAAU;;;;;;kCAEZ,8OAAC;wBAAI,WAAU;;0CACb,8OAAC,wIAAK;gCACJ,KAAK;gCACL,KAAK;gCACL,OAAO;gCACP,QAAQ;gCACR,WAAU;gCACV,SAAS,CAAC;oCACR,MAAM,SAAS,EAAE,aAAa;oCAC9B,OAAO,KAAK,CAAC,OAAO,GAAG;gCACzB;;;;;;0CAEF,8OAAC;gCAAK,WAAU;0CAAiC;;;;;;;;;;;;;;;;;;0BAIrD,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAK,WAAU;kCAAmB,IAAA,2MAAW,EAAC;;;;;;kCAC/C,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAK,WAAU;0CACb,mBAAmB,eAAe,GAAG,QAAQ,CAAC,EAAE,aAAa;;;;;;0CAEhE,8OAAC,4IAAM;gCACL,SAAS;gCACT,UAAU;gCACV,MAAK;gCACL,WAAU;0CACX;;;;;;;;;;;;;;;;;;;;;;;;AAOX"}},
    {"offset": {"line": 5111, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/utils/leverageUtils.ts"],"sourcesContent":["/**\n * Leverage calculation utilities for order panel components\n */\n\nexport const LEVERAGE_MARKERS = [1, 2, 5, 10, 25, 50, 100];\n\nexport const generateLeverageValues = (): number[] => {\n  const values: number[] = [];\n  for (let i = 0; i < LEVERAGE_MARKERS.length - 1; i++) {\n    const start = LEVERAGE_MARKERS[i];\n    const end = LEVERAGE_MARKERS[i + 1];\n    const step = (end - start) / 10;\n\n    for (let j = 0; j < 10; j++) {\n      const value = start + step * j;\n      values.push(Number(value.toFixed(2)));\n    }\n  }\n  values.push(LEVERAGE_MARKERS[LEVERAGE_MARKERS.length - 1]);\n  return values;\n};\n\nexport const getCurrentSliderIndex = (leverage: number, leverageValues: number[]): number => {\n  let closestIndex = 0;\n  let minDiff = Math.abs(leverageValues[0] - leverage);\n\n  for (let i = 1; i < leverageValues.length; i++) {\n    const diff = Math.abs(leverageValues[i] - leverage);\n    if (diff < minDiff) {\n      minDiff = diff;\n      closestIndex = i;\n    }\n  }\n\n  return closestIndex;\n};\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;;;AAEM,MAAM,mBAAmB;IAAC;IAAG;IAAG;IAAG;IAAI;IAAI;IAAI;CAAI;AAEnD,MAAM,yBAAyB;IACpC,MAAM,SAAmB,EAAE;IAC3B,IAAK,IAAI,IAAI,GAAG,IAAI,iBAAiB,MAAM,GAAG,GAAG,IAAK;QACpD,MAAM,QAAQ,gBAAgB,CAAC,EAAE;QACjC,MAAM,MAAM,gBAAgB,CAAC,IAAI,EAAE;QACnC,MAAM,OAAO,CAAC,MAAM,KAAK,IAAI;QAE7B,IAAK,IAAI,IAAI,GAAG,IAAI,IAAI,IAAK;YAC3B,MAAM,QAAQ,QAAQ,OAAO;YAC7B,OAAO,IAAI,CAAC,OAAO,MAAM,OAAO,CAAC;QACnC;IACF;IACA,OAAO,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,MAAM,GAAG,EAAE;IACzD,OAAO;AACT;AAEO,MAAM,wBAAwB,CAAC,UAAkB;IACtD,IAAI,eAAe;IACnB,IAAI,UAAU,KAAK,GAAG,CAAC,cAAc,CAAC,EAAE,GAAG;IAE3C,IAAK,IAAI,IAAI,GAAG,IAAI,eAAe,MAAM,EAAE,IAAK;QAC9C,MAAM,OAAO,KAAK,GAAG,CAAC,cAAc,CAAC,EAAE,GAAG;QAC1C,IAAI,OAAO,SAAS;YAClB,UAAU;YACV,eAAe;QACjB;IACF;IAEA,OAAO;AACT"}},
    {"offset": {"line": 5160, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/components/LeverageSelector.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Slider } from '@/components/ui/slider';\nimport { Input } from '@/components/ui/input';\nimport { generateLeverageValues, getCurrentSliderIndex } from '../utils/leverageUtils';\n\ninterface LeverageSelectorProps {\n  leverage: number;\n  onLeverageChange: (value: number) => void;\n  disabled?: boolean;\n  min?: number;\n  max?: number;\n  markers?: number[];\n}\n\nexport const LeverageSelector: React.FC<LeverageSelectorProps> = ({\n  leverage,\n  onLeverageChange,\n  disabled = false,\n  markers = [1, 2, 5, 10, 25, 50, 100],\n}) => {\n  const [leverageInput, setLeverageInput] = useState<string>(leverage.toFixed(1));\n\n  // Memoize leverage values to avoid recalculation\n  const leverageValues = React.useMemo(() => generateLeverageValues(), []);\n  const maxSliderValue = leverageValues.length - 1;\n  const currentIndex = getCurrentSliderIndex(leverage, leverageValues);\n\n  useEffect(() => {\n    if (!document.activeElement?.classList.contains('leverage-input')) {\n      setLeverageInput(leverage.toFixed(1));\n    }\n  }, [leverage]);\n\n  const handleSliderChange = (value: number[]) => {\n    const index = value[0];\n    const newValue = leverageValues[index];\n    onLeverageChange(newValue);\n    setLeverageInput(newValue.toFixed(1));\n  };\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    if (value === '' || /^\\d*\\.?\\d{0,1}$/.test(value)) {\n      setLeverageInput(value);\n      if (value !== '' && value !== '.') {\n        const numValue = parseFloat(value);\n        if (!isNaN(numValue) && numValue >= 0.1 && numValue <= 100) {\n          onLeverageChange(numValue);\n        }\n      }\n    }\n  };\n\n  const handleInputBlur = () => {\n    if (leverageInput === '' || leverageInput === '.') {\n      setLeverageInput('1.0');\n      onLeverageChange(1);\n    } else {\n      setLeverageInput(leverage.toFixed(1));\n    }\n  };\n\n  return (\n    <div className={disabled ? 'opacity-50 pointer-events-none' : ''}>\n      <label className=\"text-xs text-text-secondary mb-2 block\">Leverage</label>\n      <div className=\"flex items-center gap-6\">\n        <div className=\"flex-1 relative pt-2 pb-6\">\n          <Slider\n            defaultValue={[currentIndex]}\n            value={[currentIndex]}\n            max={maxSliderValue}\n            step={1}\n            onValueChange={handleSliderChange}\n            disabled={disabled}\n            className=\"z-10 relative\"\n          />\n          {/* Markers - Custom styling needed to match absolute position logic */}\n          <div className=\"absolute top-full -mt-4 left-0 right-0 h-4\">\n            {markers.map((marker, index) => {\n              const markerIndex = leverageValues.findIndex((v) => Math.abs(v - marker) < 0.01);\n              const position = (markerIndex / maxSliderValue) * 100;\n              return (\n                <span\n                  key={index}\n                  className=\"absolute text-[10px] text-text-muted font-medium transform -translate-x-1/2\"\n                  style={{\n                    left: `${position}%`,\n                  }}\n                >\n                  {marker < 1 ? marker.toFixed(1) : marker}x\n                </span>\n              );\n            })}\n          </div>\n        </div>\n\n        {/* Input Box */}\n        <div className=\"bg-trading-elevated rounded-lg py-1 min-w-[65px] flex items-center justify-center gap-1 border border-border-default\">\n          <Input\n            type=\"text\"\n            value={leverageInput}\n            onChange={handleInputChange}\n            onBlur={handleInputBlur}\n            disabled={disabled}\n            className=\"leverage-input h-7 bg-transparent text-sm font-semibold text-text-primary border-none p-0 w-10 text-right focus-visible:ring-0\"\n          />\n          <span className=\"text-sm font-semibold text-text-primary\">x</span>\n        </div>\n      </div>\n    </div>\n  );\n};\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;;AAWO,MAAM,mBAAoD,CAAC,EAChE,QAAQ,EACR,gBAAgB,EAChB,WAAW,KAAK,EAChB,UAAU;IAAC;IAAG;IAAG;IAAG;IAAI;IAAI;IAAI;CAAI,EACrC;IACC,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAS,SAAS,OAAO,CAAC;IAE5E,iDAAiD;IACjD,MAAM,iBAAiB,gNAAK,CAAC,OAAO,CAAC,IAAM,IAAA,wNAAsB,KAAI,EAAE;IACvE,MAAM,iBAAiB,eAAe,MAAM,GAAG;IAC/C,MAAM,eAAe,IAAA,uNAAqB,EAAC,UAAU;IAErD,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,SAAS,aAAa,EAAE,UAAU,SAAS,mBAAmB;YACjE,iBAAiB,SAAS,OAAO,CAAC;QACpC;IACF,GAAG;QAAC;KAAS;IAEb,MAAM,qBAAqB,CAAC;QAC1B,MAAM,QAAQ,KAAK,CAAC,EAAE;QACtB,MAAM,WAAW,cAAc,CAAC,MAAM;QACtC,iBAAiB;QACjB,iBAAiB,SAAS,OAAO,CAAC;IACpC;IAEA,MAAM,oBAAoB,CAAC;QACzB,MAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;QAC5B,IAAI,UAAU,MAAM,kBAAkB,IAAI,CAAC,QAAQ;YACjD,iBAAiB;YACjB,IAAI,UAAU,MAAM,UAAU,KAAK;gBACjC,MAAM,WAAW,WAAW;gBAC5B,IAAI,CAAC,MAAM,aAAa,YAAY,OAAO,YAAY,KAAK;oBAC1D,iBAAiB;gBACnB;YACF;QACF;IACF;IAEA,MAAM,kBAAkB;QACtB,IAAI,kBAAkB,MAAM,kBAAkB,KAAK;YACjD,iBAAiB;YACjB,iBAAiB;QACnB,OAAO;YACL,iBAAiB,SAAS,OAAO,CAAC;QACpC;IACF;IAEA,qBACE,8OAAC;QAAI,WAAW,WAAW,mCAAmC;;0BAC5D,8OAAC;gBAAM,WAAU;0BAAyC;;;;;;0BAC1D,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC,4IAAM;gCACL,cAAc;oCAAC;iCAAa;gCAC5B,OAAO;oCAAC;iCAAa;gCACrB,KAAK;gCACL,MAAM;gCACN,eAAe;gCACf,UAAU;gCACV,WAAU;;;;;;0CAGZ,8OAAC;gCAAI,WAAU;0CACZ,QAAQ,GAAG,CAAC,CAAC,QAAQ;oCACpB,MAAM,cAAc,eAAe,SAAS,CAAC,CAAC,IAAM,KAAK,GAAG,CAAC,IAAI,UAAU;oCAC3E,MAAM,WAAW,AAAC,cAAc,iBAAkB;oCAClD,qBACE,8OAAC;wCAEC,WAAU;wCACV,OAAO;4CACL,MAAM,GAAG,SAAS,CAAC,CAAC;wCACtB;;4CAEC,SAAS,IAAI,OAAO,OAAO,CAAC,KAAK;4CAAO;;uCANpC;;;;;gCASX;;;;;;;;;;;;kCAKJ,8OAAC;wBAAI,WAAU;;0CACb,8OAAC,0IAAK;gCACJ,MAAK;gCACL,OAAO;gCACP,UAAU;gCACV,QAAQ;gCACR,UAAU;gCACV,WAAU;;;;;;0CAEZ,8OAAC;gCAAK,WAAU;0CAA0C;;;;;;;;;;;;;;;;;;;;;;;;AAKpE"}},
    {"offset": {"line": 5332, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/components/MarketSelector.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState } from 'react';\nimport { Star } from 'lucide-react';\nimport { ALL_MARKETS } from '@/features/trading/constants/markets';\nimport { formatMarketPair } from '@/features/trading/lib/marketUtils';\nimport Image from 'next/image';\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n} from '@/components/ui/command';\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\nimport { Button } from '@/components/ui/button';\nimport { cn } from '@/lib/utils';\n\ninterface Market {\n  symbol: string;\n  tradingViewSymbol: string;\n  logoUrl?: string;\n  disabled?: boolean;\n  binanceSymbol?: string;\n  category?: 'crypto' | 'forex' | 'indices' | 'commodities' | 'stocks';\n}\n\ninterface MarketSelectorProps {\n  value?: Market;\n  onSelect: (market: Market) => void;\n  disabled?: boolean;\n}\n\nexport const MarketSelector: React.FC<MarketSelectorProps> = ({ value, onSelect, disabled }) => {\n  const [open, setOpen] = useState(false);\n  const [favorites, setFavorites] = useState<Set<string>>(new Set());\n\n  const toggleFavorite = (symbol: string, e: React.MouseEvent) => {\n    e.stopPropagation();\n    e.preventDefault();\n    setFavorites((prev) => {\n      const newFavorites = new Set(prev);\n      if (newFavorites.has(symbol)) {\n        newFavorites.delete(symbol);\n      } else {\n        newFavorites.add(symbol);\n      }\n      return newFavorites;\n    });\n  };\n\n  // Sort markets: favorites first, then alphabetically\n  const sortedMarkets = [...ALL_MARKETS].sort((a, b) => {\n    const aIsFav = favorites.has(a.symbol);\n    const bIsFav = favorites.has(b.symbol);\n    if (aIsFav && !bIsFav) return -1;\n    if (!aIsFav && bIsFav) return 1;\n    return a.symbol.localeCompare(b.symbol);\n  });\n\n  return (\n    <Popover open={open} onOpenChange={setOpen}>\n      <PopoverTrigger asChild>\n        <Button\n          role=\"combobox\"\n          disabled={disabled}\n          aria-expanded={open}\n          className={`w-full justify-between bg-trading-surface text-text-primary px-3 py-3 hover:bg-trading-surface hover:text-text-primary border border-border-default rounded-lg shadow-none h-auto ${\n            disabled ? 'opacity-50 pointer-events-none' : ''\n          }`}\n        >\n          <div className=\"flex gap-3\">\n            <label className=\"text-xs text-text-secondary sblock\">Market</label>\n            <svg\n              width=\"15\"\n              height=\"15\"\n              viewBox=\"0 0 15 15\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n              className=\"h-4 w-4 shrink-0 opacity-50\"\n            >\n              <path\n                d=\"M4.93179 5.43179C4.75605 5.60753 4.75605 5.89245 4.93179 6.06819C5.10753 6.24392 5.39245 6.24392 5.56819 6.06819L7.49999 4.13638L9.43179 6.06819C9.60753 6.24392 9.89245 6.24392 10.0682 6.06819C10.2439 5.89245 10.2439 5.60753 10.0682 5.43179L7.81819 3.18179C7.73379 3.0974 7.61933 3.04999 7.49999 3.04999C7.38064 3.04999 7.26618 3.0974 7.18179 3.18179L4.93179 5.43179ZM10.0682 9.56819C10.2439 9.39245 10.2439 9.10753 10.0682 8.93179C9.89245 8.75606 9.60753 8.75606 9.43179 8.93179L7.49999 10.8636L5.56819 8.93179C5.39245 8.75606 5.10753 8.75606 4.93179 8.93179C4.75605 9.10753 4.75605 9.39245 4.93179 9.56819L7.18179 11.8182C7.26618 11.9026 7.38064 11.95 7.49999 11.95C7.61933 11.95 7.73379 11.9026 7.81819 11.8182L10.0682 9.56819Z\"\n                fill=\"currentColor\"\n                fillRule=\"evenodd\"\n                clipRule=\"evenodd\"\n              />\n            </svg>\n          </div>\n\n          {value ? (\n            <div className=\"flex items-center gap-3\">\n              <Image\n                src={value.logoUrl || '/icons/usdc.png'}\n                alt={value.symbol}\n                width={24}\n                height={24}\n                className=\"rounded-full\"\n              />\n              <span className=\"text-lg text-text-primary\">{formatMarketPair(value.symbol)}</span>\n            </div>\n          ) : (\n            'Select market...'\n          )}\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent\n        className=\"w-[300px] p-0 bg-trading-surface border-border-default\"\n        align=\"start\"\n      >\n        <Command className=\"bg-trading-surface p-0\">\n          <CommandInput placeholder=\"Search market...\" className=\"text-text-primary\" />\n          <CommandList>\n            <CommandEmpty>No market found.</CommandEmpty>\n            <CommandGroup>\n              {sortedMarkets.map((market) => {\n                const isFavorite = favorites.has(market.symbol);\n\n                return (\n                  <CommandItem\n                    key={market.symbol}\n                    value={market.symbol}\n                    onSelect={() => {\n                      onSelect(market);\n                      setOpen(false);\n                    }}\n                    className=\"flex items-center justify-between text-text-primary hover:bg-trading-elevated\"\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <Image\n                        src={market.logoUrl || '/icons/usdc.png'}\n                        alt={market.symbol}\n                        width={24}\n                        height={24}\n                        className=\"rounded-full\"\n                      />\n                      <span className=\"text-lg\">{formatMarketPair(market.symbol)}</span>\n                    </div>\n                    <button\n                      onClick={(e) => toggleFavorite(market.symbol, e)}\n                      className=\"p-1 hover:bg-trading-bg rounded transition-colors\"\n                    >\n                      <Star\n                        size={14}\n                        className={cn(\n                          'transition-colors',\n                          isFavorite ? 'fill-yellow-400 text-yellow-400' : 'text-text-muted',\n                        )}\n                      />\n                    </button>\n                  </CommandItem>\n                );\n              })}\n            </CommandGroup>\n          </CommandList>\n        </Command>\n      </PopoverContent>\n    </Popover>\n  );\n};\n\nexport type { Market };\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5591, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/components/PositionInfo.tsx"],"sourcesContent":["import React from 'react';\nimport { MarketSelector, Market } from '../components/MarketSelector';\nimport { formatTokenAmount, formatPrice, formatLeverage } from '../utils/formatUtils';\n\ninterface PositionInfoProps {\n  activeTab: 'long' | 'short' | 'swap';\n  payUsdValue: number;\n  oraclePrice: number;\n  longShortUsdValue: number;\n  tokenAmount: number;\n  leverage: number;\n  activeMarket: Market | null;\n  onMarketSelect: (market: Market) => void;\n}\n\nexport const PositionInfo: React.FC<PositionInfoProps> = ({\n  activeTab,\n  payUsdValue,\n  oraclePrice,\n  longShortUsdValue,\n  tokenAmount,\n  leverage,\n  activeMarket,\n  onMarketSelect,\n}) => {\n  return (\n    <div className=\"bg-trading-surface border border-border-default rounded-lg p-3\">\n      <div className=\"space-y-2\">\n        <div className=\"flex items-center justify-between\">\n          <span className=\"text-xs text-text-secondary\">\n            {activeTab === 'long'\n              ? 'Long Position Size'\n              : activeTab === 'short'\n              ? 'Short Position Size'\n              : 'Swap Receive'}\n          </span>\n        </div>\n        <div className=\"flex items-center justify-between gap-3\">\n          {/* Price Input - Left Side */}\n          <input\n            type=\"text\"\n            placeholder=\"0.0\"\n            value={\n              activeTab === 'swap'\n                ? tokenAmount > 0\n                  ? formatTokenAmount(payUsdValue / oraclePrice)\n                  : ''\n                : tokenAmount > 0\n                ? formatTokenAmount(tokenAmount)\n                : ''\n            }\n            readOnly\n            className=\"bg-transparent text-xl font-medium text-text-primary outline-none cursor-not-allowed flex-1 min-w-0\"\n          />\n          {/* Market Selector - Right Side */}\n          <div className=\"flex-shrink-0\">\n            <MarketSelector value={activeMarket ?? undefined} onSelect={onMarketSelect} />\n          </div>\n        </div>\n        <div className=\"flex justify-between items-center text-xs pt-1\">\n          <span className=\"text-text-secondary font-medium\">\n            ≈ {activeTab === 'swap' ? formatPrice(payUsdValue) : formatPrice(longShortUsdValue)}\n          </span>\n          {activeTab !== 'swap' && (\n            <span className={`font-medium ${leverage >= 50 ? 'text-warning' : 'text-info'}`}>\n              {formatLeverage(leverage)}x Leverage\n            </span>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n"],"names":[],"mappings":";;;;;AACA;AACA;;;;AAaO,MAAM,eAA4C,CAAC,EACxD,SAAS,EACT,WAAW,EACX,WAAW,EACX,iBAAiB,EACjB,WAAW,EACX,QAAQ,EACR,YAAY,EACZ,cAAc,EACf;IACC,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC;wBAAK,WAAU;kCACb,cAAc,SACX,uBACA,cAAc,UACd,wBACA;;;;;;;;;;;8BAGR,8OAAC;oBAAI,WAAU;;sCAEb,8OAAC;4BACC,MAAK;4BACL,aAAY;4BACZ,OACE,cAAc,SACV,cAAc,IACZ,IAAA,iNAAiB,EAAC,cAAc,eAChC,KACF,cAAc,IACd,IAAA,iNAAiB,EAAC,eAClB;4BAEN,QAAQ;4BACR,WAAU;;;;;;sCAGZ,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC,uNAAc;gCAAC,OAAO,gBAAgB;gCAAW,UAAU;;;;;;;;;;;;;;;;;8BAGhE,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAK,WAAU;;gCAAkC;gCAC7C,cAAc,SAAS,IAAA,2MAAW,EAAC,eAAe,IAAA,2MAAW,EAAC;;;;;;;wBAElE,cAAc,wBACb,8OAAC;4BAAK,WAAW,CAAC,YAAY,EAAE,YAAY,KAAK,iBAAiB,aAAa;;gCAC5E,IAAA,8MAAc,EAAC;gCAAU;;;;;;;;;;;;;;;;;;;;;;;;AAOxC"}},
    {"offset": {"line": 5704, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/components/TpSlInputs.tsx"],"sourcesContent":["import React from 'react';\n\ninterface TpSlInputsProps {\n  isTpSlEnabled: boolean;\n  setIsTpSlEnabled: (enabled: boolean) => void;\n  takeProfitPrice: string;\n  setTakeProfitPrice: (price: string) => void;\n  stopLossPrice: string;\n  setStopLossPrice: (price: string) => void;\n  disabled?: boolean;\n}\n\nexport const TpSlInputs: React.FC<TpSlInputsProps> = ({\n  isTpSlEnabled,\n  setIsTpSlEnabled,\n  takeProfitPrice,\n  setTakeProfitPrice,\n  stopLossPrice,\n  setStopLossPrice,\n  disabled = false,\n}) => {\n  const handlePriceChange = (\n    setter: (value: string) => void,\n    e: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    const value = e.target.value;\n    if (value === '' || /^\\d*\\.?\\d*$/.test(value)) {\n      setter(value);\n    }\n  };\n\n  return (\n    <div className={disabled ? 'opacity-50 pointer-events-none' : ''}>\n      <div className=\"flex justify-between items-center text-sm mb-3\">\n        <span className=\"text-text-secondary text-xs uppercase tracking-wide font-medium\">\n          TP / SL\n        </span>\n        <label className=\"relative inline-block w-9 h-5 cursor-pointer\">\n          <input\n            type=\"checkbox\"\n            className=\"opacity-0 w-0 h-0 peer\"\n            checked={isTpSlEnabled}\n            onChange={(e) => setIsTpSlEnabled(e.target.checked)}\n            disabled={disabled}\n          />\n          <span\n            className={`absolute inset-0 rounded-full transition-all duration-300 ${\n              isTpSlEnabled ? 'bg-primary' : 'bg-trading-surface border border-border-default'\n            }`}\n          >\n            <span\n              className={`absolute left-0.5 top-0.5 h-3.5 w-3.5 bg-white rounded-full transition-transform duration-300 shadow-sm ${\n                isTpSlEnabled ? 'translate-x-4' : 'translate-x-0'\n              }`}\n            ></span>\n          </span>\n        </label>\n      </div>\n\n      {/* Take Profit / Stop Loss Form */}\n      {isTpSlEnabled && (\n        <div className=\"bg-trading-surface border border-border-default rounded-lg p-3 space-y-3 animate-slide-down\">\n          {/* Take Profit */}\n          <div>\n            <label className=\"text-[10px] uppercase tracking-wide text-text-muted mb-1.5 block font-medium\">\n              TAKE PROFIT\n            </label>\n            <div className=\"bg-trading-bg rounded-md px-3 py-2 flex items-center border border-border-default hover:border-border-active focus-within:border-primary transition-colors\">\n              <span className=\"text-xs text-text-muted mr-2\">$</span>\n              <input\n                type=\"text\"\n                placeholder=\"Price\"\n                value={takeProfitPrice}\n                onChange={(e) => handlePriceChange(setTakeProfitPrice, e)}\n                className=\"bg-transparent text-sm text-text-primary outline-none w-full placeholder-text-muted\"\n                disabled={disabled}\n              />\n            </div>\n          </div>\n\n          {/* Stop Loss */}\n          <div>\n            <label className=\"text-[10px] uppercase tracking-wide text-text-muted mb-1.5 block font-medium\">\n              STOP LOSS\n            </label>\n            <div className=\"bg-trading-bg rounded-md px-3 py-2 flex items-center border border-border-default hover:border-border-active focus-within:border-primary transition-colors\">\n              <span className=\"text-xs text-text-muted mr-2\">$</span>\n              <input\n                type=\"text\"\n                placeholder=\"Price\"\n                value={stopLossPrice}\n                onChange={(e) => handlePriceChange(setStopLossPrice, e)}\n                className=\"bg-transparent text-sm text-text-primary outline-none w-full placeholder-text-muted\"\n                disabled={disabled}\n              />\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n"],"names":[],"mappings":";;;;;;AAYO,MAAM,aAAwC,CAAC,EACpD,aAAa,EACb,gBAAgB,EAChB,eAAe,EACf,kBAAkB,EAClB,aAAa,EACb,gBAAgB,EAChB,WAAW,KAAK,EACjB;IACC,MAAM,oBAAoB,CACxB,QACA;QAEA,MAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;QAC5B,IAAI,UAAU,MAAM,cAAc,IAAI,CAAC,QAAQ;YAC7C,OAAO;QACT;IACF;IAEA,qBACE,8OAAC;QAAI,WAAW,WAAW,mCAAmC;;0BAC5D,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAK,WAAU;kCAAkE;;;;;;kCAGlF,8OAAC;wBAAM,WAAU;;0CACf,8OAAC;gCACC,MAAK;gCACL,WAAU;gCACV,SAAS;gCACT,UAAU,CAAC,IAAM,iBAAiB,EAAE,MAAM,CAAC,OAAO;gCAClD,UAAU;;;;;;0CAEZ,8OAAC;gCACC,WAAW,CAAC,0DAA0D,EACpE,gBAAgB,eAAe,mDAC/B;0CAEF,cAAA,8OAAC;oCACC,WAAW,CAAC,wGAAwG,EAClH,gBAAgB,kBAAkB,iBAClC;;;;;;;;;;;;;;;;;;;;;;;YAOT,+BACC,8OAAC;gBAAI,WAAU;;kCAEb,8OAAC;;0CACC,8OAAC;gCAAM,WAAU;0CAA+E;;;;;;0CAGhG,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAK,WAAU;kDAA+B;;;;;;kDAC/C,8OAAC;wCACC,MAAK;wCACL,aAAY;wCACZ,OAAO;wCACP,UAAU,CAAC,IAAM,kBAAkB,oBAAoB;wCACvD,WAAU;wCACV,UAAU;;;;;;;;;;;;;;;;;;kCAMhB,8OAAC;;0CACC,8OAAC;gCAAM,WAAU;0CAA+E;;;;;;0CAGhG,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAK,WAAU;kDAA+B;;;;;;kDAC/C,8OAAC;wCACC,MAAK;wCACL,aAAY;wCACZ,OAAO;wCACP,UAAU,CAAC,IAAM,kBAAkB,kBAAkB;wCACrD,WAAU;wCACV,UAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQ1B"}},
    {"offset": {"line": 5881, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/components/OrderSummary.tsx"],"sourcesContent":["import React from 'react';\nimport { formatDynamicUsd } from '@/features/trading/lib/marketUtils';\nimport { formatPrice } from '../utils/formatUtils';\n\ninterface OrderSummaryProps {\n  oraclePrice: number;\n  liquidationPrice: number | null;\n  tradingFee: string;\n  payAmount: string;\n  leverage: number;\n}\n\nexport const OrderSummary: React.FC<OrderSummaryProps> = ({\n  oraclePrice,\n  liquidationPrice,\n  tradingFee,\n  payAmount,\n  leverage,\n}) => {\n  return (\n    <div className=\"space-y-2 text-sm border-t border-border-muted pt-3\">\n      <div className=\"flex justify-between items-center\">\n        <span className=\"text-text-secondary\">Oracle Price</span>\n        <span className=\"text-text-primary font-medium\">\n          {Number.isFinite(oraclePrice) ? formatDynamicUsd(Number(oraclePrice)) : '$--'}\n        </span>\n      </div>\n      <div className=\"flex justify-between items-center\">\n        <span className=\"text-text-secondary\">Liquidation Price</span>\n        <span className=\"text-text-primary font-medium\">\n          {liquidationPrice ? formatPrice(liquidationPrice) : '-'}\n        </span>\n      </div>\n      <div className=\"flex justify-between items-center\">\n        <span className=\"text-text-secondary\">Trading Fee</span>\n        <span className=\"text-text-primary font-medium\">\n          {payAmount && leverage > 0 ? `$${tradingFee} (0.05%)` : '0.00%'}\n        </span>\n      </div>\n    </div>\n  );\n};\n"],"names":[],"mappings":";;;;;AACA;AACA;;;;AAUO,MAAM,eAA4C,CAAC,EACxD,WAAW,EACX,gBAAgB,EAChB,UAAU,EACV,SAAS,EACT,QAAQ,EACT;IACC,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAK,WAAU;kCAAsB;;;;;;kCACtC,8OAAC;wBAAK,WAAU;kCACb,OAAO,QAAQ,CAAC,eAAe,IAAA,oKAAgB,EAAC,OAAO,gBAAgB;;;;;;;;;;;;0BAG5E,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAK,WAAU;kCAAsB;;;;;;kCACtC,8OAAC;wBAAK,WAAU;kCACb,mBAAmB,IAAA,2MAAW,EAAC,oBAAoB;;;;;;;;;;;;0BAGxD,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAK,WAAU;kCAAsB;;;;;;kCACtC,8OAAC;wBAAK,WAAU;kCACb,aAAa,WAAW,IAAI,CAAC,CAAC,EAAE,WAAW,QAAQ,CAAC,GAAG;;;;;;;;;;;;;;;;;;AAKlE"}},
    {"offset": {"line": 5981, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/market-order/MarketActionButtons.tsx"],"sourcesContent":["import React from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Loader2 } from 'lucide-react';\n\ninterface MarketActionButtonsProps {\n  isUSDCApprovalPending?: boolean;\n  activeTab: 'long' | 'short' | 'swap';\n  authenticated: boolean;\n  isApproving: boolean;\n  isDepositing: boolean;\n  isRelayPending: boolean;\n  payAmount: string;\n  hasLargeAllowance: boolean;\n  onAction: () => void;\n}\n\nexport const MarketActionButtons: React.FC<MarketActionButtonsProps> = ({\n  activeTab,\n  authenticated,\n  isApproving,\n  isDepositing,\n  isRelayPending,\n  isUSDCApprovalPending,\n  payAmount,\n  hasLargeAllowance,\n  onAction,\n}) => {\n  const getButtonText = () => {\n    if (!authenticated) return 'Connect Wallet';\n    if (isUSDCApprovalPending) return 'Approving USDC...';\n    if (isApproving) return 'Approving for Paymaster...';\n    if (isDepositing) return 'Depositing to Paymaster...';\n    if (isRelayPending) return 'Opening Position...';\n    if (!payAmount || parseFloat(payAmount) <= 0) return 'Enter Amount';\n\n    if ((activeTab === 'long' || activeTab === 'short') && !hasLargeAllowance) {\n      return `Approve & ${activeTab === 'long' ? 'Long' : 'Short'}`;\n    }\n\n    if (activeTab === 'long') return 'Buy / Long';\n    if (activeTab === 'short') return 'Sell / Short';\n    return 'Swap';\n  };\n\n  const isButtonDisabled =\n    !authenticated ||\n    isRelayPending ||\n    isApproving ||\n    isDepositing ||\n    isUSDCApprovalPending ||\n    !payAmount ||\n    parseFloat(payAmount) <= 0;\n\n  // Variant mapping to shadcn button variants or custom classes\n  // Assuming shadcn Button has variants: default, destructive, outline, secondary, ghost, link.\n  // We might need to use className for specific colors like 'long' (green) and 'short' (red).\n  const getButtonClass = () => {\n    if (isButtonDisabled)\n      return 'opacity-60 cursor-not-allowed bg-secondary text-secondary-foreground';\n    if (activeTab === 'long')\n      return 'bg-long hover:bg-long-hover text-white shadow-lg shadow-long/20';\n    if (activeTab === 'short')\n      return 'bg-short hover:bg-short-hover text-white shadow-lg shadow-short/20';\n    return 'bg-swap hover:bg-swap-hover text-white shadow-lg shadow-swap/20';\n  };\n\n  return (\n    <Button\n      onClick={onAction}\n      disabled={isButtonDisabled}\n      className={`w-full font-bold text-base h-12 ${getButtonClass()}`}\n    >\n      {(isRelayPending || isUSDCApprovalPending) && (\n        <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n      )}\n      {getButtonText()}\n    </Button>\n  );\n};\n"],"names":[],"mappings":";;;;;AACA;AACA;;;;AAcO,MAAM,sBAA0D,CAAC,EACtE,SAAS,EACT,aAAa,EACb,WAAW,EACX,YAAY,EACZ,cAAc,EACd,qBAAqB,EACrB,SAAS,EACT,iBAAiB,EACjB,QAAQ,EACT;IACC,MAAM,gBAAgB;QACpB,IAAI,CAAC,eAAe,OAAO;QAC3B,IAAI,uBAAuB,OAAO;QAClC,IAAI,aAAa,OAAO;QACxB,IAAI,cAAc,OAAO;QACzB,IAAI,gBAAgB,OAAO;QAC3B,IAAI,CAAC,aAAa,WAAW,cAAc,GAAG,OAAO;QAErD,IAAI,CAAC,cAAc,UAAU,cAAc,OAAO,KAAK,CAAC,mBAAmB;YACzE,OAAO,CAAC,UAAU,EAAE,cAAc,SAAS,SAAS,SAAS;QAC/D;QAEA,IAAI,cAAc,QAAQ,OAAO;QACjC,IAAI,cAAc,SAAS,OAAO;QAClC,OAAO;IACT;IAEA,MAAM,mBACJ,CAAC,iBACD,kBACA,eACA,gBACA,yBACA,CAAC,aACD,WAAW,cAAc;IAE3B,8DAA8D;IAC9D,8FAA8F;IAC9F,4FAA4F;IAC5F,MAAM,iBAAiB;QACrB,IAAI,kBACF,OAAO;QACT,IAAI,cAAc,QAChB,OAAO;QACT,IAAI,cAAc,SAChB,OAAO;QACT,OAAO;IACT;IAEA,qBACE,8OAAC,4IAAM;QACL,SAAS;QACT,UAAU;QACV,WAAW,CAAC,gCAAgC,EAAE,kBAAkB;;YAE/D,CAAC,kBAAkB,qBAAqB,mBACvC,8OAAC,4NAAO;gBAAC,WAAU;;;;;;YAEpB;;;;;;;AAGP"}},
    {"offset": {"line": 6040, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/MarketOrder.tsx"],"sourcesContent":["'use client';\nimport React, { useState, useRef, useEffect, useMemo } from 'react';\nimport { useMarket } from '@/features/trading/contexts/MarketContext';\nimport { usePrivy, useWallets } from '@privy-io/react-auth';\nimport { baseSepolia } from 'wagmi/chains';\nimport { parseUnits } from 'viem';\nimport {\n  useRelayMarketOrder,\n  useApproveUSDCForTrading,\n  calculatePositionCost,\n} from '@/features/trading/hooks/useMarketOrder';\nimport { usePaymasterFlow } from '@/features/wallet/hooks/usePaymaster';\nimport { useEmbeddedWallet } from '@/features/wallet/hooks/useEmbeddedWallet';\nimport { useUSDCBalance } from '@/hooks/data/useUSDCBalance';\nimport { toast } from 'sonner';\nimport { useTPSL } from '@/features/trading/hooks/useTPSL';\nimport { useUserPositions } from '@/hooks/data/usePositions';\nimport { Market } from './components/MarketSelector';\nimport { CollateralInput } from './components/CollateralInput';\nimport { LeverageSelector } from './components/LeverageSelector';\nimport { PositionInfo } from './components/PositionInfo';\nimport { TpSlInputs } from './components/TpSlInputs';\nimport { OrderSummary } from './components/OrderSummary';\n\nimport { MarketActionButtons } from './market-order/MarketActionButtons';\n\ninterface MarketOrderProps {\n  activeTab?: 'long' | 'short' | 'swap';\n}\n\nconst MarketOrder: React.FC<MarketOrderProps> = ({ activeTab = 'long' }) => {\n  const { activeMarket, setActiveMarket, currentPrice } = useMarket();\n  const { authenticated } = usePrivy();\n  const { wallets } = useWallets();\n  const { address: embeddedAddress, hasEmbeddedWallet } = useEmbeddedWallet();\n  const [leverage, setLeverage] = useState(10);\n  const { usdcBalance, isLoadingBalance } = useUSDCBalance();\n  const [payAmount, setPayAmount] = useState<string>('');\n  const [isTpSlEnabled, setIsTpSlEnabled] = useState(false);\n  const [takeProfitPrice, setTakeProfitPrice] = useState<string>('');\n  const [stopLossPrice, setStopLossPrice] = useState<string>('');\n  const processedHashRef = useRef<string | null>(null);\n\n  const {\n    openPositionGasless,\n    isPending: isRelayPending,\n    hash: relayHash,\n    usdcCharged,\n    positionId: relayPositionId,\n  } = useRelayMarketOrder();\n\n  const { balance: paymasterBalance, isApproving, isDepositing } = usePaymasterFlow();\n\n  const {\n    approve: approveUSDC,\n    allowance,\n    isPending: isApprovalPending,\n  } = useApproveUSDCForTrading();\n  const { setTPSL } = useTPSL();\n  const { positionIds, refetch: refetchPositions } = useUserPositions();\n\n  const hasLargeAllowance = useMemo(() => {\n    return Boolean(allowance && allowance > parseUnits('10000', 6));\n  }, [allowance]);\n\n  const handleMarketSelect = (market: Market) => {\n    setActiveMarket({ ...market, category: market.category || 'crypto' });\n  };\n\n  // Get oracle price from current price - memoized\n  const oraclePrice = useMemo(() => {\n    return currentPrice ? parseFloat(currentPrice) : 0;\n  }, [currentPrice]);\n\n  const payUsdValue = useMemo(() => {\n    return payAmount ? parseFloat(payAmount) : 0;\n  }, [payAmount]);\n\n  const longShortUsdValue = useMemo(() => {\n    return payUsdValue * leverage;\n  }, [payUsdValue, leverage]);\n\n  const tokenAmount = useMemo(() => {\n    return oraclePrice > 0 ? longShortUsdValue / oraclePrice : 0;\n  }, [oraclePrice, longShortUsdValue]);\n\n  // Calculate liquidation price\n  const liquidationPrice = useMemo(() => {\n    if (!oraclePrice || !leverage || leverage <= 0 || !payAmount || parseFloat(payAmount) <= 0) {\n      return null;\n    }\n\n    // Liquidation happens when loss = collateral\n    const liqPercentage = 1 / leverage;\n\n    if (activeTab === 'long') {\n      return oraclePrice * (1 - liqPercentage);\n    } else if (activeTab === 'short') {\n      return oraclePrice * (1 + liqPercentage);\n    }\n    return null;\n  }, [oraclePrice, leverage, payAmount, activeTab]);\n\n  const handlePayInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    if (value === '' || /^\\d*\\.?\\d*$/.test(value)) {\n      setPayAmount(value);\n    }\n  };\n\n  const handleMaxClick = () => {\n    setPayAmount(usdcBalance);\n  };\n\n  // Handle market order execution\n  const handleOpenPosition = async () => {\n    if (!authenticated) {\n      toast.error('Please connect your wallet');\n      return;\n    }\n\n    if (!hasEmbeddedWallet || !embeddedAddress) {\n      toast.error('Embedded wallet not ready. Please wait...');\n      return;\n    }\n\n    if (!payAmount || parseFloat(payAmount) <= 0) {\n      toast.error('Please enter collateral amount');\n      return;\n    }\n\n    if (!activeMarket) {\n      toast.error('Please select a market');\n      return;\n    }\n\n    // Check if USDC is approved first (only for long/short, not swap)\n    const needsApproval = (activeTab === 'long' || activeTab === 'short') && !hasLargeAllowance;\n\n    // Find and set active embedded wallet used for both actions\n    const embeddedWallet = wallets.find(\n      (w) => w.walletClientType === 'privy' && w.address === embeddedAddress,\n    );\n\n    if (!embeddedWallet) {\n      toast.error('Embedded wallet not found in wallets list');\n      return;\n    }\n\n    await embeddedWallet.switchChain(baseSepolia.id);\n\n    // 1. Handle Approval if needed\n    if (needsApproval) {\n      try {\n        toast.loading('Approving USDC...', { id: 'market-approval' });\n        const maxAmount = parseUnits('1000000', 6).toString();\n        // This likely prompts wallet and waits for tx hash.\n        // We assume verify or wait logic is inside or handled by blockchain speed.\n        await approveUSDC(maxAmount);\n        toast.success('✅ Approved!', { id: 'market-approval' });\n      } catch (error) {\n        console.error('Approval failed:', error);\n        toast.error('Approval failed or rejected', { id: 'market-approval' });\n        return; // Stop flow if approval fails\n      }\n    }\n\n    // 2. Proceed to trade\n    try {\n      // Execute market order (GASLESS via relay!)\n      await openPositionGasless({\n        symbol: activeMarket.symbol,\n        isLong: activeTab === 'long',\n        collateral: payAmount,\n        leverage: Math.floor(leverage), // Round to integer\n      });\n      // Success toast will be shown by useEffect below\n    } catch (error) {\n      console.error('Error executing market order:', error);\n      toast.error('Failed to execute market order');\n    }\n  };\n\n  // Show success notification with explorer link and auto-set TP/SL\n  useEffect(() => {\n    // Only process new hashes, prevent duplicate toasts\n    if (relayHash && relayHash !== processedHashRef.current) {\n      processedHashRef.current = relayHash; // Mark as processed\n\n      const shouldSetTPSL = isTpSlEnabled && (takeProfitPrice || stopLossPrice);\n\n      toast.success(\n        <div>\n          <div>✅ Position opened! Gas paid in USDC: {usdcCharged}</div>\n          <a\n            href={`https://sepolia.basescan.org/tx/${relayHash}`}\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            className=\"text-blue-300 hover:underline text-xs\"\n          >\n            View transaction\n          </a>\n          {shouldSetTPSL && (\n            <div className=\"text-blue-300 text-xs mt-1\">🎯 Setting TP/SL automatically...</div>\n          )}\n        </div>,\n        { duration: 4000, id: 'position-success' },\n      );\n\n      // Auto-set TP/SL if enabled\n      if (shouldSetTPSL && embeddedAddress) {\n        const setTPSLForNewPosition = async () => {\n          try {\n            await new Promise((resolve) => setTimeout(resolve, 1000));\n            const newPositionId = relayPositionId;\n\n            if (!newPositionId) {\n              toast.error('⚠️ Could not get position ID. Set TP/SL manually.', {\n                duration: 5000,\n              });\n              return;\n            }\n\n            const success = await setTPSL({\n              positionId: newPositionId,\n              trader: embeddedAddress,\n              takeProfit: takeProfitPrice || undefined,\n              stopLoss: stopLossPrice || undefined,\n            });\n\n            if (success) {\n              toast.success('✅ TP/SL set successfully!', { duration: 3000 });\n              window.dispatchEvent(\n                new CustomEvent('tpsl-updated', {\n                  detail: { positionId: newPositionId },\n                }),\n              );\n            }\n          } catch (error) {\n            console.error('Failed to auto-set TP/SL:', error);\n            toast.error('⚠️ Could not auto-set TP/SL.', { duration: 5000 });\n          }\n        };\n\n        setTPSLForNewPosition();\n      }\n\n      setPayAmount('');\n      if (!shouldSetTPSL) {\n        setTakeProfitPrice('');\n        setStopLossPrice('');\n        setIsTpSlEnabled(false);\n      } else {\n        setTimeout(() => {\n          setTakeProfitPrice('');\n          setStopLossPrice('');\n          setIsTpSlEnabled(false);\n        }, 5000);\n      }\n    }\n  }, [\n    relayHash,\n    usdcCharged,\n    isTpSlEnabled,\n    takeProfitPrice,\n    stopLossPrice,\n    embeddedAddress,\n    setTPSL,\n    refetchPositions,\n    positionIds,\n    relayPositionId,\n  ]);\n\n  return (\n    <div className=\"flex flex-col gap-3 py-4 bg-trading-bg h-full px-3\">\n      {/* Collateral Input (USDC) */}\n      <CollateralInput\n        value={payAmount}\n        onChange={handlePayInputChange}\n        balance={usdcBalance}\n        isLoadingBalance={isLoadingBalance}\n        onMaxClick={handleMaxClick}\n        label=\"Collateral\"\n      />\n\n      {/* Position Info (Size & Market Selector) */}\n      <PositionInfo\n        activeTab={activeTab}\n        payUsdValue={payUsdValue}\n        oraclePrice={oraclePrice}\n        longShortUsdValue={longShortUsdValue}\n        tokenAmount={tokenAmount}\n        leverage={leverage}\n        activeMarket={activeMarket}\n        onMarketSelect={handleMarketSelect}\n      />\n\n      {/* Leverage Selector - Hidden for Swap */}\n      {activeTab !== 'swap' && (\n        <LeverageSelector leverage={leverage} onLeverageChange={setLeverage} />\n      )}\n\n      {/* Swap Message */}\n      {activeTab === 'swap' && (\n        <div className=\"text-center py-3 text-gray-500 text-sm\">Select different tokens</div>\n      )}\n\n      {/* TP/SL Inputs */}\n      {activeTab !== 'swap' && (\n        <TpSlInputs\n          isTpSlEnabled={isTpSlEnabled}\n          setIsTpSlEnabled={setIsTpSlEnabled}\n          takeProfitPrice={takeProfitPrice}\n          setTakeProfitPrice={setTakeProfitPrice}\n          stopLossPrice={stopLossPrice}\n          setStopLossPrice={setStopLossPrice}\n        />\n      )}\n\n      {/* Order Summary */}\n      <OrderSummary\n        oraclePrice={oraclePrice}\n        liquidationPrice={liquidationPrice}\n        tradingFee={\n          payAmount && leverage > 0 ? calculatePositionCost(payAmount, leverage).tradingFee : '0.00'\n        }\n        payAmount={payAmount}\n        leverage={leverage}\n      />\n\n      {/* Action Button */}\n      <MarketActionButtons\n        activeTab={activeTab}\n        authenticated={authenticated}\n        isApproving={isApproving}\n        isDepositing={isDepositing}\n        isRelayPending={isRelayPending}\n        isUSDCApprovalPending={isApprovalPending}\n        payAmount={payAmount}\n        hasLargeAllowance={hasLargeAllowance}\n        onAction={handleOpenPosition}\n      />\n\n      {/* Paymaster Info */}\n      {authenticated && parseFloat(paymasterBalance) > 0 && (\n        <div className=\"text-xs text-text-muted text-center pt-2\">\n          Gas Balance: ${parseFloat(paymasterBalance).toFixed(2)} USDC\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default MarketOrder;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6441, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/hooks/useLimitOrder.ts"],"sourcesContent":["/**\n * Hooks for Limit Order Trading with LimitExecutor\n *\n * Supports:\n * - Limit Open Orders: Open position when price reaches trigger\n * - Limit Close Orders: Close position at target price (take profit)\n * - Stop Loss Orders: Close position to limit losses\n */\n\nimport { useReadContract, useWaitForTransactionReceipt } from 'wagmi';\nimport {\n  parseUnits,\n  encodeFunctionData,\n  keccak256,\n  encodePacked,\n  formatUnits,\n  createPublicClient,\n  http,\n} from 'viem';\nimport { useState, useCallback, useEffect, useMemo } from 'react';\nimport { baseSepolia } from 'wagmi/chains';\nimport { useWallets } from '@privy-io/react-auth';\nimport { LIMIT_EXECUTOR_ADDRESS, USDC_ADDRESS, USDC_DECIMALS, RPC_URL } from '@/config/contracts';\nimport LimitExecutorJSON from '@/contracts/abis/LimitExecutor.json';\nimport MockUSDCABI from '@/contracts/abis/MockUSDC.json';\nimport { useEmbeddedWallet } from '@/features/wallet/hooks/useEmbeddedWallet';\nimport { toast } from 'sonner';\nimport { getLimitExecutionFee } from '@/lib/relayApi';\nimport { submitLimitOpenOrder } from '@/lib/limitOrderApi';\n\n// Extract ABI from JSON\nconst LimitExecutorABI = (LimitExecutorJSON as any).abi;\n\n// Order types enum (matches smart contract)\nexport enum OrderType {\n  LIMIT_OPEN = 0,\n  LIMIT_CLOSE = 1,\n  STOP_LOSS = 2,\n}\n\nexport enum OrderStatus {\n  PENDING = 0,\n  EXECUTED = 1,\n  CANCELLED = 2,\n}\n\nexport interface Order {\n  id: bigint;\n  orderType: OrderType;\n  status: OrderStatus;\n  trader: string;\n  symbol: string;\n  isLong: boolean;\n  collateral: bigint;\n  leverage: bigint;\n  triggerPrice: bigint;\n  positionId: bigint;\n  createdAt: bigint;\n  executedAt: bigint;\n  expiresAt: bigint;\n  nonce: bigint;\n}\n\nexport interface CreateLimitOpenParams {\n  symbol: string;\n  isLong: boolean;\n  collateral: string; // USDC amount\n  leverage: number;\n  triggerPrice: string; // Price with 8 decimals\n  takeProfit?: string; // Optional TP price (8 decimals)\n  stopLoss?: string; // Optional SL price (8 decimals)\n  expiresAt?: number; // Optional custom expiry (unix)\n}\n\nexport interface CreateLimitCloseParams {\n  positionId: bigint;\n  triggerPrice: string; // Price with 8 decimals\n}\n\nexport interface CreateStopLossParams {\n  positionId: bigint;\n  triggerPrice: string; // Price with 8 decimals\n}\n\n/**\n * Hook to check and approve USDC for LimitExecutor\n */\nexport function useApproveUSDCForLimitOrders() {\n  const { address } = useEmbeddedWallet();\n  const { wallets } = useWallets();\n  const [hash, setHash] = useState<`0x${string}` | undefined>();\n  const [isPending, setIsPending] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const { isLoading: isConfirming, isSuccess } = useWaitForTransactionReceipt({\n    hash,\n  });\n\n  // Check current allowance\n  const { data: allowance, refetch: refetchAllowance } = useReadContract({\n    address: USDC_ADDRESS,\n    abi: MockUSDCABI,\n    functionName: 'allowance',\n    args: address ? [address, LIMIT_EXECUTOR_ADDRESS] : undefined,\n    query: {\n      enabled: !!address,\n    },\n  });\n\n  const approve = async (amount: string) => {\n    try {\n      setIsPending(true);\n      setError(null);\n\n      const embeddedWallet = wallets.find(\n        (w) => w.walletClientType === 'privy' && w.address === address,\n      );\n\n      if (!embeddedWallet) {\n        throw new Error('Embedded wallet not found');\n      }\n\n      await embeddedWallet.switchChain(baseSepolia.id);\n      const walletClient = await embeddedWallet.getEthereumProvider();\n\n      if (!walletClient) {\n        throw new Error('Could not get wallet client');\n      }\n\n      const amountBigInt = parseUnits(amount, USDC_DECIMALS);\n\n      const data = encodeFunctionData({\n        abi: MockUSDCABI,\n        functionName: 'approve',\n        args: [LIMIT_EXECUTOR_ADDRESS, amountBigInt],\n      });\n\n      // Estimate gas\n      const gasEstimate = await walletClient.request({\n        method: 'eth_estimateGas',\n        params: [\n          {\n            from: address,\n            to: USDC_ADDRESS,\n            data,\n          },\n        ],\n      });\n      const gasLimit = (BigInt(gasEstimate as string) * 120n) / 100n;\n\n      const txHash = await walletClient.request({\n        method: 'eth_sendTransaction',\n        params: [\n          {\n            from: address,\n            to: USDC_ADDRESS,\n            data,\n            gas: '0x' + gasLimit.toString(16),\n          },\n        ],\n      });\n\n      setHash(txHash as `0x${string}`);\n    } catch (err) {\n      console.error('❌ Approve error:', err);\n      setError(err as Error);\n    } finally {\n      setIsPending(false);\n    }\n  };\n\n  const hasAllowance = (requiredAmount: string): boolean => {\n    if (!allowance) return false;\n    const required = parseUnits(requiredAmount, USDC_DECIMALS);\n    return (allowance as bigint) >= required;\n  };\n\n  return {\n    approve,\n    isPending,\n    isConfirming,\n    isSuccess,\n    error,\n    hash,\n    allowance: allowance as bigint | undefined,\n    hasAllowance,\n    refetchAllowance,\n  };\n}\n\n/**\n * Hook to fetch LimitExecutor configuration (e.g. trading fee)\n */\nexport function useLimitExecutorConfig() {\n  const { data: tradingFeeBps } = useReadContract({\n    address: LIMIT_EXECUTOR_ADDRESS,\n    abi: LimitExecutorABI,\n    functionName: 'tradingFeeBps',\n    query: {\n      staleTime: 30_000,\n      refetchOnWindowFocus: false,\n    },\n  });\n\n  return {\n    tradingFeeBps: (tradingFeeBps as bigint | undefined) ?? 5n,\n  };\n}\n\n/**\n * Hook to get execution fee\n */\nexport function useExecutionFee(\n  orderType: 'limit_open' | 'limit_close' | 'stop_loss' = 'limit_open',\n) {\n  const [executionFee, setExecutionFee] = useState<bigint | undefined>(undefined);\n  const [formatted, setFormatted] = useState<string>('0.00');\n  const [gasEstimate, setGasEstimate] = useState<string>('0');\n  const [baseFormatted, setBaseFormatted] = useState<string>('0.00');\n  const [bufferBps, setBufferBps] = useState<number>(2000);\n  const [isLoading, setIsLoading] = useState<boolean>(true);\n  const [error, setError] = useState<Error | null>(null);\n\n  const refresh = useCallback(async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      const estimate = await getLimitExecutionFee(orderType);\n\n      setExecutionFee(BigInt(estimate.recommendedMaxExecutionFee));\n      setFormatted(estimate.recommendedFormatted);\n      setGasEstimate(estimate.gasEstimate);\n      setBaseFormatted(estimate.baseCostFormatted);\n      setBufferBps(estimate.bufferBps);\n    } catch (err) {\n      console.error('Failed to load execution fee estimate:', err);\n      setError(err as Error);\n      setExecutionFee(undefined);\n      setFormatted('0.00');\n    } finally {\n      setIsLoading(false);\n    }\n  }, [orderType]);\n\n  useEffect(() => {\n    void refresh();\n  }, [refresh]);\n\n  return {\n    executionFee,\n    executionFeeFormatted: formatted,\n    baseFeeFormatted: baseFormatted,\n    gasEstimate,\n    bufferBps,\n    isLoading,\n    error,\n    refresh,\n  };\n}\n\n/**\n * Hook to create a limit open order\n */\nexport function useCreateLimitOpenOrder() {\n  const { address } = useEmbeddedWallet();\n  const { wallets } = useWallets();\n  const [isPending, setIsPending] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const [submission, setSubmission] = useState<{\n    orderId: string;\n    txHash: string;\n    expiresAt: bigint;\n    nonce: bigint;\n  } | null>(null);\n\n  const publicClient = useMemo(\n    () =>\n      createPublicClient({\n        chain: baseSepolia,\n        transport: http(RPC_URL),\n      }),\n    [],\n  );\n\n  const createOrder = useCallback(\n    async (params: CreateLimitOpenParams) => {\n      try {\n        setIsPending(true);\n        setError(null);\n        setSubmission(null);\n\n        if (!address) {\n          throw new Error('Wallet not connected');\n        }\n\n        const embeddedWallet = wallets.find(\n          (w) => w.walletClientType === 'privy' && w.address === address,\n        );\n\n        if (!embeddedWallet) {\n          throw new Error('Embedded wallet not found');\n        }\n\n        await embeddedWallet.switchChain(baseSepolia.id);\n        const walletClient = await embeddedWallet.getEthereumProvider();\n\n        if (!walletClient) {\n          throw new Error('Could not get wallet client');\n        }\n\n        // Parse values\n        const collateralBigInt = parseUnits(params.collateral, USDC_DECIMALS);\n        const triggerPriceBigInt = parseUnits(params.triggerPrice, 8);\n        const leverageBigInt = BigInt(Math.round(params.leverage));\n\n        // Fetch latest user nonce from contract\n        const nonce = (await publicClient.readContract({\n          address: LIMIT_EXECUTOR_ADDRESS,\n          abi: LimitExecutorABI,\n          functionName: 'getUserCurrentNonce',\n          args: [address],\n        })) as bigint;\n\n        const expiresAt =\n          params.expiresAt !== undefined\n            ? BigInt(params.expiresAt)\n            : BigInt(Math.floor(Date.now() / 1000) + 30 * 24 * 60 * 60); // default 30 days\n\n        // Prepare message hash for signing\n        const messageHash = keccak256(\n          encodePacked(\n            [\n              'address',\n              'string',\n              'bool',\n              'uint256',\n              'uint256',\n              'uint256',\n              'uint256',\n              'uint256',\n              'address',\n            ],\n            [\n              address,\n              params.symbol,\n              params.isLong,\n              collateralBigInt,\n              leverageBigInt,\n              triggerPriceBigInt,\n              nonce,\n              expiresAt,\n              LIMIT_EXECUTOR_ADDRESS,\n            ],\n          ),\n        );\n\n        const signature = (await walletClient.request({\n          method: 'personal_sign',\n          params: [messageHash, address],\n        })) as `0x${string}`;\n\n        const result = await submitLimitOpenOrder({\n          trader: address,\n          symbol: params.symbol,\n          isLong: params.isLong,\n          collateral: collateralBigInt.toString(),\n          leverage: leverageBigInt.toString(),\n          triggerPrice: triggerPriceBigInt.toString(),\n          nonce: nonce.toString(),\n          expiresAt: expiresAt.toString(),\n          signature,\n          takeProfit: params.takeProfit, // Pass TP/SL to backend\n          stopLoss: params.stopLoss,\n          metadata: {\n            collateralUsd: params.collateral,\n            triggerPriceUsd: params.triggerPrice,\n          },\n        });\n\n        toast.success(`Limit order submitted! Order #${result.orderId}`);\n        const submissionPayload = {\n          orderId: result.orderId,\n          txHash: result.txHash,\n          expiresAt,\n          nonce,\n        };\n        setSubmission(submissionPayload);\n\n        return submissionPayload;\n      } catch (err) {\n        console.error('❌ Error creating limit open order:', err);\n        setError(err as Error);\n        toast.error(err instanceof Error ? err.message : 'Failed to create limit order');\n        throw err;\n      } finally {\n        setIsPending(false);\n      }\n    },\n    [address, wallets, publicClient],\n  );\n\n  return {\n    createOrder,\n    isPending,\n    error,\n    submission,\n    isSuccess: submission !== null,\n  };\n}\n\n/**\n * Hook to create a limit close order (take profit)\n */\nexport function useCreateLimitCloseOrder() {\n  const { address } = useEmbeddedWallet();\n  const { wallets } = useWallets();\n  const [hash, setHash] = useState<`0x${string}` | undefined>();\n  const [isPending, setIsPending] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const { isLoading: isConfirming, isSuccess } = useWaitForTransactionReceipt({\n    hash,\n  });\n\n  const createOrder = useCallback(\n    async (params: CreateLimitCloseParams) => {\n      try {\n        setIsPending(true);\n        setError(null);\n\n        if (!address) {\n          throw new Error('Wallet not connected');\n        }\n\n        const embeddedWallet = wallets.find(\n          (w) => w.walletClientType === 'privy' && w.address === address,\n        );\n\n        if (!embeddedWallet) {\n          throw new Error('Embedded wallet not found');\n        }\n\n        await embeddedWallet.switchChain(baseSepolia.id);\n        const walletClient = await embeddedWallet.getEthereumProvider();\n\n        if (!walletClient) {\n          throw new Error('Could not get wallet client');\n        }\n\n        const triggerPriceBigInt = parseUnits(params.triggerPrice, 8);\n\n        const data = encodeFunctionData({\n          abi: LimitExecutorABI,\n          functionName: 'createLimitCloseOrder',\n          args: [params.positionId, triggerPriceBigInt],\n        });\n\n        const gasEstimate = await walletClient.request({\n          method: 'eth_estimateGas',\n          params: [\n            {\n              from: address,\n              to: LIMIT_EXECUTOR_ADDRESS,\n              data,\n            },\n          ],\n        });\n\n        const gasLimit = (BigInt(gasEstimate as string) * 120n) / 100n;\n\n        const txHash = await walletClient.request({\n          method: 'eth_sendTransaction',\n          params: [\n            {\n              from: address,\n              to: LIMIT_EXECUTOR_ADDRESS,\n              data,\n              gas: '0x' + gasLimit.toString(16),\n            },\n          ],\n        });\n\n        setHash(txHash as `0x${string}`);\n        toast.success('Take profit order created!');\n      } catch (err) {\n        console.error('❌ Error creating limit close order:', err);\n        setError(err as Error);\n        toast.error('Failed to create take profit order');\n        throw err;\n      } finally {\n        setIsPending(false);\n      }\n    },\n    [address, wallets],\n  );\n\n  return {\n    createOrder,\n    isPending,\n    isConfirming,\n    isSuccess,\n    error,\n    hash,\n  };\n}\n\n/**\n * Hook to create a stop loss order\n */\nexport function useCreateStopLossOrder() {\n  const { address } = useEmbeddedWallet();\n  const { wallets } = useWallets();\n  const [hash, setHash] = useState<`0x${string}` | undefined>();\n  const [isPending, setIsPending] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const { isLoading: isConfirming, isSuccess } = useWaitForTransactionReceipt({\n    hash,\n  });\n\n  const createOrder = useCallback(\n    async (params: CreateStopLossParams) => {\n      try {\n        setIsPending(true);\n        setError(null);\n\n        if (!address) {\n          throw new Error('Wallet not connected');\n        }\n\n        const embeddedWallet = wallets.find(\n          (w) => w.walletClientType === 'privy' && w.address === address,\n        );\n\n        if (!embeddedWallet) {\n          throw new Error('Embedded wallet not found');\n        }\n\n        await embeddedWallet.switchChain(baseSepolia.id);\n        const walletClient = await embeddedWallet.getEthereumProvider();\n\n        if (!walletClient) {\n          throw new Error('Could not get wallet client');\n        }\n\n        const triggerPriceBigInt = parseUnits(params.triggerPrice, 8);\n\n        const data = encodeFunctionData({\n          abi: LimitExecutorABI,\n          functionName: 'createStopLossOrder',\n          args: [params.positionId, triggerPriceBigInt],\n        });\n\n        const gasEstimate = await walletClient.request({\n          method: 'eth_estimateGas',\n          params: [\n            {\n              from: address,\n              to: LIMIT_EXECUTOR_ADDRESS,\n              data,\n            },\n          ],\n        });\n\n        const gasLimit = (BigInt(gasEstimate as string) * 120n) / 100n;\n\n        const txHash = await walletClient.request({\n          method: 'eth_sendTransaction',\n          params: [\n            {\n              from: address,\n              to: LIMIT_EXECUTOR_ADDRESS,\n              data,\n              gas: '0x' + gasLimit.toString(16),\n            },\n          ],\n        });\n\n        setHash(txHash as `0x${string}`);\n        toast.success('Stop loss order created!');\n      } catch (err) {\n        console.error('❌ Error creating stop loss order:', err);\n        setError(err as Error);\n        toast.error('Failed to create stop loss order');\n        throw err;\n      } finally {\n        setIsPending(false);\n      }\n    },\n    [address, wallets],\n  );\n\n  return {\n    createOrder,\n    isPending,\n    isConfirming,\n    isSuccess,\n    error,\n    hash,\n  };\n}\n\n/**\n * Hook to cancel a pending order\n */\nexport function useCancelOrder() {\n  const { address } = useEmbeddedWallet();\n  const { wallets } = useWallets();\n  const [hash, setHash] = useState<`0x${string}` | undefined>();\n  const [isPending, setIsPending] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const { isLoading: isConfirming, isSuccess } = useWaitForTransactionReceipt({\n    hash,\n  });\n\n  const publicClient = useMemo(\n    () =>\n      createPublicClient({\n        chain: baseSepolia,\n        transport: http(RPC_URL),\n      }),\n    [],\n  );\n\n  const cancelOrder = useCallback(\n    async (orderId: bigint) => {\n      try {\n        setIsPending(true);\n        setError(null);\n\n        if (!address) {\n          throw new Error('Wallet not connected');\n        }\n\n        const embeddedWallet = wallets.find(\n          (w) => w.walletClientType === 'privy' && w.address === address,\n        );\n\n        if (!embeddedWallet) {\n          throw new Error('Embedded wallet not found');\n        }\n\n        // Get user's current nonce from contract\n        const userNonce = (await publicClient.readContract({\n          address: LIMIT_EXECUTOR_ADDRESS,\n          abi: LimitExecutorABI,\n          functionName: 'getUserCurrentNonce',\n          args: [address],\n        })) as bigint;\n\n        await embeddedWallet.switchChain(baseSepolia.id);\n        const walletClient = await embeddedWallet.getEthereumProvider();\n\n        if (!walletClient) {\n          throw new Error('Could not get wallet client');\n        }\n\n        // Create message to sign: trader, orderId, nonce, contract address, \"CANCEL\"\n        const messageHash = keccak256(\n          encodePacked(\n            ['address', 'uint256', 'uint256', 'address', 'string'],\n            [address, orderId, userNonce, LIMIT_EXECUTOR_ADDRESS, 'CANCEL'],\n          ),\n        );\n\n        // Sign message\n        const signature = (await walletClient.request({\n          method: 'personal_sign',\n          params: [messageHash, address],\n        })) as string;\n\n        // Send to backend for gasless execution\n        const backendUrl = process.env.NEXT_PUBLIC_BACKEND_URL || 'http://localhost:3001';\n        const response = await fetch(`${backendUrl}/api/relay/cancel-order`, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            userAddress: address,\n            orderId: orderId.toString(),\n            signature: signature,\n          }),\n        });\n\n        if (!response.ok) {\n          const errorData = await response.json();\n          throw new Error(errorData.message || 'Failed to cancel order');\n        }\n\n        const result = await response.json();\n        const txHash = result.data.txHash;\n\n        setHash(txHash as `0x${string}`);\n        toast.success('Order cancelled successfully! (No gas fee)');\n      } catch (err) {\n        console.error('❌ Error cancelling order:', err);\n        setError(err as Error);\n        toast.error('Failed to cancel order');\n        throw err;\n      } finally {\n        setIsPending(false);\n      }\n    },\n    [address, wallets, publicClient],\n  );\n\n  return {\n    cancelOrder,\n    isPending,\n    isConfirming,\n    isSuccess,\n    error,\n    hash,\n  };\n}\n\n/**\n * Hook to get all user orders\n */\nexport function useUserOrders() {\n  const { address } = useEmbeddedWallet();\n\n  const {\n    data: orderIds,\n    isLoading,\n    refetch,\n  } = useReadContract({\n    address: LIMIT_EXECUTOR_ADDRESS,\n    abi: LimitExecutorABI,\n    functionName: 'getUserOrders',\n    args: address ? [address] : undefined,\n    query: {\n      enabled: !!address,\n      refetchInterval: 5000,\n    },\n  });\n\n  return {\n    orderIds: (orderIds as bigint[]) || [],\n    isLoading,\n    refetch,\n  };\n}\n\n/**\n * Hook to get pending orders for a user\n */\nexport function useUserPendingOrders() {\n  const { address } = useEmbeddedWallet();\n\n  const { data, isLoading, refetch } = useReadContract({\n    address: LIMIT_EXECUTOR_ADDRESS,\n    abi: LimitExecutorABI,\n    functionName: 'getUserPendingOrders',\n    args: address ? [address] : undefined,\n    query: {\n      enabled: !!address,\n      refetchInterval: 5000,\n    },\n  });\n\n  const orders = (data as any[]) || [];\n\n  return {\n    orders: orders.map((order: any) => ({\n      id: order.id || order[0],\n      orderType: order.orderType || order[1],\n      status: order.status || order[2],\n      trader: order.trader || order[3],\n      symbol: order.symbol || order[4],\n      isLong: order.isLong || order[5],\n      collateral: order.collateral || order[6],\n      leverage: order.leverage || order[7],\n      triggerPrice: order.triggerPrice || order[8],\n      positionId: order.positionId || order[9],\n      createdAt: order.createdAt || order[10],\n      executedAt: order.executedAt || order[11],\n      expiresAt: order.expiresAt || order[12],\n      nonce: order.nonce || order[13],\n    })) as Order[],\n    isLoading,\n    refetch,\n  };\n}\n\n/**\n * Hook to get single order details\n */\nexport function useOrder(orderId: bigint | undefined) {\n  const { data, isLoading, refetch } = useReadContract({\n    address: LIMIT_EXECUTOR_ADDRESS,\n    abi: LimitExecutorABI,\n    functionName: 'getOrder',\n    args: orderId !== undefined ? [orderId] : undefined,\n    query: {\n      enabled: orderId !== undefined,\n      refetchInterval: 5000,\n    },\n  });\n\n  if (!data) {\n    return {\n      order: null,\n      isLoading,\n      refetch,\n    };\n  }\n\n  const orderData = data as any;\n  const order: Order = {\n    id: orderData.id || orderData[0],\n    orderType: orderData.orderType || orderData[1],\n    status: orderData.status || orderData[2],\n    trader: orderData.trader || orderData[3],\n    symbol: orderData.symbol || orderData[4],\n    isLong: orderData.isLong || orderData[5],\n    collateral: orderData.collateral || orderData[6],\n    leverage: orderData.leverage || orderData[7],\n    triggerPrice: orderData.triggerPrice || orderData[8],\n    positionId: orderData.positionId || orderData[9],\n    createdAt: orderData.createdAt || orderData[10],\n    executedAt: orderData.executedAt || orderData[11],\n    expiresAt: orderData.expiresAt || orderData[12],\n    nonce: orderData.nonce || orderData[13],\n  };\n\n  return {\n    order,\n    isLoading,\n    refetch,\n  };\n}\n\n/**\n * Calculate total cost for creating a limit open order\n */\nexport function calculateLimitOrderCost(params: {\n  collateralUsd: string;\n  leverage: number;\n  executionFee?: bigint;\n  tradingFeeBps?: bigint;\n}): {\n  collateral: bigint;\n  tradingFee: bigint;\n  executionFee: bigint;\n  totalCost: bigint;\n  collateralFormatted: string;\n  tradingFeeFormatted: string;\n  executionFeeFormatted: string;\n  totalCostFormatted: string;\n} {\n  try {\n    const executionFee = params.executionFee ?? 0n;\n    if (!params.collateralUsd || Number(params.collateralUsd) <= 0) {\n      const formattedExecution = formatUnits(executionFee, USDC_DECIMALS);\n      return {\n        collateral: 0n,\n        tradingFee: 0n,\n        executionFee,\n        totalCost: executionFee,\n        collateralFormatted: '0',\n        tradingFeeFormatted: '0',\n        executionFeeFormatted: formattedExecution,\n        totalCostFormatted: formattedExecution,\n      };\n    }\n\n    const collateral = parseUnits(params.collateralUsd, USDC_DECIMALS);\n    const leverageBigInt = BigInt(Math.max(1, Math.round(params.leverage || 0)));\n    const tradingFeeBps = params.tradingFeeBps ?? 5n;\n    const positionSize = collateral * leverageBigInt;\n    const tradingFee = (positionSize * tradingFeeBps) / 10000n;\n    const totalCost = collateral + tradingFee + executionFee;\n    const format = (value: bigint) => formatUnits(value, USDC_DECIMALS);\n\n    return {\n      collateral,\n      tradingFee,\n      executionFee,\n      totalCost,\n      collateralFormatted: format(collateral),\n      tradingFeeFormatted: format(tradingFee),\n      executionFeeFormatted: format(executionFee),\n      totalCostFormatted: format(totalCost),\n    };\n  } catch (error) {\n    console.error('Error calculating limit order cost:', error);\n    const executionFeeFormatted = formatUnits(params.executionFee ?? 0n, USDC_DECIMALS);\n    return {\n      collateral: 0n,\n      tradingFee: 0n,\n      executionFee: params.executionFee ?? 0n,\n      totalCost: params.executionFee ?? 0n,\n      collateralFormatted: '0',\n      tradingFeeFormatted: '0',\n      executionFeeFormatted,\n      totalCostFormatted: executionFeeFormatted,\n    };\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7201, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/LimitOrderIntegration.tsx"],"sourcesContent":["/**\n * Limit Order Integration Component\n *\n * Component ini bisa di-copy paste ke LimitOrder.tsx yang sudah ada\n * untuk menambahkan fungsi submit limit order ke backend\n */\n\n'use client';\n\nimport { useState } from 'react';\nimport {\n  useCreateLimitOpenOrder,\n  useApproveUSDCForLimitOrders,\n  useExecutionFee,\n  useLimitExecutorConfig,\n  calculateLimitOrderCost,\n} from '@/features/trading/hooks/useLimitOrder';\nimport { toast } from 'sonner';\n\nexport function useLimitOrderSubmit() {\n  const {\n    createOrder,\n    isPending: isCreatingOrder,\n    isSuccess,\n    submission,\n  } = useCreateLimitOpenOrder();\n  const { approve, hasAllowance, isPending: isApproving } = useApproveUSDCForLimitOrders();\n  const { executionFee, executionFeeFormatted, error: executionFeeError } = useExecutionFee();\n  const { tradingFeeBps } = useLimitExecutorConfig();\n  const [isProcessing, setIsProcessing] = useState(false);\n\n  const submitLimitOrder = async (params: {\n    symbol: string;\n    isLong: boolean;\n    collateral: string;\n    leverage: number;\n    triggerPrice: string;\n    takeProfit?: string; // Optional TP price (8 decimals)\n    stopLoss?: string; // Optional SL price (8 decimals)\n  }) => {\n    try {\n      setIsProcessing(true);\n\n      // 1. Validate inputs\n      if (!params.collateral || parseFloat(params.collateral) <= 0) {\n        toast.error('Please enter collateral amount');\n        return false;\n      }\n\n      if (!params.triggerPrice || parseFloat(params.triggerPrice) <= 0) {\n        toast.error('Please enter trigger price');\n        return false;\n      }\n\n      // 2. Calculate total cost (collateral + trading fee + execution fee)\n      const cost = calculateLimitOrderCost({\n        collateralUsd: params.collateral,\n        leverage: params.leverage,\n        executionFee: executionFee ?? BigInt(0),\n        tradingFeeBps,\n      });\n\n      if (cost.totalCost === BigInt(0)) {\n        toast.error('Invalid order amount');\n        return false;\n      }\n\n      // 3. Check and approve USDC if needed (UNLIMITED APPROVAL - once only!)\n      const UNLIMITED_APPROVAL = '1000000000'; // 1B USDC (effectively unlimited)\n      if (!hasAllowance(cost.totalCostFormatted)) {\n        toast.loading('Approving USDC for limit orders (one-time only)...', {\n          id: 'limit-order-approve',\n        });\n        await approve(UNLIMITED_APPROVAL);\n        toast.success('USDC approved! You can now create limit orders without approval.', {\n          id: 'limit-order-approve',\n        });\n      }\n\n      // 4. Create limit order (sign + submit to keeper) - GASLESS!\n      toast.loading('Signing limit order (gasless)...', { id: 'limit-order-create' });\n      await createOrder({\n        symbol: params.symbol,\n        isLong: params.isLong,\n        collateral: params.collateral,\n        leverage: params.leverage,\n        triggerPrice: params.triggerPrice,\n        takeProfit: params.takeProfit,\n        stopLoss: params.stopLoss,\n      });\n\n      // Show success message with TP/SL info if configured\n      let successMsg = 'Limit order created successfully!';\n      if (params.takeProfit || params.stopLoss) {\n        successMsg += ' Auto TP/SL will be set when order executes.';\n      }\n      toast.success(successMsg, { id: 'limit-order-create', duration: 5000 });\n      return true;\n    } catch (error) {\n      console.error('Error creating limit order:', error);\n      toast.error('Failed to create limit order', { id: 'limit-order-create' });\n      return false;\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  return {\n    submitLimitOrder,\n    isProcessing: isProcessing || isApproving || isCreatingOrder,\n    isSuccess,\n    lastSubmission: submission,\n    executionFee: executionFeeFormatted,\n    executionFeeError,\n  };\n}\n\n/**\n * CARA PAKAI:\n *\n * 1. Import hook ini di LimitOrder.tsx:\n *\n *    import { useLimitOrderSubmit } from './LimitOrderIntegration';\n *\n * 2. Tambahkan di dalam component:\n *\n *    const { submitLimitOrder, isProcessing, executionFee } = useLimitOrderSubmit();\n *    const [limitPrice, setLimitPrice] = useState<string>('');\n *\n * 3. Tambahkan state untuk limit price (line ~165):\n *\n *    const [limitPrice, setLimitPrice] = useState<string>('');\n *\n * 4. Update input \"Limit Price\" (line 458-491) untuk menggunakan state:\n *\n *    <input\n *      type=\"text\"\n *      placeholder=\"0.0\"\n *      value={limitPrice}\n *      onChange={(e) => {\n *        const value = e.target.value;\n *        if (value === '' || /^\\d*\\.?\\d*$/.test(value)) {\n *          setLimitPrice(value);\n *        }\n *      }}\n *      className=\"bg-transparent text-xl text-white outline-none w-full\"\n *    />\n *\n * 5. Replace \"Enter an amount\" section (line 715-718) dengan button:\n *\n *    <button\n *      onClick={() => submitLimitOrder({\n *        symbol: activeMarket.symbol,\n *        isLong: activeTab === 'long',\n *        collateral: payAmount,\n *        leverage,\n *        triggerPrice: limitPrice,\n *      })}\n *      disabled={!payAmount || !limitPrice || isProcessing}\n *      className={`w-full py-4 rounded-lg font-semibold text-sm transition-all cursor-pointer ${\n *        !payAmount || !limitPrice || isProcessing\n *          ? 'bg-gray-700 text-gray-400 cursor-not-allowed'\n *          : activeTab === 'long'\n *          ? 'bg-green-500 hover:bg-green-600 text-white'\n *          : activeTab === 'short'\n *          ? 'bg-red-500 hover:bg-red-600 text-white'\n *          : 'bg-blue-500 hover:bg-blue-600 text-white'\n *      }`}\n *    >\n *      {isProcessing ? 'Processing...' : `Create Limit ${activeTab === 'long' ? 'Long' : 'Short'} Order`}\n *    </button>\n *\n * 6. Tampilkan execution fee info (di bawah Collateral In, sekitar line 614):\n *\n *    <div className=\"flex justify-between items-center text-sm\">\n *      <div className=\"flex items-center gap-1\">\n *        <span className=\"text-gray-400\">Execution Fee</span>\n *        <Info size={12} className=\"text-gray-500\" />\n *      </div>\n *      <span className=\"text-white\">${executionFee} USDC</span>\n *    </div>\n *\n * DONE! Limit order sudah terintegrasi penuh 🎉\n */\n"],"names":[],"mappings":"AAAA;;;;;CAKC;;;;AAID;AACA;AAOA;AAVA;;;;AAYO,SAAS;IACd,MAAM,EACJ,WAAW,EACX,WAAW,eAAe,EAC1B,SAAS,EACT,UAAU,EACX,GAAG,IAAA,+KAAuB;IAC3B,MAAM,EAAE,OAAO,EAAE,YAAY,EAAE,WAAW,WAAW,EAAE,GAAG,IAAA,oLAA4B;IACtF,MAAM,EAAE,YAAY,EAAE,qBAAqB,EAAE,OAAO,iBAAiB,EAAE,GAAG,IAAA,uKAAe;IACzF,MAAM,EAAE,aAAa,EAAE,GAAG,IAAA,8KAAsB;IAChD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAC;IAEjD,MAAM,mBAAmB,OAAO;QAS9B,IAAI;YACF,gBAAgB;YAEhB,qBAAqB;YACrB,IAAI,CAAC,OAAO,UAAU,IAAI,WAAW,OAAO,UAAU,KAAK,GAAG;gBAC5D,iJAAK,CAAC,KAAK,CAAC;gBACZ,OAAO;YACT;YAEA,IAAI,CAAC,OAAO,YAAY,IAAI,WAAW,OAAO,YAAY,KAAK,GAAG;gBAChE,iJAAK,CAAC,KAAK,CAAC;gBACZ,OAAO;YACT;YAEA,qEAAqE;YACrE,MAAM,OAAO,IAAA,+KAAuB,EAAC;gBACnC,eAAe,OAAO,UAAU;gBAChC,UAAU,OAAO,QAAQ;gBACzB,cAAc,gBAAgB,OAAO;gBACrC;YACF;YAEA,IAAI,KAAK,SAAS,KAAK,OAAO,IAAI;gBAChC,iJAAK,CAAC,KAAK,CAAC;gBACZ,OAAO;YACT;YAEA,wEAAwE;YACxE,MAAM,qBAAqB,cAAc,kCAAkC;YAC3E,IAAI,CAAC,aAAa,KAAK,kBAAkB,GAAG;gBAC1C,iJAAK,CAAC,OAAO,CAAC,sDAAsD;oBAClE,IAAI;gBACN;gBACA,MAAM,QAAQ;gBACd,iJAAK,CAAC,OAAO,CAAC,oEAAoE;oBAChF,IAAI;gBACN;YACF;YAEA,6DAA6D;YAC7D,iJAAK,CAAC,OAAO,CAAC,oCAAoC;gBAAE,IAAI;YAAqB;YAC7E,MAAM,YAAY;gBAChB,QAAQ,OAAO,MAAM;gBACrB,QAAQ,OAAO,MAAM;gBACrB,YAAY,OAAO,UAAU;gBAC7B,UAAU,OAAO,QAAQ;gBACzB,cAAc,OAAO,YAAY;gBACjC,YAAY,OAAO,UAAU;gBAC7B,UAAU,OAAO,QAAQ;YAC3B;YAEA,qDAAqD;YACrD,IAAI,aAAa;YACjB,IAAI,OAAO,UAAU,IAAI,OAAO,QAAQ,EAAE;gBACxC,cAAc;YAChB;YACA,iJAAK,CAAC,OAAO,CAAC,YAAY;gBAAE,IAAI;gBAAsB,UAAU;YAAK;YACrE,OAAO;QACT,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,+BAA+B;YAC7C,iJAAK,CAAC,KAAK,CAAC,gCAAgC;gBAAE,IAAI;YAAqB;YACvE,OAAO;QACT,SAAU;YACR,gBAAgB;QAClB;IACF;IAEA,OAAO;QACL;QACA,cAAc,gBAAgB,eAAe;QAC7C;QACA,gBAAgB;QAChB,cAAc;QACd;IACF;AACF,EAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAkEC"}},
    {"offset": {"line": 7369, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/limit-order/LimitPriceInput.tsx"],"sourcesContent":["import React from 'react';\nimport { formatPrice } from '../utils/formatUtils';\nimport Image from 'next/image';\nimport { Market } from '../components/MarketSelector';\n\ninterface LimitPriceInputProps {\n  limitPrice: string;\n  onLimitPriceChange: (e: React.ChangeEvent<HTMLInputElement>) => void;\n  effectiveOraclePrice: number;\n  activeTab: 'long' | 'short' | 'swap';\n  activeMarket: Market | null;\n  limitPriceError?: string;\n}\n\nexport const LimitPriceInput: React.FC<LimitPriceInputProps> = ({\n  limitPrice,\n  onLimitPriceChange,\n  effectiveOraclePrice,\n  activeTab,\n  activeMarket,\n  limitPriceError,\n}) => {\n  return (\n    <div className=\"bg-trading-surface border border-border-default rounded-lg p-3\">\n      <div className=\"flex justify-between items-center mb-2\">\n        <label className=\"text-xs text-text-secondary\">Limit Price</label>\n        <span className=\"text-xs text-info-light\">Mark: {formatPrice(effectiveOraclePrice)}</span>\n      </div>\n      <div className=\"flex items-center justify-between\">\n        <input\n          type=\"text\"\n          placeholder=\"0.0\"\n          value={limitPrice}\n          onChange={onLimitPriceChange}\n          className={`bg-transparent text-xl text-text-primary outline-none w-full ${\n            limitPriceError ? 'text-destructive' : ''\n          }`}\n        />\n        {activeTab === 'swap' ? (\n          <div className=\"flex items-center gap-1.5 text-text-primary font-semibold text-sm whitespace-nowrap ml-3\">\n            <Image\n              src=\"/icons/usdc.png\"\n              alt=\"USDC\"\n              width={20}\n              height={20}\n              className=\"rounded-full flex-shrink-0\"\n              onError={(e) => {\n                const target = e.currentTarget;\n                target.style.display = 'none';\n              }}\n            />\n            <span>USDC per</span>\n            {activeMarket && (\n              <div className=\"flex items-center gap-1\">\n                {activeMarket.logoUrl && (\n                  <Image\n                    src={activeMarket.logoUrl}\n                    alt={activeMarket.symbol}\n                    width={20}\n                    height={20}\n                    className=\"rounded-full flex-shrink-0\"\n                    onError={(e) => {\n                      const target = e.currentTarget;\n                      target.style.display = 'none';\n                    }}\n                  />\n                )}\n                <span>{activeMarket.symbol}</span>\n              </div>\n            )}\n          </div>\n        ) : (\n          <span className=\"text-text-primary font-semibold\">USD</span>\n        )}\n      </div>\n      {limitPriceError && (\n        <span className=\"text-xs text-destructive mt-1 block\">{limitPriceError}</span>\n      )}\n    </div>\n  );\n};\n"],"names":[],"mappings":";;;;;AACA;AACA;;;;AAYO,MAAM,kBAAkD,CAAC,EAC9D,UAAU,EACV,kBAAkB,EAClB,oBAAoB,EACpB,SAAS,EACT,YAAY,EACZ,eAAe,EAChB;IACC,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAM,WAAU;kCAA8B;;;;;;kCAC/C,8OAAC;wBAAK,WAAU;;4BAA0B;4BAAO,IAAA,2MAAW,EAAC;;;;;;;;;;;;;0BAE/D,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,MAAK;wBACL,aAAY;wBACZ,OAAO;wBACP,UAAU;wBACV,WAAW,CAAC,6DAA6D,EACvE,kBAAkB,qBAAqB,IACvC;;;;;;oBAEH,cAAc,uBACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC,wIAAK;gCACJ,KAAI;gCACJ,KAAI;gCACJ,OAAO;gCACP,QAAQ;gCACR,WAAU;gCACV,SAAS,CAAC;oCACR,MAAM,SAAS,EAAE,aAAa;oCAC9B,OAAO,KAAK,CAAC,OAAO,GAAG;gCACzB;;;;;;0CAEF,8OAAC;0CAAK;;;;;;4BACL,8BACC,8OAAC;gCAAI,WAAU;;oCACZ,aAAa,OAAO,kBACnB,8OAAC,wIAAK;wCACJ,KAAK,aAAa,OAAO;wCACzB,KAAK,aAAa,MAAM;wCACxB,OAAO;wCACP,QAAQ;wCACR,WAAU;wCACV,SAAS,CAAC;4CACR,MAAM,SAAS,EAAE,aAAa;4CAC9B,OAAO,KAAK,CAAC,OAAO,GAAG;wCACzB;;;;;;kDAGJ,8OAAC;kDAAM,aAAa,MAAM;;;;;;;;;;;;;;;;;iFAKhC,8OAAC;wBAAK,WAAU;kCAAkC;;;;;;;;;;;;YAGrD,iCACC,8OAAC;gBAAK,WAAU;0BAAuC;;;;;;;;;;;;AAI/D"}},
    {"offset": {"line": 7519, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/limit-order/LimitActionButtons.tsx"],"sourcesContent":["import React from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Loader2 } from 'lucide-react';\n\ninterface LimitActionButtonsProps {\n  activeTab: 'long' | 'short' | 'swap';\n  authenticated: boolean;\n  isProcessing: boolean;\n  isUSDCApprovalPending?: boolean;\n  payAmount: string;\n  limitPrice: string;\n  hasLargeAllowance: boolean;\n  onAction: () => void;\n}\n\nexport const LimitActionButtons: React.FC<LimitActionButtonsProps> = ({\n  activeTab,\n  authenticated,\n  isProcessing,\n  isUSDCApprovalPending,\n  payAmount,\n  limitPrice,\n  hasLargeAllowance,\n  onAction,\n}) => {\n  const isButtonDisabled =\n    !authenticated || !payAmount || !limitPrice || isProcessing || isUSDCApprovalPending;\n\n  // Variant mapping\n  const getButtonClass = () => {\n    if (isButtonDisabled)\n      return 'opacity-60 cursor-not-allowed bg-secondary text-secondary-foreground';\n    if (activeTab === 'long')\n      return 'bg-long hover:bg-long-hover text-white shadow-lg shadow-long/20';\n    if (activeTab === 'short')\n      return 'bg-short hover:bg-short-hover text-white shadow-lg shadow-short/20';\n    return 'bg-swap hover:bg-swap-hover text-white shadow-lg shadow-swap/20';\n  };\n\n  const getButtonText = () => {\n    if (!authenticated) return 'Connect Wallet';\n    if (isUSDCApprovalPending) return 'Approving USDC...';\n    if (isProcessing) return 'Processing...';\n    if (!payAmount) return 'Enter Amount';\n    if (!limitPrice) return 'Enter Limit Price';\n\n    if ((activeTab === 'long' || activeTab === 'short') && !hasLargeAllowance) {\n      return `Approve & Create ${activeTab === 'long' ? 'Long' : 'Short'} Order`;\n    }\n\n    return `Create Limit ${activeTab === 'long' ? 'Long' : 'Short'} Order`;\n  };\n\n  return (\n    <Button\n      onClick={onAction}\n      disabled={isButtonDisabled}\n      className={`w-full font-bold text-base h-12 ${getButtonClass()}`}\n    >\n      {(isProcessing || isUSDCApprovalPending) && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n      {getButtonText()}\n    </Button>\n  );\n};\n"],"names":[],"mappings":";;;;;AACA;AACA;;;;AAaO,MAAM,qBAAwD,CAAC,EACpE,SAAS,EACT,aAAa,EACb,YAAY,EACZ,qBAAqB,EACrB,SAAS,EACT,UAAU,EACV,iBAAiB,EACjB,QAAQ,EACT;IACC,MAAM,mBACJ,CAAC,iBAAiB,CAAC,aAAa,CAAC,cAAc,gBAAgB;IAEjE,kBAAkB;IAClB,MAAM,iBAAiB;QACrB,IAAI,kBACF,OAAO;QACT,IAAI,cAAc,QAChB,OAAO;QACT,IAAI,cAAc,SAChB,OAAO;QACT,OAAO;IACT;IAEA,MAAM,gBAAgB;QACpB,IAAI,CAAC,eAAe,OAAO;QAC3B,IAAI,uBAAuB,OAAO;QAClC,IAAI,cAAc,OAAO;QACzB,IAAI,CAAC,WAAW,OAAO;QACvB,IAAI,CAAC,YAAY,OAAO;QAExB,IAAI,CAAC,cAAc,UAAU,cAAc,OAAO,KAAK,CAAC,mBAAmB;YACzE,OAAO,CAAC,iBAAiB,EAAE,cAAc,SAAS,SAAS,QAAQ,MAAM,CAAC;QAC5E;QAEA,OAAO,CAAC,aAAa,EAAE,cAAc,SAAS,SAAS,QAAQ,MAAM,CAAC;IACxE;IAEA,qBACE,8OAAC,4IAAM;QACL,SAAS;QACT,UAAU;QACV,WAAW,CAAC,gCAAgC,EAAE,kBAAkB;;YAE/D,CAAC,gBAAgB,qBAAqB,mBAAK,8OAAC,4NAAO;gBAAC,WAAU;;;;;;YAC9D;;;;;;;AAGP"}},
    {"offset": {"line": 7573, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/LimitOrder.tsx"],"sourcesContent":["'use client';\nimport React, { useState, useEffect, useRef, useMemo } from 'react';\nimport { useMarket } from '@/features/trading/contexts/MarketContext';\nimport { usePrivy } from '@privy-io/react-auth';\nimport { parseUnits } from 'viem';\nimport { useLimitOrderSubmit } from './LimitOrderIntegration';\nimport { useApproveUSDCForLimitOrders } from '@/features/trading/hooks/useLimitOrder';\nimport { useUSDCBalance } from '@/hooks/data/useUSDCBalance';\nimport { toast } from 'sonner';\nimport { Market } from './components/MarketSelector';\n\nimport { CollateralInput } from './components/CollateralInput';\nimport { LeverageSelector } from './components/LeverageSelector';\nimport { PositionInfo } from './components/PositionInfo';\nimport { TpSlInputs } from './components/TpSlInputs';\nimport { OrderSummary } from './components/OrderSummary';\n\nimport { LimitPriceInput } from './limit-order/LimitPriceInput';\nimport { LimitActionButtons } from './limit-order/LimitActionButtons';\n\ninterface LimitOrderProps {\n  activeTab?: 'long' | 'short' | 'swap';\n}\n\nconst LimitOrder: React.FC<LimitOrderProps> = ({ activeTab = 'long' }) => {\n  const { activeMarket, setActiveMarket, currentPrice } = useMarket();\n  const { authenticated } = usePrivy();\n  const [leverage, setLeverage] = useState(10);\n  const { usdcBalance, isLoadingBalance } = useUSDCBalance();\n  const [oraclePrice, setOraclePrice] = useState<number | null>(null);\n  const [payAmount, setPayAmount] = useState<string>('');\n  const [limitPrice, setLimitPrice] = useState<string>('');\n  const [isTpSlEnabled, setIsTpSlEnabled] = useState(false);\n  const [takeProfitPrice, setTakeProfitPrice] = useState<string>('');\n  const [stopLossPrice, setStopLossPrice] = useState<string>('');\n\n  const { submitLimitOrder, isProcessing } = useLimitOrderSubmit();\n\n  const {\n    approve: approveUSDC,\n    allowance,\n    isPending: isApprovalPending,\n    refetchAllowance,\n    isSuccess: isApprovalSuccess,\n  } = useApproveUSDCForLimitOrders();\n\n  const hasLargeAllowance = useMemo(() => {\n    return Boolean(allowance && allowance > parseUnits('10000', 6));\n  }, [allowance]);\n\n  useEffect(() => {\n    if (isApprovalSuccess) {\n      const timer = setTimeout(() => {\n        refetchAllowance();\n      }, 2000);\n      return () => clearTimeout(timer);\n    }\n  }, [isApprovalSuccess, refetchAllowance]);\n\n  const handleMarketSelect = (market: Market) => {\n    setActiveMarket({ ...market, category: market.category || 'crypto' });\n  };\n\n  const effectiveOraclePrice = oraclePrice || (currentPrice ? parseFloat(currentPrice) : 0);\n  const payUsdValue = payAmount ? parseFloat(payAmount) : 0;\n  const longShortUsdValue = payUsdValue * leverage;\n  const tokenAmount = effectiveOraclePrice > 0 ? longShortUsdValue / effectiveOraclePrice : 0;\n\n  const liquidationPrice = useMemo(() => {\n    const triggerPriceNum = limitPrice ? parseFloat(limitPrice) : null;\n\n    if (\n      !triggerPriceNum ||\n      !leverage ||\n      leverage <= 0 ||\n      !payAmount ||\n      parseFloat(payAmount) <= 0\n    ) {\n      return null;\n    }\n\n    const liqPercentage = 1 / leverage;\n\n    if (activeTab === 'long') {\n      return triggerPriceNum * (1 - liqPercentage);\n    } else if (activeTab === 'short') {\n      return triggerPriceNum * (1 + liqPercentage);\n    }\n    return null;\n  }, [limitPrice, leverage, payAmount, activeTab]);\n\n  const handlePayInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    if (value === '' || /^\\d*\\.?\\d*$/.test(value)) {\n      setPayAmount(value);\n    }\n  };\n\n  const handleLimitPriceChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    if (value === '' || /^\\d*\\.?\\d*$/.test(value)) {\n      setLimitPrice(value);\n    }\n  };\n\n  const handleMaxClick = () => {\n    setPayAmount(usdcBalance);\n  };\n\n  // Fetch Pyth Oracle price via WebSocket\n  useEffect(() => {\n    const wsUrl =\n      (process.env.NEXT_PUBLIC_BACKEND_URL || 'http://localhost:3001').replace(/^http/, 'ws') +\n      '/ws/price';\n    const ws = new WebSocket(wsUrl);\n\n    ws.onmessage = (event) => {\n      try {\n        const message = JSON.parse(event.data);\n        if (message.type === 'price_update' && message.data && activeMarket) {\n          const priceData = message.data[activeMarket.symbol];\n          if (priceData) {\n            setOraclePrice(priceData.price);\n          }\n        }\n      } catch (error) {\n        // Silent error\n      }\n    };\n\n    return () => {\n      if (ws.readyState === WebSocket.OPEN) ws.close();\n    };\n  }, [activeMarket]);\n\n  const handleCreateOrder = async () => {\n    if (!activeMarket) return;\n\n    const needsApproval = (activeTab === 'long' || activeTab === 'short') && !hasLargeAllowance;\n\n    if (needsApproval) {\n      try {\n        toast.loading('Approving USDC...', { id: 'limit-approval' });\n        const maxAmount = parseUnits('1000000', 6).toString();\n        await approveUSDC(maxAmount);\n        toast.success('Approved!', { id: 'limit-approval' });\n      } catch (error) {\n        console.error('Approval failed:', error);\n        toast.error('Approval failed or rejected', { id: 'limit-approval' });\n        return;\n      }\n    }\n\n    let tpPrice: string | undefined;\n    let slPrice: string | undefined;\n\n    if (isTpSlEnabled) {\n      if (takeProfitPrice) {\n        const tpNum = parseFloat(takeProfitPrice);\n        if (!isNaN(tpNum) && tpNum > 0) {\n          tpPrice = Math.floor(tpNum * 100000000).toString();\n        }\n      }\n      if (stopLossPrice) {\n        const slNum = parseFloat(stopLossPrice);\n        if (!isNaN(slNum) && slNum > 0) {\n          slPrice = Math.floor(slNum * 100000000).toString();\n        }\n      }\n    }\n\n    await submitLimitOrder({\n      symbol: activeMarket.symbol,\n      isLong: activeTab === 'long',\n      collateral: payAmount || '0',\n      leverage,\n      triggerPrice: limitPrice || '0',\n      takeProfit: tpPrice,\n      stopLoss: slPrice,\n    });\n  };\n\n  return (\n    <div className=\"flex flex-col gap-3 py-4\">\n      {/* Pay Section */}\n      <CollateralInput\n        value={payAmount}\n        onChange={handlePayInputChange}\n        balance={usdcBalance}\n        isLoadingBalance={isLoadingBalance}\n        onMaxClick={handleMaxClick}\n        label=\"Pay\"\n        tokenSymbol=\"USDC\"\n      />\n\n      {/* Position Info */}\n      <PositionInfo\n        activeTab={activeTab}\n        payUsdValue={payUsdValue}\n        oraclePrice={effectiveOraclePrice}\n        longShortUsdValue={longShortUsdValue}\n        tokenAmount={tokenAmount}\n        leverage={leverage}\n        activeMarket={activeMarket}\n        onMarketSelect={handleMarketSelect}\n      />\n\n      {/* Limit Price */}\n      <LimitPriceInput\n        limitPrice={limitPrice}\n        onLimitPriceChange={handleLimitPriceChange}\n        effectiveOraclePrice={effectiveOraclePrice}\n        activeTab={activeTab}\n        activeMarket={activeMarket}\n      />\n\n      {/* Leverage Slider */}\n      {activeTab !== 'swap' && (\n        <LeverageSelector leverage={leverage} onLeverageChange={setLeverage} />\n      )}\n\n      {/* Swap Message */}\n      {activeTab === 'swap' && (\n        <div className=\"text-center py-3 text-gray-500 text-sm\">Select different tokens</div>\n      )}\n\n      {/* TP/SL Inputs */}\n      {activeTab !== 'swap' && (\n        <TpSlInputs\n          isTpSlEnabled={isTpSlEnabled}\n          setIsTpSlEnabled={setIsTpSlEnabled}\n          takeProfitPrice={takeProfitPrice}\n          setTakeProfitPrice={setTakeProfitPrice}\n          stopLossPrice={stopLossPrice}\n          setStopLossPrice={setStopLossPrice}\n        />\n      )}\n\n      {/* Order Summary */}\n      <OrderSummary\n        oraclePrice={effectiveOraclePrice}\n        liquidationPrice={liquidationPrice}\n        tradingFee={\n          payAmount && leverage > 0\n            ? (parseFloat(payAmount) * leverage * 0.0005).toFixed(6)\n            : '0.00'\n        }\n        payAmount={payAmount}\n        leverage={leverage}\n      />\n\n      {/* Action Button */}\n      <LimitActionButtons\n        activeTab={activeTab}\n        authenticated={authenticated}\n        isProcessing={isProcessing}\n        isUSDCApprovalPending={isApprovalPending}\n        payAmount={payAmount}\n        limitPrice={limitPrice}\n        hasLargeAllowance={hasLargeAllowance}\n        onAction={handleCreateOrder}\n      />\n    </div>\n  );\n};\n\nexport default LimitOrder;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7858, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/wallet/hooks/useTapToTradeApproval.ts"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\nimport { usePrivy, useWallets } from '@privy-io/react-auth';\nimport { parseUnits, formatUnits } from 'viem';\nimport { USDC_ADDRESS, TAP_TO_TRADE_EXECUTOR_ADDRESS, USDC_DECIMALS } from '@/config/contracts';\n\nconst USDC_ABI = [\n  {\n    inputs: [\n      { name: 'spender', type: 'address' },\n      { name: 'amount', type: 'uint256' },\n    ],\n    name: 'approve',\n    outputs: [{ name: '', type: 'bool' }],\n    stateMutability: 'nonpayable',\n    type: 'function',\n  },\n  {\n    inputs: [\n      { name: 'owner', type: 'address' },\n      { name: 'spender', type: 'address' },\n    ],\n    name: 'allowance',\n    outputs: [{ name: '', type: 'uint256' }],\n    stateMutability: 'view',\n    type: 'function',\n  },\n];\n\n/**\n * Hook for USDC approval specifically for TapToTradeExecutor contract\n */\nexport function useTapToTradeApproval() {\n  const { authenticated } = usePrivy();\n  const { wallets, ready: walletsReady } = useWallets();\n  const [allowance, setAllowance] = useState<bigint | null>(null);\n  const [isPending, setIsPending] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n\n  /**\n   * Fetch current USDC allowance for TapToTradeExecutor\n   */\n  const fetchAllowance = useCallback(async () => {\n    if (!authenticated || !walletsReady) return;\n\n    try {\n      const embeddedWallet = wallets.find((w) => w.walletClientType === 'privy');\n      if (!embeddedWallet) return;\n\n      const walletClient = await embeddedWallet.getEthereumProvider();\n      if (!walletClient) return;\n\n      const userAddress = embeddedWallet.address;\n\n      // Encode allowance call\n      const allowanceData = `0xdd62ed3e${userAddress\n        .slice(2)\n        .padStart(64, '0')}${TAP_TO_TRADE_EXECUTOR_ADDRESS.slice(2).padStart(64, '0')}`;\n\n      const result = await walletClient.request({\n        method: 'eth_call',\n        params: [\n          {\n            to: USDC_ADDRESS,\n            data: allowanceData,\n          },\n          'latest',\n        ],\n      });\n\n      const allowanceValue = result === '0x' || !result ? BigInt(0) : BigInt(result as string);\n      setAllowance(allowanceValue);\n    } catch (error) {\n      setAllowance(BigInt(0));\n    }\n  }, [authenticated, walletsReady, wallets]);\n\n  /**\n   * Approve USDC for TapToTradeExecutor\n   */\n  const approve = useCallback(\n    async (amount: string) => {\n      if (!authenticated || !walletsReady) {\n        throw new Error('Wallet not ready');\n      }\n\n      const embeddedWallet = wallets.find((w) => w.walletClientType === 'privy');\n      if (!embeddedWallet) {\n        throw new Error('Embedded wallet not found');\n      }\n\n      setIsPending(true);\n\n      try {\n        const walletClient = await embeddedWallet.getEthereumProvider();\n        if (!walletClient) {\n          throw new Error('Wallet client not available');\n        }\n\n        // Encode approve function call\n        const approveData = `0x095ea7b3${TAP_TO_TRADE_EXECUTOR_ADDRESS.slice(2).padStart(\n          64,\n          '0',\n        )}${BigInt(amount).toString(16).padStart(64, '0')}`;\n\n        const txHash = await walletClient.request({\n          method: 'eth_sendTransaction',\n          params: [\n            {\n              from: embeddedWallet.address,\n              to: USDC_ADDRESS,\n              data: approveData,\n            },\n          ],\n        });\n\n        // Wait for confirmation\n        let confirmed = false;\n        let attempts = 0;\n        while (!confirmed && attempts < 30) {\n          await new Promise((resolve) => setTimeout(resolve, 2000));\n          const receipt = await walletClient.request({\n            method: 'eth_getTransactionReceipt',\n            params: [txHash],\n          });\n\n          if (receipt && (receipt as any).status === '0x1') {\n            confirmed = true;\n          }\n          attempts++;\n        }\n\n        if (!confirmed) {\n          throw new Error('Transaction confirmation timeout');\n        }\n\n        // Refresh allowance\n        await fetchAllowance();\n\n        return txHash;\n      } catch (error: any) {\n        throw error;\n      } finally {\n        setIsPending(false);\n      }\n    },\n    [authenticated, walletsReady, wallets, fetchAllowance],\n  );\n\n  /**\n   * Check if user has sufficient allowance (> threshold)\n   */\n  const hasAllowance = useCallback(\n    (threshold: bigint = parseUnits('10000', USDC_DECIMALS)) => {\n      return allowance !== null && allowance > threshold;\n    },\n    [allowance],\n  );\n\n  // Fetch allowance on mount and when dependencies change\n  useEffect(() => {\n    if (authenticated && walletsReady) {\n      fetchAllowance();\n    }\n  }, [authenticated, walletsReady, fetchAllowance]);\n\n  return {\n    allowance,\n    approve,\n    hasAllowance,\n    isPending,\n    isLoading,\n    refetch: fetchAllowance,\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8044, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/wallet/hooks/useOneTapProfitApproval.ts"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { usePrivy, useWallets } from '@privy-io/react-auth';\nimport { createWalletClient, custom, encodeFunctionData, parseUnits } from 'viem';\nimport { baseSepolia } from 'viem/chains';\n\nconst USDC_ADDRESS = process.env.NEXT_PUBLIC_USDC_TOKEN_ADDRESS as `0x${string}`;\nconst ONE_TAP_PROFIT_ADDRESS = process.env.NEXT_PUBLIC_ONE_TAP_PROFIT_ADDRESS as `0x${string}`;\n\nconst USDC_ABI = [\n  {\n    inputs: [\n      { name: 'spender', type: 'address' },\n      { name: 'amount', type: 'uint256' },\n    ],\n    name: 'approve',\n    outputs: [{ name: '', type: 'bool' }],\n    stateMutability: 'nonpayable',\n    type: 'function',\n  },\n  {\n    inputs: [\n      { name: 'owner', type: 'address' },\n      { name: 'spender', type: 'address' },\n    ],\n    name: 'allowance',\n    outputs: [{ name: '', type: 'uint256' }],\n    stateMutability: 'view',\n    type: 'function',\n  },\n] as const;\n\nexport const useOneTapProfitApproval = () => {\n  const { authenticated } = usePrivy();\n  const { wallets } = useWallets();\n  const [allowance, setAllowance] = useState<bigint | null>(null);\n  const [isPending, setIsPending] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const embeddedWallet = wallets.find((w) => w.walletClientType === 'privy');\n\n  // Check current allowance\n  const checkAllowance = useCallback(async () => {\n    if (!authenticated || !embeddedWallet) {\n      setAllowance(null);\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      const ethereumProvider = await embeddedWallet.getEthereumProvider();\n      const userAddress = embeddedWallet.address as `0x${string}`;\n\n      const allowanceData = encodeFunctionData({\n        abi: USDC_ABI,\n        functionName: 'allowance',\n        args: [userAddress, ONE_TAP_PROFIT_ADDRESS],\n      });\n\n      const result = await ethereumProvider.request({\n        method: 'eth_call',\n        params: [\n          {\n            to: USDC_ADDRESS,\n            data: allowanceData,\n          },\n          'latest',\n        ],\n      });\n\n      const currentAllowance = BigInt(result as string);\n      setAllowance(currentAllowance);\n    } catch (error) {\n      console.error('Failed to check OneTapProfit allowance:', error);\n      setAllowance(null);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [authenticated, embeddedWallet]);\n\n  // Auto-check allowance on mount and when wallet changes\n  useEffect(() => {\n    checkAllowance();\n  }, [checkAllowance]);\n\n  // Approve USDC spending\n  const approve = useCallback(\n    async (amount: string) => {\n      if (!authenticated || !embeddedWallet) {\n        throw new Error('Wallet not connected');\n      }\n\n      setIsPending(true);\n\n      try {\n        const ethereumProvider = await embeddedWallet.getEthereumProvider();\n        const userAddress = embeddedWallet.address as `0x${string}`;\n\n        const walletClient = createWalletClient({\n          account: userAddress,\n          chain: baseSepolia,\n          transport: custom(ethereumProvider),\n        });\n\n        const approveData = encodeFunctionData({\n          abi: USDC_ABI,\n          functionName: 'approve',\n          args: [ONE_TAP_PROFIT_ADDRESS, BigInt(amount)],\n        });\n\n        const txHash = await walletClient.sendTransaction({\n          account: userAddress,\n          to: USDC_ADDRESS,\n          data: approveData,\n        });\n\n        // Wait a bit for transaction to be mined\n        await new Promise((resolve) => setTimeout(resolve, 3000));\n\n        // Refresh allowance\n        await checkAllowance();\n\n        return txHash;\n      } catch (error) {\n        console.error('Failed to approve USDC for OneTapProfit:', error);\n        throw error;\n      } finally {\n        setIsPending(false);\n      }\n    },\n    [authenticated, embeddedWallet, checkAllowance],\n  );\n\n  // Check if user has sufficient allowance for a specific amount\n  const hasAllowance = useCallback(\n    (requiredAmount?: string) => {\n      if (!allowance) return false;\n      if (!requiredAmount) return allowance > 0n;\n\n      try {\n        const required = parseUnits(requiredAmount, 6);\n        return allowance >= required;\n      } catch {\n        return false;\n      }\n    },\n    [allowance],\n  );\n\n  return {\n    allowance,\n    hasAllowance,\n    approve,\n    isPending,\n    isLoading,\n    checkAllowance,\n  };\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8229, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/tap-to-trade/TimeframeSelector.tsx"],"sourcesContent":["import React from 'react';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\n\ninterface TimeframeOption {\n  label: string;\n  value: string;\n}\n\nconst TIMEFRAME_OPTIONS: TimeframeOption[] = [\n  { label: '1m', value: '1' },\n  { label: '5m', value: '5' },\n  { label: '15m', value: '15' },\n  { label: '30m', value: '30' },\n  { label: '1H', value: '60' },\n  { label: '4H', value: '240' },\n  { label: '1D', value: 'D' },\n];\n\ninterface TimeframeSelectorProps {\n  timeframe: string;\n  setTimeframe: (value: string) => void;\n  disabled?: boolean;\n}\n\nexport const TimeframeSelector: React.FC<TimeframeSelectorProps> = ({\n  timeframe,\n  setTimeframe,\n  disabled = false,\n}) => {\n  return (\n    <div className={disabled ? 'opacity-50 pointer-events-none' : ''}>\n      <label className=\"text-xs text-text-secondary mb-2 block\">Timeframe</label>\n      <Select value={timeframe} onValueChange={setTimeframe} disabled={disabled}>\n        <SelectTrigger className=\"w-full bg-trading-surface border-border-default h-11\">\n          <SelectValue placeholder=\"Select timeframe\" />\n        </SelectTrigger>\n        <SelectContent className=\"bg-trading-surface border-border-default\">\n          {TIMEFRAME_OPTIONS.map((option) => (\n            <SelectItem\n              key={option.value}\n              value={option.value}\n              className=\"text-text-primary focus:bg-trading-elevated focus:text-text-primary\"\n            >\n              {option.label}\n            </SelectItem>\n          ))}\n        </SelectContent>\n      </Select>\n    </div>\n  );\n};\n"],"names":[],"mappings":";;;;;AACA;;;AAaA,MAAM,oBAAuC;IAC3C;QAAE,OAAO;QAAM,OAAO;IAAI;IAC1B;QAAE,OAAO;QAAM,OAAO;IAAI;IAC1B;QAAE,OAAO;QAAO,OAAO;IAAK;IAC5B;QAAE,OAAO;QAAO,OAAO;IAAK;IAC5B;QAAE,OAAO;QAAM,OAAO;IAAK;IAC3B;QAAE,OAAO;QAAM,OAAO;IAAM;IAC5B;QAAE,OAAO;QAAM,OAAO;IAAI;CAC3B;AAQM,MAAM,oBAAsD,CAAC,EAClE,SAAS,EACT,YAAY,EACZ,WAAW,KAAK,EACjB;IACC,qBACE,8OAAC;QAAI,WAAW,WAAW,mCAAmC;;0BAC5D,8OAAC;gBAAM,WAAU;0BAAyC;;;;;;0BAC1D,8OAAC,4IAAM;gBAAC,OAAO;gBAAW,eAAe;gBAAc,UAAU;;kCAC/D,8OAAC,mJAAa;wBAAC,WAAU;kCACvB,cAAA,8OAAC,iJAAW;4BAAC,aAAY;;;;;;;;;;;kCAE3B,8OAAC,mJAAa;wBAAC,WAAU;kCACtB,kBAAkB,GAAG,CAAC,CAAC,uBACtB,8OAAC,gJAAU;gCAET,OAAO,OAAO,KAAK;gCACnB,WAAU;0CAET,OAAO,KAAK;+BAJR,OAAO,KAAK;;;;;;;;;;;;;;;;;;;;;;AAW/B"}},
    {"offset": {"line": 8331, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/tap-to-trade/GridSettings.tsx"],"sourcesContent":["import React from 'react';\nimport { Grid as GridIcon, Info } from 'lucide-react';\nimport { useTapToTrade } from '@/features/trading/contexts/TapToTradeContext';\nimport { Slider } from '@/components/ui/slider';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Market } from '../components/MarketSelector';\nimport { Tooltip, TooltipContent, TooltipTrigger } from '@/components/ui/tooltip';\n\ninterface GridSettingsProps {\n  tradeMode: 'open-position' | 'one-tap-profit';\n  activeMarket: Market | null;\n  timeframe: string;\n  currentPrice: string;\n  setHasSelectedYGrid: (value: boolean) => void;\n}\n\nexport const GridSettings: React.FC<GridSettingsProps> = ({\n  tradeMode,\n  activeMarket,\n  timeframe,\n  currentPrice,\n  setHasSelectedYGrid,\n}) => {\n  const tapToTrade = useTapToTrade();\n\n  if (tradeMode !== 'open-position') return null;\n\n  return (\n    <div className=\"space-y-4 border-t border-border-muted pt-4\">\n      <div className=\"font-semibold text-text-secondary flex items-center gap-2 mys-2\">\n        <GridIcon size={14} />\n        Tap to Trade Grid Settings\n      </div>\n\n      {/* X Coordinate - Time Grid */}\n      <div className={tapToTrade.isEnabled ? 'opacity-50 pointer-events-none' : ''}>\n        <label className=\"text-xs text-text-secondary mb-3 flex items-center gap-1\">\n          X Coordinate (Time Grid Size)\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <div className=\"cursor-help inline-flex\">\n                <Info\n                  size={12}\n                  className=\"text-text-muted hover:text-text-primary transition-colors\"\n                />\n              </div>\n            </TooltipTrigger>\n            <TooltipContent>\n              <p>\n                1 Grid Column = {tapToTrade.gridSizeX} Candle\n                {tapToTrade.gridSizeX > 1 ? 's' : ''}\n              </p>\n            </TooltipContent>\n          </Tooltip>\n        </label>\n        <div className=\"flex items-center gap-3\">\n          <Slider\n            value={[tapToTrade.gridSizeX]}\n            min={1}\n            max={15}\n            step={1}\n            onValueChange={(val) => tapToTrade.setGridSizeX(val[0])}\n            disabled={tapToTrade.isEnabled}\n            className=\"flex-1\"\n          />\n          <div className=\"flex items-center gap-2\">\n            <div className=\"bg-trading-surface border border-border-default rounded p-3 py-1.5 min-w-[30px] text-center\">\n              <span className=\"text-text-primary font-semibold text-sm\">\n                {tapToTrade.gridSizeX}\n              </span>\n            </div>\n            <span className=\"text-text-muted text-xs\"> candles</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Y Coordinate - Price Grid */}\n      <div className={tapToTrade.isEnabled ? 'opacity-50 pointer-events-none' : ''}>\n        <label className=\"text-xs text-text-secondary mb-2 flex items-center gap-1\">\n          Y Coordinate (Price Grid Size)\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <div className=\"cursor-help inline-flex\">\n                <Info\n                  size={12}\n                  className=\"text-text-muted hover:text-text-primary transition-colors\"\n                />\n              </div>\n            </TooltipTrigger>\n            <TooltipContent>\n              <p>Each Grid Row = {tapToTrade.gridSizeY.toFixed(1)}% Price Difference</p>\n            </TooltipContent>\n          </Tooltip>\n        </label>\n\n        <div className=\"flex items-center gap-2\">\n          <div className=\"relative w-full\">\n            <Input\n              type=\"number\"\n              min=\"0.01\"\n              max=\"100\"\n              step=\"0.01\"\n              value={tapToTrade.gridSizeY}\n              onChange={(e) => {\n                tapToTrade.setGridSizeY(parseFloat(e.target.value) || 0.001);\n                setHasSelectedYGrid(true);\n              }}\n              disabled={tapToTrade.isEnabled}\n              className=\"bg-trading-surface border-border-default pr-8\"\n            />\n            <span className=\"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted text-sm\">\n              %\n            </span>\n          </div>\n        </div>\n\n        {/* Price Difference Display */}\n        {Number(currentPrice) > 0 && (\n          <div className=\"mt-3\">\n            <label className=\"text-xs text-text-secondary mb-2 block\">\n              Price difference per grid\n            </label>\n            <div className=\"bg-trading-surface border border-border-default rounded-lg px-3 py-2.5 flex items-center gap-2\">\n              <span className=\"text-text-primary font-medium\">\n                {((Number(currentPrice) * tapToTrade.gridSizeY) / 100).toFixed(2)}\n              </span>\n              <span className=\"text-text-muted text-sm\">$</span>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Cell Orders Statistics */}\n      {tapToTrade.isEnabled && tapToTrade.cellOrders.size > 0 && (\n        <div className=\"bg-trading-surface rounded-lg p-3 space-y-2 border border-border-default\">\n          <div className=\"text-xs font-semibold text-text-primary mb-2\">Active Orders</div>\n          <div className=\"flex justify-between text-xs\">\n            <span className=\"text-text-secondary\">Total Orders:</span>\n            <span className=\"text-text-primary font-semibold\">\n              {Array.from(tapToTrade.cellOrders.values()).reduce(\n                (sum: any, cell: any) => sum + cell.orderCount,\n                0,\n              )}\n            </span>\n          </div>\n          <div className=\"flex justify-between text-xs\">\n            <span className=\"text-text-secondary\">Cells with Orders:</span>\n            <span className=\"text-text-primary font-semibold\">{tapToTrade.cellOrders.size}</span>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8721, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/tap-to-trade/TradeActionButtons.tsx"],"sourcesContent":["import React from 'react';\nimport { toast } from 'sonner';\nimport { ConnectedWallet } from '@privy-io/react-auth';\nimport { Button } from '@/components/ui/button';\nimport { Loader2 } from 'lucide-react';\nimport { Market } from '../components/MarketSelector';\n\ninterface TradeActionButtonsProps {\n  tradeMode: 'open-position' | 'one-tap-profit';\n  tapToTrade: any;\n  activeMarket: Market | null;\n  marginAmount: string;\n  leverage: number;\n  timeframe: string;\n  currentPrice: string;\n  hasLargeAllowance: boolean;\n  hasLargeOneTapProfitAllowance: boolean;\n  hasSelectedYGrid: boolean;\n  wallets: ConnectedWallet[];\n\n  onPreApprove: () => Promise<void>;\n  onPreApproveOneTapProfit: () => Promise<void>;\n  isApprovalPending: boolean;\n  isOneTapProfitApprovalPending: boolean;\n  disabled?: boolean;\n  onMobileClose?: () => void;\n}\n\nexport const TradeActionButtons: React.FC<TradeActionButtonsProps> = ({\n  tradeMode,\n  tapToTrade,\n  activeMarket,\n  marginAmount,\n  leverage,\n  timeframe,\n  currentPrice,\n  hasLargeAllowance,\n  hasLargeOneTapProfitAllowance,\n  hasSelectedYGrid,\n  wallets,\n\n  onPreApprove,\n  onPreApproveOneTapProfit,\n  isApprovalPending,\n  isOneTapProfitApprovalPending,\n  disabled,\n  onMobileClose,\n}) => {\n  const handleMainAction = async () => {\n    if (tradeMode === 'open-position' && !hasLargeAllowance) {\n      await onPreApprove();\n    } else if (tradeMode === 'one-tap-profit' && !hasLargeOneTapProfitAllowance) {\n      await onPreApproveOneTapProfit();\n    }\n\n    if (!marginAmount || parseFloat(marginAmount) === 0) {\n      toast.error(\n        tradeMode === 'one-tap-profit' ? 'Please enter bet amount' : 'Please enter margin amount',\n      );\n      return;\n    }\n\n    if (tradeMode === 'open-position' && !hasSelectedYGrid) {\n      toast.error('Please select Y Coordinate (Price Grid) first');\n      return;\n    }\n\n    if (tradeMode === 'open-position') {\n      await tapToTrade.toggleMode({\n        symbol: activeMarket?.symbol || 'BTC',\n        margin: marginAmount,\n        leverage: leverage,\n        timeframe: timeframe,\n        currentPrice: Number(currentPrice) || 0,\n      });\n      onMobileClose?.();\n    } else {\n      // Binary Trading Logic\n      try {\n        toast.loading('Creating session key...', {\n          id: 'binary-session',\n        });\n\n        const embeddedWallet = wallets.find((w) => w.walletClientType === 'privy');\n        if (!embeddedWallet) throw new Error('Privy wallet not found');\n\n        const walletClient = await embeddedWallet.getEthereumProvider();\n        if (!walletClient) throw new Error('Could not get wallet client');\n\n        const newSession = await tapToTrade.createSession(\n          embeddedWallet.address,\n          walletClient,\n          30 * 60 * 1000,\n        );\n\n        if (!newSession) throw new Error('Session creation failed');\n\n        await tapToTrade.toggleMode({\n          symbol: activeMarket?.symbol || 'BTC',\n          margin: marginAmount,\n          leverage: 1,\n          timeframe: '1',\n          currentPrice: Number(currentPrice) || 0,\n        });\n\n        tapToTrade.setIsBinaryTradingEnabled(true);\n        toast.success('Binary Trading enabled!', { id: 'binary-session', duration: 5000 });\n        onMobileClose?.();\n      } catch (error) {\n        console.error('Failed to enable binary trading:', error);\n        toast.error('Failed to enable binary trading', { id: 'binary-session' });\n      }\n    }\n  };\n\n  const STOP_ACTION = async () => {\n    if (tradeMode === 'one-tap-profit') {\n      tapToTrade.setIsBinaryTradingEnabled(false);\n      await tapToTrade.toggleMode();\n      toast.success('Binary Trading stopped');\n    } else {\n      await tapToTrade.toggleMode();\n    }\n  };\n\n  if (tapToTrade.isEnabled) {\n    return (\n      <Button\n        variant=\"destructive\"\n        size=\"lg\"\n        onClick={STOP_ACTION}\n        disabled={tapToTrade.isLoading}\n        className=\"w-full mt-2 font-bold shadow-lg shadow-destructive/30\"\n      >\n        {tapToTrade.isLoading\n          ? 'Stopping...'\n          : tradeMode === 'one-tap-profit'\n          ? 'Stop Trading'\n          : 'Stop Tap to Trade'}\n      </Button>\n    );\n  }\n\n  // Determine Button State\n  let buttonText = 'Enable Tap to Trade';\n  let isLoading = false;\n  let variant: 'default' | 'secondary' | 'destructive' | 'outline' | 'ghost' | 'link' = 'default';\n\n  if (tradeMode === 'open-position') {\n    if (!hasLargeAllowance) {\n      buttonText = isApprovalPending ? 'Approving USDC...' : 'Enable One-Click Trading';\n      isLoading = isApprovalPending;\n      variant = 'default';\n    } else {\n      buttonText = tapToTrade.isLoading ? 'Setting up session...' : 'Enable Tap to Trade';\n      isLoading = tapToTrade.isLoading;\n    }\n  } else {\n    if (!hasLargeOneTapProfitAllowance) {\n      buttonText = isOneTapProfitApprovalPending ? 'Approving USDC...' : 'Enable One-Click Binary';\n      isLoading = isOneTapProfitApprovalPending;\n    } else {\n      buttonText = tapToTrade.isLoading ? 'Setting up session...' : 'Enable Binary Trade';\n      isLoading = tapToTrade.isLoading;\n    }\n  }\n\n  return (\n    <Button\n      size=\"lg\"\n      className=\"w-full mt-2 font-bold shadow-lg shadow-primary/30\"\n      onClick={handleMainAction}\n      disabled={disabled || isLoading}\n    >\n      {isLoading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n      {buttonText}\n    </Button>\n  );\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8860, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/tap-to-trade/TradeInfoSection.tsx"],"sourcesContent":["import React from 'react';\nimport { formatPrice } from '../utils/formatUtils';\nimport { Market } from '../components/MarketSelector';\n\ninterface TradeInfoSectionProps {\n  tradeMode: 'open-position' | 'one-tap-profit';\n  activeMarket: Market | null;\n  marginUsdValue: number;\n  leverage: number;\n  timeframe: string;\n  selectedTimeframeLabel: string;\n  xCoordinate: string;\n  yCoordinate: string;\n}\n\nexport const TradeInfoSection: React.FC<TradeInfoSectionProps> = ({\n  tradeMode,\n  activeMarket,\n  marginUsdValue,\n  leverage,\n  selectedTimeframeLabel,\n  xCoordinate,\n  yCoordinate,\n}) => {\n  return (\n    <div className=\"text-xs text-text-muted space-y-1 border-t border-border-muted pt-3\">\n      <div className=\"flex justify-between\">\n        <span>Mode:</span>\n        <span className=\"text-text-primary\">\n          {tradeMode === 'open-position' ? 'Open Position' : 'One Tap Profit'}\n        </span>\n      </div>\n      <div className=\"flex justify-between\">\n        <span>Market:</span>\n        <span className=\"text-text-primary\">{activeMarket?.symbol || 'BTC'}/USD</span>\n      </div>\n      <div className=\"flex justify-between\">\n        <span>{tradeMode === 'one-tap-profit' ? 'Bet Amount:' : 'Margin:'}</span>\n        <span className=\"text-text-primary\">{formatPrice(marginUsdValue)}</span>\n      </div>\n      {tradeMode !== 'one-tap-profit' && (\n        <div className=\"flex justify-between\">\n          <span>Leverage:</span>\n          <span className=\"text-text-primary\">{leverage.toFixed(1)}x</span>\n        </div>\n      )}\n      {tradeMode === 'open-position' && (\n        <div className=\"flex justify-between\">\n          <span>Timeframe:</span>\n          <span className=\"text-text-primary\">{selectedTimeframeLabel}</span>\n        </div>\n      )}\n      {xCoordinate && (\n        <div className=\"flex justify-between\">\n          <span>X (Time):</span>\n          <span className=\"text-text-primary\">{xCoordinate}</span>\n        </div>\n      )}\n      {yCoordinate && (\n        <div className=\"flex justify-between\">\n          <span>Y (Price):</span>\n          <span className=\"text-text-primary\">${yCoordinate}</span>\n        </div>\n      )}\n    </div>\n  );\n};\n"],"names":[],"mappings":";;;;;AACA;;;AAcO,MAAM,mBAAoD,CAAC,EAChE,SAAS,EACT,YAAY,EACZ,cAAc,EACd,QAAQ,EACR,sBAAsB,EACtB,WAAW,EACX,WAAW,EACZ;IACC,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;kCAAK;;;;;;kCACN,8OAAC;wBAAK,WAAU;kCACb,cAAc,kBAAkB,kBAAkB;;;;;;;;;;;;0BAGvD,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;kCAAK;;;;;;kCACN,8OAAC;wBAAK,WAAU;;4BAAqB,cAAc,UAAU;4BAAM;;;;;;;;;;;;;0BAErE,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;kCAAM,cAAc,mBAAmB,gBAAgB;;;;;;kCACxD,8OAAC;wBAAK,WAAU;kCAAqB,IAAA,2MAAW,EAAC;;;;;;;;;;;;YAElD,cAAc,kCACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;kCAAK;;;;;;kCACN,8OAAC;wBAAK,WAAU;;4BAAqB,SAAS,OAAO,CAAC;4BAAG;;;;;;;;;;;;;YAG5D,cAAc,iCACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;kCAAK;;;;;;kCACN,8OAAC;wBAAK,WAAU;kCAAqB;;;;;;;;;;;;YAGxC,6BACC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;kCAAK;;;;;;kCACN,8OAAC;wBAAK,WAAU;kCAAqB;;;;;;;;;;;;YAGxC,6BACC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;kCAAK;;;;;;kCACN,8OAAC;wBAAK,WAAU;;4BAAoB;4BAAE;;;;;;;;;;;;;;;;;;;AAKhD"}},
    {"offset": {"line": 9060, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/TaptoTrade.tsx"],"sourcesContent":["'use client';\nimport React, { useState, useRef, useMemo } from 'react';\nimport { Info } from 'lucide-react';\nimport { useMarket } from '@/features/trading/contexts/MarketContext';\nimport { useTapToTrade } from '@/features/trading/contexts/TapToTradeContext';\nimport { useUSDCBalance } from '@/hooks/data/useUSDCBalance';\nimport { useTapToTradeApproval } from '@/features/wallet/hooks/useTapToTradeApproval';\nimport { useOneTapProfitApproval } from '@/features/wallet/hooks/useOneTapProfitApproval';\nimport { useSessionKey } from '@/features/wallet/hooks/useSessionKey';\nimport { useWallets } from '@privy-io/react-auth';\nimport { parseUnits } from 'viem';\nimport { toast } from 'sonner';\n\n// Import Shared Components\nimport { MarketSelector, Market } from './components/MarketSelector';\nimport { CollateralInput } from './components/CollateralInput';\nimport { LeverageSelector } from './components/LeverageSelector';\n\n// Import Feature Specific Components\nimport { TimeframeSelector } from './tap-to-trade/TimeframeSelector';\nimport { GridSettings } from './tap-to-trade/GridSettings';\nimport { TradeActionButtons } from './tap-to-trade/TradeActionButtons';\nimport { TradeInfoSection } from './tap-to-trade/TradeInfoSection';\n\ninterface TapToTradeProps {\n  onMobileClose?: () => void;\n}\n\nconst TapToTrade: React.FC<TapToTradeProps> = ({ onMobileClose }) => {\n  const { activeMarket, setActiveMarket, timeframe, setTimeframe, currentPrice } = useMarket();\n  const { usdcBalance, isLoadingBalance } = useUSDCBalance();\n  const { wallets } = useWallets();\n  const [leverage, setLeverage] = useState(10);\n  const [marginAmount, setMarginAmount] = useState<string>('');\n  const [isMarketSelectorOpen, setIsMarketSelectorOpen] = useState(false);\n  const [hasSelectedYGrid, setHasSelectedYGrid] = useState(false); // Track if user explicitly selected Y grid\n\n  // Approval hook for USDC (TapToTradeExecutor-specific)\n  const { approve: approveUSDC, allowance, isPending: isApprovalPending } = useTapToTradeApproval();\n\n  // Approval hook for USDC (OneTapProfit-specific)\n  const {\n    approve: approveOneTapProfit,\n    allowance: oneTapProfitAllowance,\n    isPending: isOneTapProfitApprovalPending,\n  } = useOneTapProfitApproval();\n\n  // Tap to Trade dari Context\n  const tapToTrade = useTapToTrade();\n\n  // Use trade mode from context\n  const tradeMode = tapToTrade.tradeMode;\n\n  const leverageMarkers = [1, 2, 5, 10, 25, 50, 100]; // Updated to match MarketOrder\n\n  // Check if we have large allowance (> $10,000) - memoized to prevent setState during render\n  const hasLargeAllowance = useMemo(() => {\n    return Boolean(allowance && allowance > parseUnits('10000', 6));\n  }, [allowance]);\n\n  // Check if OneTapProfit has large allowance\n  const hasLargeOneTapProfitAllowance = useMemo(() => {\n    return Boolean(oneTapProfitAllowance && oneTapProfitAllowance > parseUnits('10000', 6));\n  }, [oneTapProfitAllowance]);\n\n  // Handler for pre-approve USDC in large amount\n  const handlePreApprove = async () => {\n    try {\n      toast.loading('Approving unlimited USDC...', { id: 'pre-approve' });\n      // Approve 1 million USDC (enough for many trades)\n      const maxAmount = parseUnits('1000000', 6).toString();\n      await approveUSDC(maxAmount);\n      toast.success('Pre-approved! You can now trade without approval popups', {\n        id: 'pre-approve',\n        duration: 5000,\n      });\n    } catch (error) {\n      console.error('Pre-approve error:', error);\n      toast.error('Failed to approve USDC. Please try again.', {\n        id: 'pre-approve',\n      });\n    }\n  };\n\n  // Handler for pre-approve USDC for OneTapProfit\n  const handlePreApproveOneTapProfit = async () => {\n    try {\n      toast.loading('Approving unlimited USDC for Binary Trading...', {\n        id: 'binary-pre-approve',\n      });\n      // Approve 1 million USDC (enough for many bets)\n      const maxAmount = parseUnits('1000000', 6).toString();\n      await approveOneTapProfit(maxAmount);\n      toast.success('Pre-approved! You can now enable Binary Trading', {\n        id: 'binary-pre-approve',\n        duration: 5000,\n      });\n    } catch (error) {\n      console.error('OneTapProfit pre-approve error:', error);\n      toast.error('Failed to approve USDC. Please try again.', {\n        id: 'binary-pre-approve',\n      });\n    }\n  };\n\n  // Handler untuk mengganti market dan update chart\n  const handleMarketSelect = (market: Market) => {\n    setActiveMarket({ ...market, category: market.category || 'crypto' });\n    setIsMarketSelectorOpen(false);\n  };\n\n  const handleMarginInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    if (value === '' || /^\\d*\\.?\\d*$/.test(value)) {\n      setMarginAmount(value);\n      // Sync with context for OneTapProfit mode\n      if (tradeMode === 'one-tap-profit') {\n        tapToTrade.setBetAmount(value);\n      }\n    }\n  };\n\n  const handleMaxClick = () => {\n    setMarginAmount(usdcBalance);\n  };\n\n  const marginUsdValue = marginAmount ? parseFloat(marginAmount) : 0;\n\n  const selectedTimeframeLabel =\n    timeframe === '1'\n      ? '1m'\n      : timeframe === '5'\n      ? '5m'\n      : timeframe === '15'\n      ? '15m'\n      : timeframe === '30'\n      ? '30m'\n      : timeframe === '60'\n      ? '1H'\n      : timeframe === '240'\n      ? '4H'\n      : timeframe === 'D'\n      ? '1D'\n      : '1m';\n\n  return (\n    <div className=\"flex flex-col gap-3 px-4 py-4 bg-trading-bg h-full\">\n      {/* One Tap Profit Info Banner */}\n      {tradeMode === 'one-tap-profit' && (\n        <div className=\"bg-info/10 border border-info/50 rounded-lg p-3\">\n          <div className=\"flex items-start gap-2\">\n            <Info size={16} className=\"text-info flex-shrink-0 mt-0.5\" />\n            <div className=\"flex-1 space-y-1\">\n              <div className=\"text-xs font-semibold text-info\">One Tap Profit Mode</div>\n              <div className=\"text-xs text-info space-y-0.5\">\n                <div>• Chart updates in real-time per second</div>\n                <div>• Fixed grid: 10 seconds per X-axis</div>\n                <div>\n                  • Price grid: ${activeMarket?.symbol === 'SOL' ? '0.1' : '10'} per Y-axis\n                  increment\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Market Selector */}\n      <MarketSelector\n        value={activeMarket}\n        onSelect={handleMarketSelect}\n        disabled={tapToTrade.isEnabled && tradeMode === 'open-position'}\n      />\n\n      {/* Margin Input (USDC) */}\n      <CollateralInput\n        value={marginAmount}\n        onChange={handleMarginInputChange}\n        balance={usdcBalance}\n        isLoadingBalance={isLoadingBalance}\n        onMaxClick={handleMaxClick}\n        label={tradeMode === 'one-tap-profit' ? 'Bet Amount' : 'Margin'}\n        disabled={tapToTrade.isEnabled}\n      />\n\n      {/* Leverage Input - Hidden for One Tap Profit */}\n      {tradeMode !== 'one-tap-profit' && (\n        <LeverageSelector\n          leverage={leverage}\n          onLeverageChange={setLeverage}\n          disabled={tapToTrade.isEnabled}\n          markers={leverageMarkers}\n        />\n      )}\n\n      {/* Timeframe Selector - Only for Open Position mode */}\n      {tradeMode === 'open-position' && (\n        <TimeframeSelector\n          timeframe={timeframe}\n          setTimeframe={setTimeframe}\n          disabled={tapToTrade.isEnabled}\n        />\n      )}\n\n      {/* Grid Configuration - Only for Open Position mode */}\n      <GridSettings\n        tradeMode={tradeMode === 'open-position' ? 'open-position' : 'one-tap-profit'}\n        activeMarket={activeMarket}\n        timeframe={timeframe}\n        currentPrice={currentPrice}\n        setHasSelectedYGrid={setHasSelectedYGrid}\n      />\n\n      {/* Info Section */}\n      <TradeInfoSection\n        tradeMode={tradeMode === 'open-position' ? 'open-position' : 'one-tap-profit'}\n        activeMarket={activeMarket}\n        marginUsdValue={marginUsdValue}\n        leverage={leverage}\n        timeframe={timeframe}\n        selectedTimeframeLabel={selectedTimeframeLabel}\n        xCoordinate={tapToTrade.gridSizeX ? tapToTrade.gridSizeX.toString() : ''}\n        yCoordinate={tapToTrade.gridSizeY ? tapToTrade.gridSizeY.toString() : ''}\n      />\n\n      {/* Action Buttons - Now handles approval logic */}\n      <TradeActionButtons\n        tradeMode={tradeMode === 'open-position' ? 'open-position' : 'one-tap-profit'}\n        tapToTrade={tapToTrade}\n        activeMarket={activeMarket}\n        marginAmount={marginAmount}\n        leverage={leverage}\n        timeframe={timeframe}\n        currentPrice={currentPrice}\n        hasLargeAllowance={hasLargeAllowance}\n        hasLargeOneTapProfitAllowance={hasLargeOneTapProfitAllowance}\n        hasSelectedYGrid={hasSelectedYGrid}\n        wallets={wallets}\n        onPreApprove={handlePreApprove}\n        onPreApproveOneTapProfit={handlePreApproveOneTapProfit}\n        isApprovalPending={isApprovalPending}\n        isOneTapProfitApprovalPending={isOneTapProfitApprovalPending}\n        disabled={\n          tradeMode === 'one-tap-profit'\n            ? !marginAmount || !activeMarket\n            : !marginAmount || !leverage || !timeframe || !activeMarket || !hasSelectedYGrid\n        }\n        onMobileClose={onMobileClose}\n      />\n    </div>\n  );\n};\n\nexport default TapToTrade;\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA,2BAA2B;AAC3B;AACA;AACA;AAEA,qCAAqC;AACrC;AACA;AACA;AACA;AAtBA;;;;;;;;;;;;;;;;;;;AA4BA,MAAM,aAAwC,CAAC,EAAE,aAAa,EAAE;IAC9D,MAAM,EAAE,YAAY,EAAE,eAAe,EAAE,SAAS,EAAE,YAAY,EAAE,YAAY,EAAE,GAAG,IAAA,qKAAS;IAC1F,MAAM,EAAE,WAAW,EAAE,gBAAgB,EAAE,GAAG,IAAA,wJAAc;IACxD,MAAM,EAAE,OAAO,EAAE,GAAG,IAAA,iPAAU;IAC9B,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IACzC,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAS;IACzD,MAAM,CAAC,sBAAsB,wBAAwB,GAAG,IAAA,iNAAQ,EAAC;IACjE,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,iNAAQ,EAAC,QAAQ,2CAA2C;IAE5G,uDAAuD;IACvD,MAAM,EAAE,SAAS,WAAW,EAAE,SAAS,EAAE,WAAW,iBAAiB,EAAE,GAAG,IAAA,oLAAqB;IAE/F,iDAAiD;IACjD,MAAM,EACJ,SAAS,mBAAmB,EAC5B,WAAW,qBAAqB,EAChC,WAAW,6BAA6B,EACzC,GAAG,IAAA,wLAAuB;IAE3B,4BAA4B;IAC5B,MAAM,aAAa,IAAA,6KAAa;IAEhC,8BAA8B;IAC9B,MAAM,YAAY,WAAW,SAAS;IAEtC,MAAM,kBAAkB;QAAC;QAAG;QAAG;QAAG;QAAI;QAAI;QAAI;KAAI,EAAE,+BAA+B;IAEnF,4FAA4F;IAC5F,MAAM,oBAAoB,IAAA,gNAAO,EAAC;QAChC,OAAO,QAAQ,aAAa,YAAY,IAAA,yKAAU,EAAC,SAAS;IAC9D,GAAG;QAAC;KAAU;IAEd,4CAA4C;IAC5C,MAAM,gCAAgC,IAAA,gNAAO,EAAC;QAC5C,OAAO,QAAQ,yBAAyB,wBAAwB,IAAA,yKAAU,EAAC,SAAS;IACtF,GAAG;QAAC;KAAsB;IAE1B,+CAA+C;IAC/C,MAAM,mBAAmB;QACvB,IAAI;YACF,iJAAK,CAAC,OAAO,CAAC,+BAA+B;gBAAE,IAAI;YAAc;YACjE,kDAAkD;YAClD,MAAM,YAAY,IAAA,yKAAU,EAAC,WAAW,GAAG,QAAQ;YACnD,MAAM,YAAY;YAClB,iJAAK,CAAC,OAAO,CAAC,2DAA2D;gBACvE,IAAI;gBACJ,UAAU;YACZ;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,sBAAsB;YACpC,iJAAK,CAAC,KAAK,CAAC,6CAA6C;gBACvD,IAAI;YACN;QACF;IACF;IAEA,gDAAgD;IAChD,MAAM,+BAA+B;QACnC,IAAI;YACF,iJAAK,CAAC,OAAO,CAAC,kDAAkD;gBAC9D,IAAI;YACN;YACA,gDAAgD;YAChD,MAAM,YAAY,IAAA,yKAAU,EAAC,WAAW,GAAG,QAAQ;YACnD,MAAM,oBAAoB;YAC1B,iJAAK,CAAC,OAAO,CAAC,mDAAmD;gBAC/D,IAAI;gBACJ,UAAU;YACZ;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,mCAAmC;YACjD,iJAAK,CAAC,KAAK,CAAC,6CAA6C;gBACvD,IAAI;YACN;QACF;IACF;IAEA,kDAAkD;IAClD,MAAM,qBAAqB,CAAC;QAC1B,gBAAgB;YAAE,GAAG,MAAM;YAAE,UAAU,OAAO,QAAQ,IAAI;QAAS;QACnE,wBAAwB;IAC1B;IAEA,MAAM,0BAA0B,CAAC;QAC/B,MAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;QAC5B,IAAI,UAAU,MAAM,cAAc,IAAI,CAAC,QAAQ;YAC7C,gBAAgB;YAChB,0CAA0C;YAC1C,IAAI,cAAc,kBAAkB;gBAClC,WAAW,YAAY,CAAC;YAC1B;QACF;IACF;IAEA,MAAM,iBAAiB;QACrB,gBAAgB;IAClB;IAEA,MAAM,iBAAiB,eAAe,WAAW,gBAAgB;IAEjE,MAAM,yBACJ,cAAc,MACV,OACA,cAAc,MACd,OACA,cAAc,OACd,QACA,cAAc,OACd,QACA,cAAc,OACd,OACA,cAAc,QACd,OACA,cAAc,MACd,OACA;IAEN,qBACE,8OAAC;QAAI,WAAU;;YAEZ,cAAc,kCACb,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,0MAAI;4BAAC,MAAM;4BAAI,WAAU;;;;;;sCAC1B,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAI,WAAU;8CAAkC;;;;;;8CACjD,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;sDAAI;;;;;;sDACL,8OAAC;sDAAI;;;;;;sDACL,8OAAC;;gDAAI;gDACa,cAAc,WAAW,QAAQ,QAAQ;gDAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAU1E,8OAAC,uNAAc;gBACb,OAAO;gBACP,UAAU;gBACV,UAAU,WAAW,SAAS,IAAI,cAAc;;;;;;0BAIlD,8OAAC,yNAAe;gBACd,OAAO;gBACP,UAAU;gBACV,SAAS;gBACT,kBAAkB;gBAClB,YAAY;gBACZ,OAAO,cAAc,mBAAmB,eAAe;gBACvD,UAAU,WAAW,SAAS;;;;;;YAI/B,cAAc,kCACb,8OAAC,2NAAgB;gBACf,UAAU;gBACV,kBAAkB;gBAClB,UAAU,WAAW,SAAS;gBAC9B,SAAS;;;;;;YAKZ,cAAc,iCACb,8OAAC,qOAAiB;gBAChB,WAAW;gBACX,cAAc;gBACd,UAAU,WAAW,SAAS;;;;;;0BAKlC,8OAAC,2NAAY;gBACX,WAAW,cAAc,kBAAkB,kBAAkB;gBAC7D,cAAc;gBACd,WAAW;gBACX,cAAc;gBACd,qBAAqB;;;;;;0BAIvB,8OAAC,mOAAgB;gBACf,WAAW,cAAc,kBAAkB,kBAAkB;gBAC7D,cAAc;gBACd,gBAAgB;gBAChB,UAAU;gBACV,WAAW;gBACX,wBAAwB;gBACxB,aAAa,WAAW,SAAS,GAAG,WAAW,SAAS,CAAC,QAAQ,KAAK;gBACtE,aAAa,WAAW,SAAS,GAAG,WAAW,SAAS,CAAC,QAAQ,KAAK;;;;;;0BAIxE,8OAAC,uOAAkB;gBACjB,WAAW,cAAc,kBAAkB,kBAAkB;gBAC7D,YAAY;gBACZ,cAAc;gBACd,cAAc;gBACd,UAAU;gBACV,WAAW;gBACX,cAAc;gBACd,mBAAmB;gBACnB,+BAA+B;gBAC/B,kBAAkB;gBAClB,SAAS;gBACT,cAAc;gBACd,0BAA0B;gBAC1B,mBAAmB;gBACnB,+BAA+B;gBAC/B,UACE,cAAc,mBACV,CAAC,gBAAgB,CAAC,eAClB,CAAC,gBAAgB,CAAC,YAAY,CAAC,aAAa,CAAC,gBAAgB,CAAC;gBAEpE,eAAe;;;;;;;;;;;;AAIvB;uCAEe"}},
    {"offset": {"line": 9382, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/order-panel/SwapPanel.tsx"],"sourcesContent":["'use client';\nimport React, { useState, useMemo } from 'react';\nimport { ArrowDownUp, Settings, Info } from 'lucide-react';\nimport { usePrivy } from '@privy-io/react-auth';\nimport { useUSDCBalance } from '@/hooks/data/useUSDCBalance';\n\n// Mock exchange rate: 1 DASH = 0.1 USDC (or 1 USDC = 10 DASH)\nconst EXCHANGE_RATE = 10; // DASH per USDC\nconst SLIPPAGE = 0.5; // 0.5% slippage\nconst SWAP_FEE = 0.003; // 0.3% swap fee\n\ninterface Token {\n  symbol: string;\n  name: string;\n  logo: string;\n  balance?: string;\n}\n\nconst TOKENS: { [key: string]: Token } = {\n  USDC: {\n    symbol: 'USDC',\n    name: 'USD Coin',\n    logo: '/icons/usdc.png',\n  },\n  DASH: {\n    symbol: 'DASH',\n    name: 'Dash Token',\n    logo: '/dash-polos.png',\n  },\n};\n\nconst SwapPanel: React.FC = () => {\n  const { authenticated } = usePrivy();\n  const { usdcBalance, isLoadingBalance } = useUSDCBalance();\n\n  const [fromToken, setFromToken] = useState<Token>(TOKENS.USDC);\n  const [toToken, setToToken] = useState<Token>(TOKENS.DASH);\n  const [fromAmount, setFromAmount] = useState<string>('');\n  const [isSwapping, setIsSwapping] = useState(false);\n\n  // Calculate exchange amounts\n  const toAmount = useMemo(() => {\n    if (!fromAmount || parseFloat(fromAmount) === 0) return '';\n\n    const amount = parseFloat(fromAmount);\n    let result: number;\n\n    if (fromToken.symbol === 'USDC') {\n      // USDC to DASH\n      result = amount * EXCHANGE_RATE * (1 - SWAP_FEE);\n    } else {\n      // DASH to USDC\n      result = (amount / EXCHANGE_RATE) * (1 - SWAP_FEE);\n    }\n\n    return result.toFixed(6);\n  }, [fromAmount, fromToken.symbol]);\n\n  // Calculate price impact (mock)\n  const priceImpact = useMemo(() => {\n    if (!fromAmount || parseFloat(fromAmount) === 0) return '0.00';\n    const amount = parseFloat(fromAmount);\n    // Simple mock: larger trades have more impact\n    return Math.min(amount / 1000, 2).toFixed(2);\n  }, [fromAmount]);\n\n  // Calculate minimum received with slippage\n  const minimumReceived = useMemo(() => {\n    if (!toAmount) return '';\n    const amount = parseFloat(toAmount);\n    return (amount * (1 - SLIPPAGE / 100)).toFixed(6);\n  }, [toAmount]);\n\n  const handleFromAmountChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    if (value === '' || /^\\d*\\.?\\d*$/.test(value)) {\n      setFromAmount(value);\n    }\n  };\n\n  const handleMaxClick = () => {\n    if (fromToken.symbol === 'USDC') {\n      setFromAmount(usdcBalance);\n    } else {\n      // Mock TETHRA balance\n      setFromAmount('0');\n    }\n  };\n\n  const handleSwapTokens = () => {\n    // Swap the tokens\n    const temp = fromToken;\n    setFromToken(toToken);\n    setToToken(temp);\n\n    // Clear amounts\n    setFromAmount('');\n  };\n\n  const handleSwap = async () => {\n    if (!authenticated) return;\n\n    setIsSwapping(true);\n\n    // Mock swap execution\n    await new Promise((resolve) => setTimeout(resolve, 2000));\n\n    alert(`Swapped ${fromAmount} ${fromToken.symbol} for ${toAmount} ${toToken.symbol}`);\n\n    setIsSwapping(false);\n    setFromAmount('');\n  };\n\n  const formatPrice = (price: number) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 6,\n    }).format(price);\n  };\n\n  const isSwapDisabled =\n    !authenticated || !fromAmount || parseFloat(fromAmount) === 0 || isSwapping;\n\n  return (\n    <div className=\"flex flex-col gap-3 md:px-4 px-3 md:py-4 py-3 bg-[#0F1419]\">\n      {/* From Token */}\n      <div>\n        <div className=\"bg-[#1A2332] border border-[#2D3748] rounded-lg md:p-3 p-2\">\n          <div className=\"flex justify-between items-center mb-2\">\n            <label className=\"text-xs text-gray-400\">From</label>\n            <span className=\"text-xs text-gray-400\">\n              Balance:{' '}\n              {fromToken.symbol === 'USDC'\n                ? isLoadingBalance\n                  ? 'Loading...'\n                  : `${usdcBalance} ${fromToken.symbol}`\n                : '0.00 DASH'}\n            </span>\n          </div>\n\n          <div className=\"flex justify-between items-center mb-2 gap-2\">\n            <input\n              type=\"text\"\n              placeholder=\"0.0\"\n              value={fromAmount}\n              onChange={handleFromAmountChange}\n              className=\"bg-transparent text-2xl text-white outline-none flex-1 min-w-0\"\n            />\n            <div className=\"flex items-center gap-2 flex-shrink-0\">\n              <button\n                onClick={handleMaxClick}\n                className=\"bg-[#2D3748] px-2 py-0.5 rounded text-xs cursor-pointer hover:bg-[#3d4a5f] transition-colors\"\n              >\n                Max\n              </button>\n              <div className=\"flex items-center gap-1.5 bg-[#2D3748] rounded-lg px-2.5 py-1.5 cursor-pointer hover:bg-[#3d4a5f] transition-colors\">\n                <img\n                  src={fromToken.logo}\n                  alt={fromToken.symbol}\n                  className=\"w-5 h-5 rounded-full flex-shrink-0\"\n                  onError={(e) => {\n                    const target = e.currentTarget;\n                    target.style.display = 'none';\n                  }}\n                />\n                <span className=\"font-medium text-white text-sm whitespace-nowrap\">\n                  {fromToken.symbol}\n                </span>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"text-xs text-gray-500\">\n            {fromAmount && parseFloat(fromAmount) > 0\n              ? fromToken.symbol === 'USDC'\n                ? formatPrice(parseFloat(fromAmount))\n                : formatPrice(parseFloat(fromAmount) / EXCHANGE_RATE)\n              : '$0.00'}\n          </div>\n        </div>\n      </div>\n\n      {/* Swap Button */}\n      <div className=\"flex justify-center -my-1 relative z-10\">\n        <button\n          onClick={handleSwapTokens}\n          className=\"bg-[#1A2332] border-2 border-[#2D3748] rounded-lg p-2 hover:bg-[#2D3748] transition-colors cursor-pointer\"\n        >\n          <ArrowDownUp size={20} className=\"text-blue-300\" />\n        </button>\n      </div>\n\n      {/* To Token */}\n      <div>\n        <div className=\"bg-[#1A2332] border border-[#2D3748] rounded-lg md:p-3 p-2\">\n          <div className=\"flex justify-between items-center mb-2\">\n            <label className=\"text-xs text-gray-400\">To</label>\n            <span className=\"text-xs text-gray-400\">\n              Balance:{' '}\n              {toToken.symbol === 'USDC'\n                ? isLoadingBalance\n                  ? 'Loading...'\n                  : `${usdcBalance} ${toToken.symbol}`\n                : '0.00 DASH'}\n            </span>\n          </div>\n\n          <div className=\"flex justify-between items-center mb-2 gap-2\">\n            <input\n              type=\"text\"\n              placeholder=\"0.0\"\n              value={toAmount}\n              readOnly\n              className=\"bg-transparent text-2xl text-white outline-none flex-1 min-w-0\"\n            />\n            <div className=\"flex items-center gap-1.5 bg-[#2D3748] rounded-lg px-2.5 py-1.5 flex-shrink-0\">\n              <img\n                src={toToken.logo}\n                alt={toToken.symbol}\n                className=\"w-5 h-5 rounded-full flex-shrink-0\"\n                onError={(e) => {\n                  const target = e.currentTarget;\n                  target.style.display = 'none';\n                }}\n              />\n              <span className=\"font-medium text-white text-sm whitespace-nowrap\">\n                {toToken.symbol}\n              </span>\n            </div>\n          </div>\n\n          <div className=\"text-xs text-gray-500\">\n            {toAmount && parseFloat(toAmount) > 0\n              ? toToken.symbol === 'USDC'\n                ? formatPrice(parseFloat(toAmount))\n                : formatPrice(parseFloat(toAmount) / EXCHANGE_RATE)\n              : '$0.00'}\n          </div>\n        </div>\n      </div>\n\n      {/* Exchange Rate Info */}\n      {fromAmount && parseFloat(fromAmount) > 0 && (\n        <div className=\"bg-[#1A2332] rounded-lg p-3\">\n          <div className=\"flex items-center justify-between text-xs mb-2\">\n            <span className=\"text-gray-400\">Rate</span>\n            <span className=\"text-white font-medium\">\n              1 {fromToken.symbol === 'USDC' ? 'USDC' : 'DASH'} ={' '}\n              {fromToken.symbol === 'USDC'\n                ? `${EXCHANGE_RATE} DASH`\n                : `${(1 / EXCHANGE_RATE).toFixed(2)} USDC`}\n            </span>\n          </div>\n          <div className=\"flex items-center justify-between text-xs mb-2\">\n            <div className=\"flex items-center gap-1\">\n              <span className=\"text-gray-400\">Minimum Received</span>\n              <Info size={12} className=\"text-gray-500\" />\n            </div>\n            <span className=\"text-white\">\n              {minimumReceived} {toToken.symbol}\n            </span>\n          </div>\n          <div className=\"flex items-center justify-between text-xs mb-2\">\n            <span className=\"text-gray-400\">Price Impact</span>\n            <span className={`${parseFloat(priceImpact) > 1 ? 'text-red-400' : 'text-green-400'}`}>\n              {priceImpact}%\n            </span>\n          </div>\n          <div className=\"flex items-center justify-between text-xs\">\n            <span className=\"text-gray-400\">Swap Fee</span>\n            <span className=\"text-white\">{(SWAP_FEE * 100).toFixed(2)}%</span>\n          </div>\n        </div>\n      )}\n\n      {/* Swap Button */}\n      <button\n        onClick={handleSwap}\n        disabled={isSwapDisabled}\n        className={`w-full py-4 rounded-lg font-bold text-white transition-all duration-200 ${isSwapDisabled\n            ? 'bg-gray-600 cursor-not-allowed opacity-50'\n            : 'bg-blue-400 hover:bg-blue-500 cursor-pointer'\n          }`}\n      >\n        {!authenticated\n          ? 'Connect Wallet'\n          : isSwapping\n            ? 'Swapping...'\n            : !fromAmount || parseFloat(fromAmount) === 0\n              ? 'Enter Amount'\n              : `Swap ${fromToken.symbol} for ${toToken.symbol}`}\n      </button>\n\n      {/* Additional Info */}\n      <div className=\"space-y-2 text-sm border-t border-[#1A202C] pt-3\">\n        <div className=\"flex justify-between\">\n          <span className=\"text-gray-400\">Network</span>\n          <span className=\"text-white\">Base Sepolia</span>\n        </div>\n        <div className=\"flex justify-between\">\n          <span className=\"text-gray-400\">Slippage Tolerance</span>\n          <span className=\"text-white\">{SLIPPAGE}%</span>\n        </div>\n      </div>\n\n      {/* Mock Warning */}\n      <div className=\"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-3\">\n        <div className=\"flex items-start gap-2\">\n          <Info size={16} className=\"text-yellow-400 mt-0.5 flex-shrink-0\" />\n          <div>\n            <p className=\"text-xs text-yellow-400 font-medium mb-1\">Mock Interface</p>\n            <p className=\"text-xs text-gray-400\">\n              This is a mockup interface. No actual swap will occur.\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SwapPanel;\n"],"names":[],"mappings":";;;;;AACA;AACA;AAAA;AACA;AACA;AAJA;;;;;;AAMA,8DAA8D;AAC9D,MAAM,gBAAgB,IAAI,gBAAgB;AAC1C,MAAM,WAAW,KAAK,gBAAgB;AACtC,MAAM,WAAW,OAAO,gBAAgB;AASxC,MAAM,SAAmC;IACvC,MAAM;QACJ,QAAQ;QACR,MAAM;QACN,MAAM;IACR;IACA,MAAM;QACJ,QAAQ;QACR,MAAM;QACN,MAAM;IACR;AACF;AAEA,MAAM,YAAsB;IAC1B,MAAM,EAAE,aAAa,EAAE,GAAG,IAAA,mOAAQ;IAClC,MAAM,EAAE,WAAW,EAAE,gBAAgB,EAAE,GAAG,IAAA,wJAAc;IAExD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAQ,OAAO,IAAI;IAC7D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAQ,OAAO,IAAI;IACzD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAS;IACrD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAE7C,6BAA6B;IAC7B,MAAM,WAAW,IAAA,gNAAO,EAAC;QACvB,IAAI,CAAC,cAAc,WAAW,gBAAgB,GAAG,OAAO;QAExD,MAAM,SAAS,WAAW;QAC1B,IAAI;QAEJ,IAAI,UAAU,MAAM,KAAK,QAAQ;YAC/B,eAAe;YACf,SAAS,SAAS,gBAAgB,CAAC,IAAI,QAAQ;QACjD,OAAO;YACL,eAAe;YACf,SAAS,AAAC,SAAS,gBAAiB,CAAC,IAAI,QAAQ;QACnD;QAEA,OAAO,OAAO,OAAO,CAAC;IACxB,GAAG;QAAC;QAAY,UAAU,MAAM;KAAC;IAEjC,gCAAgC;IAChC,MAAM,cAAc,IAAA,gNAAO,EAAC;QAC1B,IAAI,CAAC,cAAc,WAAW,gBAAgB,GAAG,OAAO;QACxD,MAAM,SAAS,WAAW;QAC1B,8CAA8C;QAC9C,OAAO,KAAK,GAAG,CAAC,SAAS,MAAM,GAAG,OAAO,CAAC;IAC5C,GAAG;QAAC;KAAW;IAEf,2CAA2C;IAC3C,MAAM,kBAAkB,IAAA,gNAAO,EAAC;QAC9B,IAAI,CAAC,UAAU,OAAO;QACtB,MAAM,SAAS,WAAW;QAC1B,OAAO,CAAC,SAAS,CAAC,IAAI,WAAW,GAAG,CAAC,EAAE,OAAO,CAAC;IACjD,GAAG;QAAC;KAAS;IAEb,MAAM,yBAAyB,CAAC;QAC9B,MAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;QAC5B,IAAI,UAAU,MAAM,cAAc,IAAI,CAAC,QAAQ;YAC7C,cAAc;QAChB;IACF;IAEA,MAAM,iBAAiB;QACrB,IAAI,UAAU,MAAM,KAAK,QAAQ;YAC/B,cAAc;QAChB,OAAO;YACL,sBAAsB;YACtB,cAAc;QAChB;IACF;IAEA,MAAM,mBAAmB;QACvB,kBAAkB;QAClB,MAAM,OAAO;QACb,aAAa;QACb,WAAW;QAEX,gBAAgB;QAChB,cAAc;IAChB;IAEA,MAAM,aAAa;QACjB,IAAI,CAAC,eAAe;QAEpB,cAAc;QAEd,sBAAsB;QACtB,MAAM,IAAI,QAAQ,CAAC,UAAY,WAAW,SAAS;QAEnD,MAAM,CAAC,QAAQ,EAAE,WAAW,CAAC,EAAE,UAAU,MAAM,CAAC,KAAK,EAAE,SAAS,CAAC,EAAE,QAAQ,MAAM,EAAE;QAEnF,cAAc;QACd,cAAc;IAChB;IAEA,MAAM,cAAc,CAAC;QACnB,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;YACpC,OAAO;YACP,UAAU;YACV,uBAAuB;YACvB,uBAAuB;QACzB,GAAG,MAAM,CAAC;IACZ;IAEA,MAAM,iBACJ,CAAC,iBAAiB,CAAC,cAAc,WAAW,gBAAgB,KAAK;IAEnE,qBACE,8OAAC;QAAI,WAAU;;0BAEb,8OAAC;0BACC,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAM,WAAU;8CAAwB;;;;;;8CACzC,8OAAC;oCAAK,WAAU;;wCAAwB;wCAC7B;wCACR,UAAU,MAAM,KAAK,SAClB,mBACE,eACA,GAAG,YAAY,CAAC,EAAE,UAAU,MAAM,EAAE,GACtC;;;;;;;;;;;;;sCAIR,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCACC,MAAK;oCACL,aAAY;oCACZ,OAAO;oCACP,UAAU;oCACV,WAAU;;;;;;8CAEZ,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CACC,SAAS;4CACT,WAAU;sDACX;;;;;;sDAGD,8OAAC;4CAAI,WAAU;;8DACb,8OAAC;oDACC,KAAK,UAAU,IAAI;oDACnB,KAAK,UAAU,MAAM;oDACrB,WAAU;oDACV,SAAS,CAAC;wDACR,MAAM,SAAS,EAAE,aAAa;wDAC9B,OAAO,KAAK,CAAC,OAAO,GAAG;oDACzB;;;;;;8DAEF,8OAAC;oDAAK,WAAU;8DACb,UAAU,MAAM;;;;;;;;;;;;;;;;;;;;;;;;sCAMzB,8OAAC;4BAAI,WAAU;sCACZ,cAAc,WAAW,cAAc,IACpC,UAAU,MAAM,KAAK,SACnB,YAAY,WAAW,eACvB,YAAY,WAAW,cAAc,iBACvC;;;;;;;;;;;;;;;;;0BAMV,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBACC,SAAS;oBACT,WAAU;8BAEV,cAAA,8OAAC,uOAAW;wBAAC,MAAM;wBAAI,WAAU;;;;;;;;;;;;;;;;0BAKrC,8OAAC;0BACC,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAM,WAAU;8CAAwB;;;;;;8CACzC,8OAAC;oCAAK,WAAU;;wCAAwB;wCAC7B;wCACR,QAAQ,MAAM,KAAK,SAChB,mBACE,eACA,GAAG,YAAY,CAAC,EAAE,QAAQ,MAAM,EAAE,GACpC;;;;;;;;;;;;;sCAIR,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCACC,MAAK;oCACL,aAAY;oCACZ,OAAO;oCACP,QAAQ;oCACR,WAAU;;;;;;8CAEZ,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CACC,KAAK,QAAQ,IAAI;4CACjB,KAAK,QAAQ,MAAM;4CACnB,WAAU;4CACV,SAAS,CAAC;gDACR,MAAM,SAAS,EAAE,aAAa;gDAC9B,OAAO,KAAK,CAAC,OAAO,GAAG;4CACzB;;;;;;sDAEF,8OAAC;4CAAK,WAAU;sDACb,QAAQ,MAAM;;;;;;;;;;;;;;;;;;sCAKrB,8OAAC;4BAAI,WAAU;sCACZ,YAAY,WAAW,YAAY,IAChC,QAAQ,MAAM,KAAK,SACjB,YAAY,WAAW,aACvB,YAAY,WAAW,YAAY,iBACrC;;;;;;;;;;;;;;;;;YAMT,cAAc,WAAW,cAAc,mBACtC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAK,WAAU;0CAAgB;;;;;;0CAChC,8OAAC;gCAAK,WAAU;;oCAAyB;oCACpC,UAAU,MAAM,KAAK,SAAS,SAAS;oCAAO;oCAAG;oCACnD,UAAU,MAAM,KAAK,SAClB,GAAG,cAAc,KAAK,CAAC,GACvB,GAAG,CAAC,IAAI,aAAa,EAAE,OAAO,CAAC,GAAG,KAAK,CAAC;;;;;;;;;;;;;kCAGhD,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAK,WAAU;kDAAgB;;;;;;kDAChC,8OAAC,0MAAI;wCAAC,MAAM;wCAAI,WAAU;;;;;;;;;;;;0CAE5B,8OAAC;gCAAK,WAAU;;oCACb;oCAAgB;oCAAE,QAAQ,MAAM;;;;;;;;;;;;;kCAGrC,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAK,WAAU;0CAAgB;;;;;;0CAChC,8OAAC;gCAAK,WAAW,GAAG,WAAW,eAAe,IAAI,iBAAiB,kBAAkB;;oCAClF;oCAAY;;;;;;;;;;;;;kCAGjB,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAK,WAAU;0CAAgB;;;;;;0CAChC,8OAAC;gCAAK,WAAU;;oCAAc,CAAC,WAAW,GAAG,EAAE,OAAO,CAAC;oCAAG;;;;;;;;;;;;;;;;;;;0BAMhE,8OAAC;gBACC,SAAS;gBACT,UAAU;gBACV,WAAW,CAAC,wEAAwE,EAAE,iBAChF,8CACA,gDACF;0BAEH,CAAC,gBACE,mBACA,aACE,gBACA,CAAC,cAAc,WAAW,gBAAgB,IACxC,iBACA,CAAC,KAAK,EAAE,UAAU,MAAM,CAAC,KAAK,EAAE,QAAQ,MAAM,EAAE;;;;;;0BAI1D,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAK,WAAU;0CAAgB;;;;;;0CAChC,8OAAC;gCAAK,WAAU;0CAAa;;;;;;;;;;;;kCAE/B,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAK,WAAU;0CAAgB;;;;;;0CAChC,8OAAC;gCAAK,WAAU;;oCAAc;oCAAS;;;;;;;;;;;;;;;;;;;0BAK3C,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,0MAAI;4BAAC,MAAM;4BAAI,WAAU;;;;;;sCAC1B,8OAAC;;8CACC,8OAAC;oCAAE,WAAU;8CAA2C;;;;;;8CACxD,8OAAC;oCAAE,WAAU;8CAAwB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQjD;uCAEe"}},
    {"offset": {"line": 10017, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/OrderPanel.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState } from 'react';\nimport { TrendingUp, TrendingDown, Zap } from 'lucide-react';\nimport MarketOrder from './order-panel/MarketOrder';\nimport LimitOrder from './order-panel/LimitOrder';\nimport TapToTrade from './order-panel/TaptoTrade';\nimport SwapPanel from './order-panel/SwapPanel';\nimport { useTapToTrade } from '@/features/trading/contexts/TapToTradeContext';\nimport WalletConnectButton from '@/components/layout/WalletConnectButton';\nimport { Tabs, TabsList, TabsTrigger } from '@/components/ui/tabs';\n\ninterface OrderPanelProps {\n  mobileActiveTab?: 'long' | 'short' | 'swap';\n  mode?: 'market' | 'trade'; // 'market' = Market/Limit only, 'trade' = Tap-to-Trade only\n  onMobileClose?: () => void;\n}\n\nconst OrderPanel: React.FC<OrderPanelProps> = ({\n  mobileActiveTab,\n  mode = 'market',\n  onMobileClose,\n}) => {\n  const [activeTab, setActiveTab] = useState<'long' | 'short' | 'swap'>(mobileActiveTab || 'short');\n  const [activeOrderType, setActiveOrderType] = useState<\n    'market' | 'limit' | 'Tap to Trade' | 'more'\n  >(mode === 'trade' ? 'Tap to Trade' : 'market');\n\n  // Sync with mobile tab if provided\n  React.useEffect(() => {\n    if (mobileActiveTab) {\n      setActiveTab(mobileActiveTab);\n    }\n  }, [mobileActiveTab]);\n\n  const { isEnabled: tapToTradeEnabled, tradeMode, setTradeMode } = useTapToTrade();\n\n  const tabs = [\n    {\n      key: 'long' as const,\n      label: 'Long',\n      icon: <TrendingUp size={16} />,\n      activeClass:\n        'bg-long/15 border-b-2 border-long shadow-[inset_0_0_20px_rgba(22,199,132,0.3),0_0_10px_rgba(22,199,132,0.3)]',\n      textClass: 'text-long',\n    },\n    {\n      key: 'short' as const,\n      label: 'Short',\n      icon: <TrendingDown size={16} />,\n      activeClass:\n        'bg-short/15 border-b-2 border-short shadow-[inset_0_0_20px_rgba(234,57,67,0.3),0_0_10px_rgba(234,57,67,0.3)]',\n      textClass: 'text-short',\n    },\n    {\n      key: 'swap' as const,\n      label: 'Swap',\n      icon: <Zap size={16} />,\n      activeClass:\n        'bg-swap/15 border-b-2 border-swap shadow-[inset_0_0_20px_rgba(37,99,235,0.3),0_0_10px_rgba(37,99,235,0.3)]',\n      textClass: 'text-swap',\n    },\n  ];\n\n  const isTabDisabled = tapToTradeEnabled || activeOrderType === 'Tap to Trade';\n\n  return (\n    <div className=\"h-full flex flex-col text-text-primary relative overflow-hidden md:rounded-lg\">\n      {/* Wallet Connect Header - Hidden on Mobile and when TapToTrade is active */}\n      {!tapToTradeEnabled && (\n        <div className=\"md:flex hidden items-center justify-end p-2.5 usd bg-trading-dark flex-shrink-0 md:rounded-t-lg\">\n          <WalletConnectButton />\n        </div>\n      )}\n\n      {/* Order Panel */}\n      <div className=\"flex-1 flex flex-col bg-trading-bg overflow-hidden md:rounded-b-lg\">\n        {/* Tab Buttons */}\n        <div className=\"flex border-b border-border-muted bg-trading-bg\">\n          {tabs.map((tab) => (\n            <button\n              key={tab.key}\n              onClick={() => !isTabDisabled && setActiveTab(tab.key)}\n              disabled={isTabDisabled}\n              className={`\n                flex-1 py-4 text-sm font-bold transition-all duration-200 relative\n                ${isTabDisabled ? 'cursor-not-allowed opacity-30' : 'cursor-pointer'}\n                ${\n                  activeTab === tab.key && !isTabDisabled\n                    ? `text-text-primary ${tab.activeClass}`\n                    : isTabDisabled\n                    ? 'hidden'\n                    : 'text-text-secondary hover:text-text-primary border-b-2 border-transparent'\n                }\n              `}\n            >\n              <div className=\"flex items-center justify-center gap-2\">\n                {tab.icon}\n                {tab.label}\n              </div>\n            </button>\n          ))}\n        </div>\n\n        {/* Order Type Selector - Full Width Tabs */}\n        <div className=\"px-4 py-3 border-b border-border-muted bg-trading-bg\">\n          {mode === 'trade' ? (\n            // Trade mode: Open Position / One Tap Profit\n            <Tabs\n              value={tradeMode}\n              onValueChange={(value) => {\n                if (tapToTradeEnabled) return; // Double check protection\n                setActiveOrderType('Tap to Trade');\n                setTradeMode(value as 'open-position' | 'one-tap-profit');\n              }}\n              className=\"w-full\"\n            >\n              <TabsList className=\"grid w-full grid-cols-2 h-10 bg-gradient-to-r from-info/20 to-success/20 p-1\">\n                <TabsTrigger\n                  value=\"one-tap-profit\"\n                  disabled={activeTab === 'swap' || tapToTradeEnabled}\n                  className=\"data-[state=active]:bg-gradient-to-r data-[state=active]:from-success data-[state=active]:to-success-dark data-[state=active]:text-white data-[state=active]:shadow-lg\"\n                >\n                  One Tap Profit\n                </TabsTrigger>\n                <TabsTrigger\n                  value=\"open-position\"\n                  disabled={activeTab === 'swap' || tapToTradeEnabled}\n                  className=\"data-[state=active]:bg-gradient-to-r data-[state=active]:from-info data-[state=active]:to-info-dark data-[state=active]:text-white data-[state=active]:shadow-lg\"\n                >\n                  Open Position\n                </TabsTrigger>\n              </TabsList>\n            </Tabs>\n          ) : (\n            // Market mode: Market / Limit\n            <Tabs\n              value={activeOrderType}\n              onValueChange={(value) => setActiveOrderType(value as 'market' | 'limit')}\n              className=\"w-full\"\n            >\n              <TabsList className=\"grid w-full grid-cols-2 h-10 bg-gradient-to-r from-long/20 to-swap/20 p-1\">\n                <TabsTrigger\n                  value=\"market\"\n                  disabled={activeTab === 'swap'}\n                  className=\"data-[state=active]:bg-gradient-to-r data-[state=active]:from-long data-[state=active]:to-long-hover data-[state=active]:text-white data-[state=active]:shadow-lg\"\n                >\n                  Market\n                </TabsTrigger>\n                <TabsTrigger\n                  value=\"limit\"\n                  disabled={activeTab === 'swap'}\n                  className=\"data-[state=active]:bg-gradient-to-r data-[state=active]:from-swap data-[state=active]:to-swap-hover data-[state=active]:text-white data-[state=active]:shadow-lg\"\n                >\n                  Limit\n                </TabsTrigger>\n              </TabsList>\n            </Tabs>\n          )}\n        </div>\n\n        {/* Content Area */}\n        <div className=\"flex-1 overflow-y-auto custom-scrollbar-dark relative\">\n          {activeTab === 'swap' ? (\n            <SwapPanel />\n          ) : (\n            <>\n              {activeOrderType === 'market' && <MarketOrder activeTab={activeTab} />}\n              {activeOrderType === 'limit' && <LimitOrder activeTab={activeTab} />}\n              {activeOrderType === 'Tap to Trade' && (\n                <div className=\"relative min-h-full\">\n                  <TapToTrade onMobileClose={onMobileClose} />\n                </div>\n              )}\n              {activeOrderType === 'more' && (\n                <div className=\"text-center py-8 text-text-secondary\">\n                  <p>More order types coming soon...</p>\n                </div>\n              )}\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default OrderPanel;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 10310, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/hooks/useGaslessClose.ts"],"sourcesContent":["/**\n * HACKATHON MODE: Gasless close position via backend\n * Backend relayer pays gas, no user signature needed\n */\n\nimport { useState, useCallback } from 'react';\nimport { useEmbeddedWallet } from '@/features/wallet/hooks/useEmbeddedWallet';\nimport { toast } from 'sonner';\n\nconst BACKEND_URL = process.env.NEXT_PUBLIC_BACKEND_URL || 'http://localhost:3001';\n\nexport interface GaslessCloseParams {\n  positionId: bigint;\n  symbol: string;\n}\n\nexport function useGaslessClose() {\n  const { address } = useEmbeddedWallet();\n  const [isPending, setIsPending] = useState(false);\n  const [txHash, setTxHash] = useState<string | undefined>();\n  const [error, setError] = useState<Error | null>(null);\n\n  const closePosition = useCallback(\n    async (params: GaslessCloseParams) => {\n      try {\n        setIsPending(true);\n        setError(null);\n        setTxHash(undefined);\n\n        if (!address) {\n          throw new Error('Wallet not connected');\n        }\n\n        // Call backend endpoint\n        const response = await fetch(`${BACKEND_URL}/api/relay/close-position`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            userAddress: address,\n            positionId: params.positionId.toString(),\n            symbol: params.symbol,\n          }),\n        });\n\n        const result = await response.json();\n\n        if (!response.ok || !result.success) {\n          throw new Error(result.error || result.message || 'Failed to close position');\n        }\n\n        const hash = result.data.txHash;\n        setTxHash(hash);\n\n        toast.success(`Position closed! TX: ${hash.slice(0, 10)}...`, {\n          duration: 5000,\n        });\n\n        return hash;\n      } catch (err) {\n        console.error('❌ Error closing position gaslessly:', err);\n        setError(err as Error);\n\n        const errorMsg = (err as Error).message || 'Unknown error';\n        toast.error(`Failed to close: ${errorMsg}`, {\n          duration: 7000,\n        });\n\n        throw err;\n      } finally {\n        setIsPending(false);\n      }\n    },\n    [address],\n  );\n\n  return {\n    closePosition,\n    isPending,\n    txHash,\n    error,\n  };\n}\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AAED;AACA;AACA;;;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,uBAAuB,IAAI;AAOpD,SAAS;IACd,MAAM,EAAE,OAAO,EAAE,GAAG,IAAA,4KAAiB;IACrC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ;IACpC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAe;IAEjD,MAAM,gBAAgB,IAAA,oNAAW,EAC/B,OAAO;QACL,IAAI;YACF,aAAa;YACb,SAAS;YACT,UAAU;YAEV,IAAI,CAAC,SAAS;gBACZ,MAAM,IAAI,MAAM;YAClB;YAEA,wBAAwB;YACxB,MAAM,WAAW,MAAM,MAAM,GAAG,YAAY,yBAAyB,CAAC,EAAE;gBACtE,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,MAAM,KAAK,SAAS,CAAC;oBACnB,aAAa;oBACb,YAAY,OAAO,UAAU,CAAC,QAAQ;oBACtC,QAAQ,OAAO,MAAM;gBACvB;YACF;YAEA,MAAM,SAAS,MAAM,SAAS,IAAI;YAElC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,OAAO,OAAO,EAAE;gBACnC,MAAM,IAAI,MAAM,OAAO,KAAK,IAAI,OAAO,OAAO,IAAI;YACpD;YAEA,MAAM,OAAO,OAAO,IAAI,CAAC,MAAM;YAC/B,UAAU;YAEV,iJAAK,CAAC,OAAO,CAAC,CAAC,qBAAqB,EAAE,KAAK,KAAK,CAAC,GAAG,IAAI,GAAG,CAAC,EAAE;gBAC5D,UAAU;YACZ;YAEA,OAAO;QACT,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,uCAAuC;YACrD,SAAS;YAET,MAAM,WAAW,AAAC,IAAc,OAAO,IAAI;YAC3C,iJAAK,CAAC,KAAK,CAAC,CAAC,iBAAiB,EAAE,UAAU,EAAE;gBAC1C,UAAU;YACZ;YAEA,MAAM;QACR,SAAU;YACR,aAAa;QACf;IACF,GACA;QAAC;KAAQ;IAGX,OAAO;QACL;QACA;QACA;QACA;IACF;AACF"}},
    {"offset": {"line": 10384, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/modals/TPSLModal.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { X } from 'lucide-react';\nimport { useTPSL, TPSLConfig } from '@/features/trading/hooks/useTPSL';\nimport { usePrice } from '@/hooks/data/usePrices';\n\ninterface TPSLModalProps {\n  isOpen: boolean;\n  onClose: (refresh: boolean) => void;\n  positionId: number;\n  trader: string;\n  symbol: string;\n  entryPrice: number;\n  isLong: boolean;\n}\n\nconst TPSLModal: React.FC<TPSLModalProps> = ({\n  isOpen,\n  onClose,\n  positionId,\n  trader,\n  symbol,\n  entryPrice,\n  isLong,\n}) => {\n  const [takeProfitPrice, setTakeProfitPrice] = useState<string>('');\n  const [stopLossPrice, setStopLossPrice] = useState<string>('');\n  const [takeProfitError, setTakeProfitError] = useState<string>('');\n  const [stopLossError, setStopLossError] = useState<string>('');\n  const { setTPSL, getTPSL, deleteTPSL, isPending } = useTPSL();\n\n  // Fetch real-time price from backend\n  const { price: priceData } = usePrice(symbol);\n  const currentPrice = priceData?.price || entryPrice; // Fallback to entry if no price\n\n  // Load existing TP/SL on mount\n  useEffect(() => {\n    if (isOpen) {\n      loadExistingTPSL();\n    }\n  }, [isOpen, positionId]);\n\n  const loadExistingTPSL = async () => {\n    const config = await getTPSL(positionId);\n    if (config) {\n      // Convert from 8 decimals to readable price\n      if (config.takeProfit) {\n        const tpPrice = parseFloat(config.takeProfit) / 100000000;\n        setTakeProfitPrice(tpPrice.toString());\n      }\n      if (config.stopLoss) {\n        const slPrice = parseFloat(config.stopLoss) / 100000000;\n        setStopLossPrice(slPrice.toString());\n      }\n    }\n  };\n\n  // Validate TP/SL prices - use CURRENT price, not entry price\n  const validatePrices = (): boolean => {\n    let isValid = true;\n    setTakeProfitError('');\n    setStopLossError('');\n\n    if (takeProfitPrice) {\n      const tp = parseFloat(takeProfitPrice);\n      if (isNaN(tp) || tp <= 0) {\n        setTakeProfitError('Invalid price');\n        isValid = false;\n      } else if (isLong && tp <= currentPrice) {\n        setTakeProfitError('TP must be above current price for Long');\n        isValid = false;\n      } else if (!isLong && tp >= currentPrice) {\n        setTakeProfitError('TP must be below current price for Short');\n        isValid = false;\n      }\n    }\n\n    if (stopLossPrice) {\n      const sl = parseFloat(stopLossPrice);\n      if (isNaN(sl) || sl <= 0) {\n        setStopLossError('Invalid price');\n        isValid = false;\n      } else if (isLong && sl >= currentPrice) {\n        setStopLossError('SL must be below current price for Long');\n        isValid = false;\n      } else if (!isLong && sl <= currentPrice) {\n        setStopLossError('SL must be above current price for Short');\n        isValid = false;\n      }\n      // SL+ is allowed: SL can be above entry (for profit lock) as long as below current\n    }\n\n    if (!takeProfitPrice && !stopLossPrice) {\n      setTakeProfitError('At least one of TP or SL required');\n      isValid = false;\n    }\n\n    return isValid;\n  };\n\n  const handleSave = async () => {\n    if (!validatePrices()) return;\n\n    const success = await setTPSL({\n      positionId,\n      trader,\n      takeProfit: takeProfitPrice || undefined,\n      stopLoss: stopLossPrice || undefined,\n    });\n\n    if (success) {\n      onClose(true);\n    }\n  };\n\n  const handleDelete = async () => {\n    const success = await deleteTPSL(positionId, trader);\n    if (success) {\n      setTakeProfitPrice('');\n      setStopLossPrice('');\n      onClose(true);\n    }\n  };\n\n  const calculatePnL = (targetPrice: number) => {\n    if (!targetPrice || targetPrice <= 0) return { pnl: 0, percentage: 0 };\n\n    const priceDiff = isLong ? targetPrice - entryPrice : entryPrice - targetPrice;\n    const percentage = (priceDiff / entryPrice) * 100;\n\n    return { percentage };\n  };\n\n  if (!isOpen) return null;\n\n  const tpPnL = calculatePnL(parseFloat(takeProfitPrice));\n  const slPnL = calculatePnL(parseFloat(stopLossPrice));\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm\">\n      <div className=\"bg-[#0F1419] border border-gray-700 rounded-lg shadow-2xl w-full max-w-md mx-4\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-4 border-b border-gray-700\">\n          <div>\n            <h3 className=\"text-lg font-semibold text-white\">Set TP/SL</h3>\n            <p className=\"text-sm text-gray-400\">\n              {symbol}/USD • {isLong ? 'Long' : 'Short'} • Entry: ${entryPrice.toFixed(2)}\n            </p>\n          </div>\n          <button\n            onClick={() => onClose(false)}\n            className=\"text-gray-400 hover:text-white transition-colors\"\n          >\n            <X size={20} />\n          </button>\n        </div>\n\n        {/* Body */}\n        <div className=\"p-4 space-y-4\">\n          {/* Current Price Info */}\n          <div className=\"bg-gray-800/50 rounded-lg p-3\">\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-sm text-gray-400\">Current Price</span>\n              <span className=\"text-white font-medium\">${currentPrice.toFixed(2)}</span>\n            </div>\n          </div>\n\n          {/* Take Profit */}\n          <div>\n            <label className=\"block text-sm text-gray-400 mb-2\">Take Profit Price</label>\n            <div className=\"relative\">\n              <input\n                type=\"number\"\n                step=\"0.01\"\n                placeholder={`e.g., ${\n                  isLong ? (entryPrice * 1.1).toFixed(2) : (entryPrice * 0.9).toFixed(2)\n                }`}\n                value={takeProfitPrice}\n                onChange={(e) => {\n                  setTakeProfitPrice(e.target.value);\n                  setTakeProfitError('');\n                }}\n                className={`w-full bg-[#1A2332] border ${\n                  takeProfitError ? 'border-red-500' : 'border-gray-700'\n                } rounded-lg px-4 py-2.5 text-white outline-none focus:border-blue-500 transition-colors`}\n              />\n              {takeProfitPrice && !takeProfitError && (\n                <div\n                  className={`absolute right-3 top-1/2 -translate-y-1/2 text-sm ${\n                    tpPnL.percentage >= 0 ? 'text-green-400' : 'text-red-400'\n                  }`}\n                >\n                  {tpPnL.percentage >= 0 ? '+' : ''}\n                  {tpPnL.percentage.toFixed(2)}%\n                </div>\n              )}\n            </div>\n            {takeProfitError && <p className=\"text-xs text-red-400 mt-1\">{takeProfitError}</p>}\n            <p className=\"text-xs text-gray-500 mt-1\">\n              {isLong ? 'Must be above current price' : 'Must be below current price'}\n            </p>\n          </div>\n\n          {/* Stop Loss */}\n          <div>\n            <label className=\"block text-sm text-gray-400 mb-2\">Stop Loss Price</label>\n            <div className=\"relative\">\n              <input\n                type=\"number\"\n                step=\"0.01\"\n                placeholder={`e.g., ${\n                  isLong ? (entryPrice * 0.95).toFixed(2) : (entryPrice * 1.05).toFixed(2)\n                }`}\n                value={stopLossPrice}\n                onChange={(e) => {\n                  setStopLossPrice(e.target.value);\n                  setStopLossError('');\n                }}\n                className={`w-full bg-[#1A2332] border ${\n                  stopLossError ? 'border-red-500' : 'border-gray-700'\n                } rounded-lg px-4 py-2.5 text-white outline-none focus:border-blue-500 transition-colors`}\n              />\n              {stopLossPrice && !stopLossError && (\n                <div\n                  className={`absolute right-3 top-1/2 -translate-y-1/2 text-sm ${\n                    slPnL.percentage >= 0 ? 'text-green-400' : 'text-red-400'\n                  }`}\n                >\n                  {slPnL.percentage >= 0 ? '+' : ''}\n                  {slPnL.percentage.toFixed(2)}%\n                </div>\n              )}\n            </div>\n            {stopLossError && <p className=\"text-xs text-red-400 mt-1\">{stopLossError}</p>}\n            <p className=\"text-xs text-gray-500 mt-1\">\n              {isLong\n                ? 'Must be below current price (can be above entry for SL+)'\n                : 'Must be above current price (can be below entry for SL+)'}\n            </p>\n          </div>\n\n          {/* Info */}\n          <div className=\"bg-blue-500/10 border border-blue-500/30 rounded-lg p-3\">\n            <p className=\"text-xs text-blue-400\">\n              💡 TP/SL will be monitored by the backend and executed automatically when price\n              targets are hit. Settings are stored in memory and will be lost on backend restart.\n            </p>\n          </div>\n        </div>\n\n        {/* Footer */}\n        <div className=\"flex gap-2 p-4 border-t border-gray-700\">\n          {(takeProfitPrice || stopLossPrice) && (\n            <button\n              onClick={handleDelete}\n              disabled={isPending}\n              className=\"px-4 py-2 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg transition-colors disabled:opacity-50\"\n            >\n              Remove\n            </button>\n          )}\n          <button\n            onClick={() => onClose(false)}\n            className=\"flex-1 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors\"\n          >\n            Cancel\n          </button>\n          <button\n            onClick={handleSave}\n            disabled={isPending}\n            className=\"flex-1 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors disabled:opacity-50\"\n          >\n            {isPending ? 'Saving...' : 'Save TP/SL'}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default TPSLModal;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 10812, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/positions/PositionRow.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect } from 'react';\nimport { usePosition } from '@/hooks/data/usePositions';\nimport { usePrice } from '@/hooks/data/usePrices';\nimport { useTPSLContext } from '@/contexts/TPSLContext';\nimport { ALL_MARKETS } from '@/features/trading/constants/markets';\nimport { formatMarketPair } from '@/features/trading/lib/marketUtils';\nimport { formatUnits } from 'viem';\nimport { cn } from '@/lib/utils';\nimport { Button } from '@/components/ui/button';\nimport { TableRow, TableCell } from '@/components/ui/table';\n\ninterface PositionRowProps {\n  positionId: bigint;\n  onClose: (positionId: bigint, symbol: string) => void;\n  onPositionClick: (\n    positionId: bigint,\n    symbol: string,\n    entryPrice: number,\n    isLong: boolean,\n  ) => void;\n  onTPSLClick: (\n    positionId: bigint,\n    trader: string,\n    symbol: string,\n    entryPrice: number,\n    isLong: boolean,\n  ) => void;\n  isSelected: boolean;\n  onPositionLoaded?: (positionId: bigint, isOpen: boolean, symbol: string) => void;\n}\n\nconst PositionRow = ({\n  positionId,\n  onClose,\n  onPositionClick,\n  onTPSLClick,\n  isSelected,\n  onPositionLoaded,\n}: PositionRowProps) => {\n  const { position, isLoading } = usePosition(positionId);\n\n  // Use shared price hook\n  const { price: priceData, isLoading: loadingPrice } = usePrice(position?.symbol);\n  const currentPrice = priceData?.price || null;\n\n  // Fetch TP/SL config\n  const { getConfig } = useTPSLContext();\n  const tpslConfig = position ? getConfig(Number(position.id)) : null;\n\n  // Report position status\n  useEffect(() => {\n    if (!isLoading && position && onPositionLoaded) {\n      onPositionLoaded(positionId, position.status === 0, position.symbol);\n    }\n  }, [isLoading, position, positionId, onPositionLoaded]);\n\n  if (isLoading) {\n    return (\n      <TableRow className=\"border-b border-gray-800 hover:bg-transparent\">\n        <TableCell colSpan={9} className=\"text-center py-4 text-gray-500\">\n          Loading...\n        </TableCell>\n      </TableRow>\n    );\n  }\n\n  if (!position || position.status !== 0) {\n    return null;\n  }\n\n  const entryPrice = parseFloat(formatUnits(position.entryPrice, 8));\n  const collateral = parseFloat(formatUnits(position.collateral, 6));\n  const size = parseFloat(formatUnits(position.size, 6));\n  const leverage = Number(position.leverage);\n\n  // Calculate unrealized PnL and net value\n  let unrealizedPnl = 0;\n  let pnlPercentage = 0;\n  const markPrice = currentPrice || entryPrice;\n\n  if (currentPrice && entryPrice > 0) {\n    const priceDiff = position.isLong ? currentPrice - entryPrice : entryPrice - currentPrice;\n    unrealizedPnl = (priceDiff / entryPrice) * size;\n    pnlPercentage = (unrealizedPnl / collateral) * 100;\n  }\n\n  // Calculate liquidation price\n  const liqPriceRatio = (collateral / size) * 0.9;\n  const liquidationPrice = position.isLong\n    ? entryPrice * (1 - liqPriceRatio)\n    : entryPrice * (1 + liqPriceRatio);\n\n  const pnlColor = unrealizedPnl >= 0 ? 'text-emerald-400' : 'text-red-400';\n\n  // Get crypto logo\n  const getMarketLogo = (symbol: string) => {\n    const market = ALL_MARKETS.find((m) => m.symbol === symbol);\n    return market?.logoUrl || '';\n  };\n\n  const handleRowClick = (e: React.MouseEvent) => {\n    const target = e.target as HTMLElement;\n    if (target.closest('button')) return;\n    onPositionClick(position.id, position.symbol, entryPrice, position.isLong);\n  };\n\n  const handleTPSLClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    onTPSLClick(position.id, position.trader, position.symbol, entryPrice, position.isLong);\n  };\n\n  return (\n    <TableRow\n      onClick={handleRowClick}\n      className={cn(\n        'border-gray-800/50 hover:bg-gray-800/30 transition-colors cursor-pointer group',\n        isSelected && 'bg-blue-500/5',\n      )}\n    >\n      {/* Position */}\n      <TableCell className=\"py-4\">\n        <div className=\"flex items-center gap-3\">\n          <img\n            src={getMarketLogo(position.symbol)}\n            alt={position.symbol}\n            className=\"w-8 h-8 rounded-full bg-slate-800 object-cover\"\n            onError={(e) => {\n              (e.target as HTMLImageElement).style.visibility = 'hidden';\n            }}\n          />\n          <div className=\"flex flex-col\">\n            <span className=\"font-bold text-white\">{formatMarketPair(position.symbol)}</span>\n            <div className=\"flex items-center gap-1.5\">\n              <span className=\"text-xs font-semibold text-slate-400\">{leverage}x</span>\n              <span\n                className={cn(\n                  'text-xs font-semibold px-1.5 rounded-[3px] bg-opacity-20',\n                  position.isLong\n                    ? 'text-emerald-400 bg-emerald-400/10'\n                    : 'text-red-400 bg-red-400/10',\n                )}\n              >\n                {position.isLong ? 'Long' : 'Short'}\n              </span>\n            </div>\n          </div>\n        </div>\n      </TableCell>\n\n      {/* Size */}\n      <TableCell className=\"text-right text-white font-medium\">${size.toFixed(2)}</TableCell>\n\n      {/* PnL (ROE%) */}\n      <TableCell className=\"text-right\">\n        <div className=\"flex flex-col items-end gap-0.5\">\n          <span className={cn('font-bold', pnlColor)}>\n            {unrealizedPnl >= 0 ? '+' : ''}\n            {unrealizedPnl.toFixed(2)}\n          </span>\n          <span className={cn('text-xs font-medium', pnlColor)}>\n            {pnlPercentage >= 0 ? '+' : ''}\n            {pnlPercentage.toFixed(2)}%\n          </span>\n        </div>\n      </TableCell>\n\n      {/* Collateral */}\n      <TableCell className=\"text-right text-white font-medium\">${collateral.toFixed(2)}</TableCell>\n\n      {/* Entry Price */}\n      <TableCell className=\"text-right text-white font-mono\">\n        $\n        {entryPrice.toLocaleString(undefined, {\n          minimumFractionDigits: 2,\n          maximumFractionDigits: 2,\n        })}\n      </TableCell>\n\n      {/* Mark Price */}\n      <TableCell className=\"text-right text-white font-mono\">\n        {loadingPrice ? (\n          <span className=\"text-slate-600\">...</span>\n        ) : (\n          `$${markPrice.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`\n        )}\n      </TableCell>\n\n      {/* Liq. Price */}\n      <TableCell className=\"text-right text-orange-400 font-mono\">\n        $\n        {liquidationPrice.toLocaleString(undefined, {\n          minimumFractionDigits: 2,\n          maximumFractionDigits: 2,\n        })}\n      </TableCell>\n\n      {/* TP / SL (Values) */}\n      <TableCell className=\"text-right\">\n        {tpslConfig && (tpslConfig.takeProfit || tpslConfig.stopLoss) ? (\n          <div className=\"flex flex-col items-end gap-1 text-xs font-medium\">\n            {tpslConfig.takeProfit && (\n              <span className=\"text-emerald-400/90\">\n                TP: ${(Number(tpslConfig.takeProfit) / 1e8).toFixed(2)}\n              </span>\n            )}\n            {tpslConfig.stopLoss && (\n              <span className=\"text-red-400/90\">\n                SL: ${(Number(tpslConfig.stopLoss) / 1e8).toFixed(2)}\n              </span>\n            )}\n          </div>\n        ) : (\n          <span className=\"text-slate-600 text-xs\">-</span>\n        )}\n      </TableCell>\n\n      {/* Actions (Always Visible) */}\n      <TableCell className=\"text-right\">\n        <div className=\"flex items-center justify-end gap-2\">\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={handleTPSLClick}\n            className=\"h-7 px-3 bg-slate-800 hover:bg-slate-700 text-slate-300 text-xs font-medium border border-slate-700 hover:border-slate-600\"\n          >\n            TP/SL\n          </Button>\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => onClose(position.id, position.symbol)}\n            className=\"h-7 px-3 bg-red-500/10 hover:bg-red-500/20 text-red-400 hover:text-red-300 text-xs font-medium border border-red-500/20 hover:border-red-500/30\"\n          >\n            Close\n          </Button>\n        </div>\n      </TableCell>\n    </TableRow>\n  );\n};\n\nexport default PositionRow;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 11189, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/positions/MobilePositionCard.tsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { usePosition } from '@/hooks/data/usePositions';\nimport { usePrice } from '@/hooks/data/usePrices';\nimport { useTPSLContext } from '@/contexts/TPSLContext';\nimport { ALL_MARKETS } from '@/features/trading/constants/markets';\nimport { formatMarketPair } from '@/features/trading/lib/marketUtils';\nimport { formatUnits } from 'viem';\nimport { cn } from '@/lib/utils';\nimport { Button } from '@/components/ui/button';\n\ninterface MobilePositionCardProps {\n  positionId: bigint;\n  onClose: (positionId: bigint, symbol: string) => void;\n  onPositionClick: (\n    positionId: bigint,\n    symbol: string,\n    entryPrice: number,\n    isLong: boolean,\n  ) => void;\n  onTPSLClick: (\n    positionId: bigint,\n    trader: string,\n    symbol: string,\n    entryPrice: number,\n    isLong: boolean,\n  ) => void;\n  onPositionLoaded?: (positionId: bigint, isOpen: boolean, symbol: string) => void;\n}\n\nconst MobilePositionCard = ({\n  positionId,\n  onClose,\n  onPositionClick,\n  onTPSLClick,\n  onPositionLoaded,\n}: MobilePositionCardProps) => {\n  const { position, isLoading } = usePosition(positionId);\n  const { price: priceData, isLoading: loadingPrice } = usePrice(position?.symbol);\n  const currentPrice = priceData?.price || null;\n\n  const { getConfig } = useTPSLContext();\n  const tpslConfig = position ? getConfig(Number(position.id)) : null;\n\n  useEffect(() => {\n    if (!isLoading && position && onPositionLoaded) {\n      onPositionLoaded(positionId, position.status === 0, position.symbol);\n    }\n  }, [isLoading, position, positionId, onPositionLoaded]);\n\n  if (isLoading || !position || position.status !== 0) {\n    return null;\n  }\n\n  const entryPrice = parseFloat(formatUnits(position.entryPrice, 8));\n  const collateral = parseFloat(formatUnits(position.collateral, 6));\n  const size = parseFloat(formatUnits(position.size, 6));\n  const leverage = Number(position.leverage);\n\n  let unrealizedPnl = 0;\n  let pnlPercentage = 0;\n  const markPrice = currentPrice || entryPrice;\n\n  if (currentPrice && entryPrice > 0) {\n    const priceDiff = position.isLong ? currentPrice - entryPrice : entryPrice - currentPrice;\n    unrealizedPnl = (priceDiff / entryPrice) * size;\n    pnlPercentage = (unrealizedPnl / collateral) * 100;\n  }\n\n  const liqPriceRatio = (collateral / size) * 0.9;\n  const liquidationPrice = position.isLong\n    ? entryPrice * (1 - liqPriceRatio)\n    : entryPrice * (1 + liqPriceRatio);\n\n  const pnlColor = unrealizedPnl >= 0 ? 'text-emerald-400' : 'text-red-400';\n\n  const getMarketLogo = (symbol: string) => {\n    const market = ALL_MARKETS.find((m) => m.symbol === symbol);\n    return market?.logoUrl || '';\n  };\n\n  return (\n    <div className=\"bg-[#131B26] p-4 rounded-lg border border-gray-800 space-y-4\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-3\">\n          <img\n            src={getMarketLogo(position.symbol)}\n            alt={position.symbol}\n            className=\"w-8 h-8 rounded-full bg-slate-800 object-cover\"\n            onError={(e) => {\n              (e.target as HTMLImageElement).style.visibility = 'hidden';\n            }}\n          />\n          <div>\n            <div className=\"flex items-center gap-2\">\n              <span className=\"font-bold text-white text-base\">\n                {formatMarketPair(position.symbol)}\n              </span>\n              <span\n                className={`text-xs font-bold px-1.5 py-0.5 rounded ${\n                  position.isLong\n                    ? 'bg-emerald-500/10 text-emerald-400'\n                    : 'bg-red-500/10 text-red-400'\n                }`}\n              >\n                {position.isLong ? 'Long' : 'Short'}\n              </span>\n            </div>\n            <span className=\"text-xs text-gray-400\">{leverage}x Leverage</span>\n          </div>\n        </div>\n        <div className=\"text-right\">\n          <div className={`text-lg font-bold ${pnlColor}`}>\n            {unrealizedPnl >= 0 ? '+' : ''}\n            {unrealizedPnl.toFixed(2)}\n          </div>\n          <div className={`text-xs font-medium ${pnlColor}`}>\n            ({pnlPercentage >= 0 ? '+' : ''}\n            {pnlPercentage.toFixed(2)}%)\n          </div>\n        </div>\n      </div>\n\n      {/* Stats Grid */}\n      <div className=\"grid grid-cols-2 gap-y-3 gap-x-4 text-xs\">\n        <div className=\"flex justify-between\">\n          <span className=\"text-gray-500\">Size</span>\n          <span className=\"text-white font-medium\">${size.toFixed(2)}</span>\n        </div>\n        <div className=\"flex justify-between\">\n          <span className=\"text-gray-500\">Margin</span>\n          <span className=\"text-white font-medium\">${collateral.toFixed(2)}</span>\n        </div>\n        <div className=\"flex justify-between\">\n          <span className=\"text-gray-500\">Entry Price</span>\n          <span className=\"text-white font-medium\">${entryPrice.toLocaleString()}</span>\n        </div>\n        <div className=\"flex justify-between\">\n          <span className=\"text-gray-500\">Mark Price</span>\n          <span className=\"text-white font-medium\">${markPrice.toLocaleString()}</span>\n        </div>\n        <div className=\"flex justify-between\">\n          <span className=\"text-gray-500\">Liq. Price</span>\n          <span className=\"text-orange-400 font-medium\">${liquidationPrice.toLocaleString()}</span>\n        </div>\n      </div>\n\n      {/* TP/SL Info */}\n      {tpslConfig && (tpslConfig.takeProfit || tpslConfig.stopLoss) && (\n        <div className=\"flex gap-4 text-xs pt-2 border-t border-gray-800/50\">\n          {tpslConfig.takeProfit && (\n            <span className=\"text-emerald-400\">\n              TP: ${(Number(tpslConfig.takeProfit) / 1e8).toFixed(2)}\n            </span>\n          )}\n          {tpslConfig.stopLoss && (\n            <span className=\"text-red-400\">\n              SL: ${(Number(tpslConfig.stopLoss) / 1e8).toFixed(2)}\n            </span>\n          )}\n        </div>\n      )}\n\n      {/* Actions */}\n      <div className=\"grid grid-cols-2 gap-3 pt-2\">\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          className=\"w-full bg-slate-800 border-slate-700 hover:bg-slate-700 text-xs\"\n          onClick={(e) => {\n            e.stopPropagation();\n            onTPSLClick(position.id, position.trader, position.symbol, entryPrice, position.isLong);\n          }}\n        >\n          TP / SL\n        </Button>\n        <Button\n          variant=\"destructive\"\n          size=\"sm\"\n          className=\"w-full text-xs\"\n          onClick={(e) => {\n            e.stopPropagation();\n            onClose(position.id, position.symbol);\n          }}\n        >\n          Close Position\n        </Button>\n      </div>\n    </div>\n  );\n};\n\nexport default MobilePositionCard;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 11588, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/positions/PositionsTable.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState } from 'react';\nimport PositionRow from './PositionRow';\nimport MobilePositionCard from './MobilePositionCard';\nimport { cn } from '@/lib/utils';\nimport { Button } from '@/components/ui/button';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from '@/components/ui/alert-dialog';\n\ninterface PositionsTableProps {\n  positionIds: bigint[];\n  isLoading: boolean;\n  openPositionsCount: number;\n  isClosing: boolean;\n  selectedPositionId?: bigint;\n  tpslRefreshTrigger: number;\n  onClosePosition: (positionId: bigint, symbol: string) => void;\n  onPositionClick: (\n    positionId: bigint,\n    symbol: string,\n    entryPrice: number,\n    isLong: boolean,\n  ) => void;\n  onTPSLClick: (\n    positionId: bigint,\n    trader: string,\n    symbol: string,\n    entryPrice: number,\n    isLong: boolean,\n  ) => void;\n  onPositionLoaded: (positionId: bigint, isOpen: boolean, symbol: string) => void;\n  onCloseAll: () => void;\n}\n\nconst PositionsTable = ({\n  positionIds,\n  isLoading,\n  openPositionsCount,\n  isClosing,\n  selectedPositionId,\n  tpslRefreshTrigger,\n  onClosePosition,\n  onPositionClick,\n  onTPSLClick,\n  onPositionLoaded,\n  onCloseAll,\n}: PositionsTableProps) => {\n  // Dialog State\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [actionType, setActionType] = useState<'single' | 'all'>('single');\n  const [targetPosition, setTargetPosition] = useState<{ id: bigint; symbol: string } | null>(null);\n\n  // Handle \"Close\" click on a single position\n  const handleRequestClose = (positionId: bigint, symbol: string) => {\n    setTargetPosition({ id: positionId, symbol });\n    setActionType('single');\n    setIsDialogOpen(true);\n  };\n\n  // Handle \"Close All\" click\n  const handleRequestCloseAll = () => {\n    setActionType('all');\n    setIsDialogOpen(true);\n  };\n\n  // Confirm Action\n  const handleConfirmClose = () => {\n    if (actionType === 'all') {\n      onCloseAll();\n    } else if (targetPosition) {\n      onClosePosition(targetPosition.id, targetPosition.symbol);\n    }\n    setIsDialogOpen(false);\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex flex-col items-center justify-center py-20 text-slate-500\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-500 mb-4\"></div>\n        <span>Loading positions...</span>\n      </div>\n    );\n  }\n\n  if (positionIds.length === 0) {\n    return <div className=\"text-center py-16 text-gray-500\">No open positions</div>;\n  }\n\n  return (\n    <div className=\"h-full flex flex-col\">\n      {/* Actions Bar for Desktop */}\n      <div className=\"hidden md:flex justify-end p-2 border-b border-gray-800/50\">\n        {openPositionsCount > 0 && (\n          <Button\n            variant=\"destructive\"\n            size=\"sm\"\n            onClick={handleRequestCloseAll}\n            disabled={isClosing}\n            className=\"h-7 text-xs font-bold\"\n          >\n            Close All Positions\n          </Button>\n        )}\n      </div>\n\n      {/* Desktop View: Table */}\n      <div className=\"hidden md:block overflow-x-auto custom-scrollbar\">\n        <Table>\n          <TableHeader className=\"bg-[#0B1017] sticky top-0 z-10\">\n            <TableRow className=\"border-b border-gray-800 hover:bg-transparent\">\n              <TableHead className=\"font-medium min-w-[140px]\">Position</TableHead>\n              <TableHead className=\"text-right font-medium\">Size</TableHead>\n              <TableHead className=\"text-right font-medium\">PnL (ROE%)</TableHead>\n              <TableHead className=\"text-right font-medium\">Collateral</TableHead>\n              <TableHead className=\"text-right font-medium\">Entry Price</TableHead>\n              <TableHead className=\"text-right font-medium\">Mark Price</TableHead>\n              <TableHead className=\"text-right font-medium\">Liq. Price</TableHead>\n              <TableHead className=\"text-right font-medium\">TP / SL</TableHead>\n              <TableHead className=\"text-right font-medium w-32\">Actions</TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {positionIds.map((positionId) => (\n              <PositionRow\n                key={`${positionId.toString()}-${tpslRefreshTrigger}`}\n                positionId={positionId}\n                onClose={handleRequestClose}\n                onPositionClick={onPositionClick}\n                onTPSLClick={onTPSLClick}\n                isSelected={selectedPositionId === positionId}\n                onPositionLoaded={onPositionLoaded}\n              />\n            ))}\n          </TableBody>\n        </Table>\n      </div>\n\n      {/* Mobile View: Cards */}\n      <div className=\"md:hidden space-y-4 flex-1 overflow-y-auto p-4\">\n        {openPositionsCount > 0 && (\n          <Button\n            variant=\"destructive\"\n            size=\"sm\"\n            onClick={handleRequestCloseAll}\n            disabled={isClosing}\n            className=\"w-full mb-4 font-bold\"\n          >\n            Close All Positions\n          </Button>\n        )}\n        {positionIds.map((positionId) => (\n          <MobilePositionCard\n            key={`mobile-${positionId.toString()}-${tpslRefreshTrigger}`}\n            positionId={positionId}\n            onClose={handleRequestClose}\n            onPositionClick={onPositionClick}\n            onTPSLClick={onTPSLClick}\n            onPositionLoaded={onPositionLoaded}\n          />\n        ))}\n      </div>\n\n      {/* Confirmation Dialog */}\n      <AlertDialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <AlertDialogContent className=\"bg-[#131B26] border-gray-800 text-white\">\n          <AlertDialogHeader>\n            <AlertDialogTitle>\n              {actionType === 'all' ? 'Close All Positions?' : 'Close Position?'}\n            </AlertDialogTitle>\n            <AlertDialogDescription className=\"text-gray-400\">\n              {actionType === 'all'\n                ? 'Are you sure you want to close ALL open positions? This action cannot be undone.'\n                : `Are you sure you want to close your ${targetPosition?.symbol} position at market price?`}\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel className=\"bg-transparent border-gray-700 text-gray-300 hover:bg-gray-800 hover:text-white\">\n              Cancel\n            </AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleConfirmClose}\n              className=\"bg-red-600 hover:bg-red-700 text-white border-0\"\n            >\n              Confirm Close\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n};\n\nexport default PositionsTable;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 11922, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/hooks/useTapToTradeOrders.ts"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { useEmbeddedWallet } from '@/features/wallet/hooks/useEmbeddedWallet';\nimport { useTapToTrade } from '@/features/trading/contexts/TapToTradeContext';\n\nconst BACKEND_API_URL = process.env.NEXT_PUBLIC_BACKEND_URL || 'http://localhost:3001';\n\nexport interface TapToTradeOrder {\n  id: string;\n  gridSessionId: string;\n  cellId: string;\n  trader: string;\n  symbol: string;\n  isLong: boolean;\n  collateral: string;\n  leverage: number;\n  triggerPrice: string;\n  startTime: number;\n  endTime: number;\n  nonce: string;\n  signature: string;\n  status: 'PENDING' | 'EXECUTING' | 'EXECUTED' | 'CANCELLED' | 'EXPIRED' | 'FAILED';\n  createdAt: number;\n  updatedAt: number;\n  executedAt?: number;\n  executedTxHash?: string;\n  failureReason?: string;\n}\n\nexport function useTapToTradeOrders() {\n  const { address } = useEmbeddedWallet();\n  const { gridSession } = useTapToTrade();\n  const [orders, setOrders] = useState<TapToTradeOrder[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [cancellingOrders, setCancellingOrders] = useState<Set<string>>(new Set());\n\n  // Fetch orders\n  const fetchOrders = async () => {\n    if (!address) return;\n\n    setIsLoading(true);\n    try {\n      const response = await fetch(`${BACKEND_API_URL}/api/tap-to-trade/orders?trader=${address}`);\n      const result = await response.json();\n\n      if (result.success) {\n        setOrders(result.data);\n      }\n    } catch (error) {\n      console.error('Failed to fetch tap-to-trade orders:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Poll orders every 5 seconds\n  useEffect(() => {\n    fetchOrders();\n    const interval = setInterval(fetchOrders, 5000);\n    return () => clearInterval(interval);\n  }, [address]);\n\n  // Cancel single order\n  const cancelOrder = async (orderId: string) => {\n    if (!address) return;\n\n    setCancellingOrders((prev) => new Set(prev).add(orderId));\n    try {\n      const response = await fetch(`${BACKEND_API_URL}/api/tap-to-trade/cancel-order`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ orderId, trader: address }),\n      });\n\n      const result = await response.json();\n      if (result.success) {\n        await fetchOrders(); // Refresh orders\n      }\n    } catch (error) {\n      console.error('Failed to cancel order:', error);\n    } finally {\n      setCancellingOrders((prev) => {\n        const newSet = new Set(prev);\n        newSet.delete(orderId);\n        return newSet;\n      });\n    }\n  };\n\n  // Cancel all pending orders in the current grid session\n  const cancelAllOrders = async () => {\n    if (!address || !gridSession) return;\n\n    const allOrderIds = orders.filter((o) => o.status === 'PENDING').map((o) => o.id);\n    if (allOrderIds.length === 0) return;\n\n    allOrderIds.forEach((id) => setCancellingOrders((prev) => new Set(prev).add(id)));\n\n    try {\n      const response = await fetch(`${BACKEND_API_URL}/api/tap-to-trade/cancel-grid`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          gridSessionId: gridSession.id,\n          trader: address,\n        }),\n      });\n\n      const result = await response.json();\n      if (result.success) {\n        await fetchOrders(); // Refresh orders\n      }\n    } catch (error) {\n      console.error('Failed to cancel all orders:', error);\n    } finally {\n      allOrderIds.forEach((id) => {\n        setCancellingOrders((prev) => {\n          const newSet = new Set(prev);\n          newSet.delete(id);\n          return newSet;\n        });\n      });\n    }\n  };\n\n  return {\n    orders,\n    isLoading,\n    cancellingOrders,\n    refetch: fetchOrders,\n    cancelOrder,\n    cancelAllOrders,\n  };\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEA,MAAM,kBAAkB,QAAQ,GAAG,CAAC,uBAAuB,IAAI;AAwBxD,SAAS;IACd,MAAM,EAAE,OAAO,EAAE,GAAG,IAAA,4KAAiB;IACrC,MAAM,EAAE,WAAW,EAAE,GAAG,IAAA,6KAAa;IACrC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAoB,EAAE;IAC1D,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,iNAAQ,EAAc,IAAI;IAE1E,eAAe;IACf,MAAM,cAAc;QAClB,IAAI,CAAC,SAAS;QAEd,aAAa;QACb,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,GAAG,gBAAgB,gCAAgC,EAAE,SAAS;YAC3F,MAAM,SAAS,MAAM,SAAS,IAAI;YAElC,IAAI,OAAO,OAAO,EAAE;gBAClB,UAAU,OAAO,IAAI;YACvB;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,wCAAwC;QACxD,SAAU;YACR,aAAa;QACf;IACF;IAEA,8BAA8B;IAC9B,IAAA,kNAAS,EAAC;QACR;QACA,MAAM,WAAW,YAAY,aAAa;QAC1C,OAAO,IAAM,cAAc;IAC7B,GAAG;QAAC;KAAQ;IAEZ,sBAAsB;IACtB,MAAM,cAAc,OAAO;QACzB,IAAI,CAAC,SAAS;QAEd,oBAAoB,CAAC,OAAS,IAAI,IAAI,MAAM,GAAG,CAAC;QAChD,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,GAAG,gBAAgB,8BAA8B,CAAC,EAAE;gBAC/E,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAS,QAAQ;gBAAQ;YAClD;YAEA,MAAM,SAAS,MAAM,SAAS,IAAI;YAClC,IAAI,OAAO,OAAO,EAAE;gBAClB,MAAM,eAAe,iBAAiB;YACxC;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;QAC3C,SAAU;YACR,oBAAoB,CAAC;gBACnB,MAAM,SAAS,IAAI,IAAI;gBACvB,OAAO,MAAM,CAAC;gBACd,OAAO;YACT;QACF;IACF;IAEA,wDAAwD;IACxD,MAAM,kBAAkB;QACtB,IAAI,CAAC,WAAW,CAAC,aAAa;QAE9B,MAAM,cAAc,OAAO,MAAM,CAAC,CAAC,IAAM,EAAE,MAAM,KAAK,WAAW,GAAG,CAAC,CAAC,IAAM,EAAE,EAAE;QAChF,IAAI,YAAY,MAAM,KAAK,GAAG;QAE9B,YAAY,OAAO,CAAC,CAAC,KAAO,oBAAoB,CAAC,OAAS,IAAI,IAAI,MAAM,GAAG,CAAC;QAE5E,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,GAAG,gBAAgB,6BAA6B,CAAC,EAAE;gBAC9E,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBACnB,eAAe,YAAY,EAAE;oBAC7B,QAAQ;gBACV;YACF;YAEA,MAAM,SAAS,MAAM,SAAS,IAAI;YAClC,IAAI,OAAO,OAAO,EAAE;gBAClB,MAAM,eAAe,iBAAiB;YACxC;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,gCAAgC;QAChD,SAAU;YACR,YAAY,OAAO,CAAC,CAAC;gBACnB,oBAAoB,CAAC;oBACnB,MAAM,SAAS,IAAI,IAAI;oBACvB,OAAO,MAAM,CAAC;oBACd,OAAO;gBACT;YACF;QACF;IACF;IAEA,OAAO;QACL;QACA;QACA;QACA,SAAS;QACT;QACA;IACF;AACF"}},
    {"offset": {"line": 12038, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/MobileOpenOrderCard.tsx"],"sourcesContent":["import React from 'react';\nimport { formatUnits } from 'viem';\nimport { Button } from '@/components/ui/button';\nimport { formatMarketPair } from '@/features/trading/lib/marketUtils';\nimport { ALL_MARKETS } from '@/features/trading/constants/markets';\n\n// Type definitions reuse\n// Since we are not strictly importing types from hooks due to inline types in hooks,\n// we'll define a flexible interface compatible with both.\ninterface MobileOpenOrderCardProps {\n  order: any; // Using any for flexibility or we can define strict union type\n  type: 'LIMIT' | 'TAP';\n  onCancel: (id: any) => void;\n  isCancelling?: boolean;\n}\n\nconst MobileOpenOrderCard = ({ order, type, onCancel, isCancelling }: MobileOpenOrderCardProps) => {\n  // Helper to get logo URL\n  const getLogoUrl = (symbol: string) => {\n    const market = ALL_MARKETS.find((m) => m.symbol === symbol || m.binanceSymbol === symbol);\n    return (\n      market?.logoUrl ||\n      `https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/info/logo.png`\n    );\n  };\n\n  const isLimit = type === 'LIMIT';\n  const triggerPrice = parseFloat(formatUnits(order.triggerPrice, 8));\n  const collateral = parseFloat(formatUnits(order.collateral, 6));\n  const createdDate = isLimit\n    ? new Date(Number(order.createdAt) * 1000)\n    : new Date(order.startTime * 1000);\n\n  return (\n    <div className=\"bg-[#131B26] p-4 rounded-lg border border-gray-800 space-y-3\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-3\">\n          <img\n            src={getLogoUrl(order.symbol)}\n            alt={order.symbol}\n            className=\"w-8 h-8 rounded-full bg-slate-800\"\n            onError={(e) => {\n              (e.target as HTMLImageElement).style.visibility = 'hidden';\n            }}\n          />\n          <div>\n            <div className=\"flex items-center gap-2\">\n              <span className=\"font-bold text-white text-base\">\n                {formatMarketPair(order.symbol)}\n              </span>\n              <span\n                className={`text-[10px] font-bold px-1.5 py-0.5 rounded ${\n                  isLimit ? 'bg-blue-500/10 text-blue-400' : 'bg-purple-500/10 text-purple-400'\n                }`}\n              >\n                {type}\n              </span>\n            </div>\n            <div className=\"flex items-center gap-2 mt-0.5\">\n              <span\n                className={`text-xs font-bold ${order.isLong ? 'text-green-400' : 'text-red-400'}`}\n              >\n                {order.isLong ? 'Long' : 'Short'}\n              </span>\n              <span className=\"text-xs text-gray-400\">• {order.leverage}x</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Details */}\n      <div className=\"grid-cols-2 gap-4 text-xs flex flex-col\">\n        <div>\n          <div className=\"flex justify-between\">\n            <span className=\"text-gray-500\">Trigger Price</span>\n            <span className=\"text-white font-mono\">${triggerPrice.toLocaleString()}</span>\n          </div>\n          <div className=\"flex justify-between\">\n            <span className=\"text-gray-500\">Collateral</span>\n            <span className=\"text-white font-mono\">${collateral.toFixed(2)}</span>\n          </div>\n        </div>\n        <div className=\"flex justify-between\">\n          <span className=\"text-gray-500\">Time</span>\n          <span className=\"text-gray-400\">{createdDate.toLocaleString()}</span>\n        </div>\n      </div>\n\n      {/* Action */}\n      <Button\n        variant=\"destructive\"\n        size=\"sm\"\n        className=\"w-full mt-2 text-xs h-8\"\n        onClick={() => onCancel(order.id)}\n        disabled={isCancelling}\n      >\n        {isCancelling ? 'Cancelling...' : 'Cancel Order'}\n      </Button>\n    </div>\n  );\n};\n\nexport default MobileOpenOrderCard;\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;;;;;;AAYA,MAAM,sBAAsB,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,QAAQ,EAAE,YAAY,EAA4B;IAC5F,yBAAyB;IACzB,MAAM,aAAa,CAAC;QAClB,MAAM,SAAS,iKAAW,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,MAAM,KAAK,UAAU,EAAE,aAAa,KAAK;QAClF,OACE,QAAQ,WACR,CAAC,8FAA8F,CAAC;IAEpG;IAEA,MAAM,UAAU,SAAS;IACzB,MAAM,eAAe,WAAW,IAAA,2KAAW,EAAC,MAAM,YAAY,EAAE;IAChE,MAAM,aAAa,WAAW,IAAA,2KAAW,EAAC,MAAM,UAAU,EAAE;IAC5D,MAAM,cAAc,UAChB,IAAI,KAAK,OAAO,MAAM,SAAS,IAAI,QACnC,IAAI,KAAK,MAAM,SAAS,GAAG;IAE/B,qBACE,8OAAC;QAAI,WAAU;;0BAEb,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BACC,KAAK,WAAW,MAAM,MAAM;4BAC5B,KAAK,MAAM,MAAM;4BACjB,WAAU;4BACV,SAAS,CAAC;gCACP,EAAE,MAAM,CAAsB,KAAK,CAAC,UAAU,GAAG;4BACpD;;;;;;sCAEF,8OAAC;;8CACC,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAK,WAAU;sDACb,IAAA,oKAAgB,EAAC,MAAM,MAAM;;;;;;sDAEhC,8OAAC;4CACC,WAAW,CAAC,4CAA4C,EACtD,UAAU,iCAAiC,oCAC3C;sDAED;;;;;;;;;;;;8CAGL,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CACC,WAAW,CAAC,kBAAkB,EAAE,MAAM,MAAM,GAAG,mBAAmB,gBAAgB;sDAEjF,MAAM,MAAM,GAAG,SAAS;;;;;;sDAE3B,8OAAC;4CAAK,WAAU;;gDAAwB;gDAAG,MAAM,QAAQ;gDAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAOlE,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;;0CACC,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAK,WAAU;kDAAgB;;;;;;kDAChC,8OAAC;wCAAK,WAAU;;4CAAuB;4CAAE,aAAa,cAAc;;;;;;;;;;;;;0CAEtE,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAK,WAAU;kDAAgB;;;;;;kDAChC,8OAAC;wCAAK,WAAU;;4CAAuB;4CAAE,WAAW,OAAO,CAAC;;;;;;;;;;;;;;;;;;;kCAGhE,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAK,WAAU;0CAAgB;;;;;;0CAChC,8OAAC;gCAAK,WAAU;0CAAiB,YAAY,cAAc;;;;;;;;;;;;;;;;;;0BAK/D,8OAAC,4IAAM;gBACL,SAAQ;gBACR,MAAK;gBACL,WAAU;gBACV,SAAS,IAAM,SAAS,MAAM,EAAE;gBAChC,UAAU;0BAET,eAAe,kBAAkB;;;;;;;;;;;;AAI1C;uCAEe"}},
    {"offset": {"line": 12277, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/OpenOrdersTab.tsx"],"sourcesContent":["import { useState } from 'react';\nimport {\n  useUserPendingOrders,\n  useCancelOrder,\n  OrderType,\n} from '@/features/trading/hooks/useLimitOrder';\nimport { useTapToTradeOrders, TapToTradeOrder } from '@/features/trading/hooks/useTapToTradeOrders';\nimport { formatMarketPair } from '@/features/trading/lib/marketUtils';\nimport { formatUnits } from 'viem';\nimport { toast } from 'sonner';\nimport { Button } from '@/components/ui/button';\nimport { ALL_MARKETS } from '@/features/trading/constants/markets';\nimport MobileOpenOrderCard from './MobileOpenOrderCard';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\n\nexport default function OpenOrdersTab() {\n  // Limit Orders Data\n  const {\n    orders: limitOrders,\n    isLoading: isLoadingLimit,\n    refetch: refetchLimit,\n  } = useUserPendingOrders();\n  const { cancelOrder: cancelLimitOrder, isPending: isCancellingLimit } = useCancelOrder();\n\n  // Tap Orders Data\n  const {\n    orders: tapOrders,\n    isLoading: isLoadingTap,\n    cancelOrder: cancelTapOrder,\n    cancellingOrders,\n    cancelAllOrders: cancelAllTap,\n  } = useTapToTradeOrders();\n\n  // Filter for ONLY pending tap orders\n  const pendingTapOrders = tapOrders.filter((o) => o.status === 'PENDING');\n\n  const isLoading = isLoadingLimit || isLoadingTap;\n\n  const handleCancelLimit = async (orderId: bigint) => {\n    try {\n      toast.loading('Cancelling order...', { id: 'cancel-limit' });\n      await cancelLimitOrder(orderId);\n      toast.success('Order cancelled!', { id: 'cancel-limit' });\n      setTimeout(() => refetchLimit(), 1000);\n    } catch (error) {\n      console.error('Error cancelling order:', error);\n      toast.error('Failed to cancel order', { id: 'cancel-limit' });\n    }\n  };\n\n  const handleCancelTap = async (orderId: string) => {\n    await cancelTapOrder(orderId);\n  };\n\n  // Helper to get logo URL\n  const getLogoUrl = (symbol: string) => {\n    const market = ALL_MARKETS.find((m) => m.symbol === symbol || m.binanceSymbol === symbol);\n    return (\n      market?.logoUrl ||\n      `https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/info/logo.png`\n    );\n  };\n\n  if (isLoading && limitOrders.length === 0 && tapOrders.length === 0) {\n    return <div className=\"text-center py-16 text-gray-500\">Loading open orders...</div>;\n  }\n\n  if (limitOrders.length === 0 && pendingTapOrders.length === 0) {\n    return <div className=\"text-center py-16 text-gray-500\">No open orders found.</div>;\n  }\n\n  return (\n    <div className=\"h-full flex flex-col\">\n      {/* Actions Bar */}\n      <div className=\"flex justify-end p-2 border-b border-gray-800/50\">\n        {pendingTapOrders.length > 0 && (\n          <Button\n            variant=\"destructive\"\n            size=\"sm\"\n            onClick={cancelAllTap}\n            className=\"h-7 text-xs font-bold\"\n          >\n            Cancel All Tap Orders\n          </Button>\n        )}\n      </div>\n\n      {/* Desktop View: Table */}\n      <div className=\"hidden md:block overflow-x-auto\">\n        <Table>\n          <TableHeader className=\"bg-[#0B1017] sticky top-0 z-10\">\n            <TableRow className=\"border-b border-gray-800 hover:bg-transparent\">\n              <TableHead className=\"font-medium\">Type</TableHead>\n              <TableHead className=\"font-medium\">Symbol</TableHead>\n              <TableHead className=\"font-medium\">Side</TableHead>\n              <TableHead className=\"text-right font-medium\">Trigger Price</TableHead>\n              <TableHead className=\"text-right font-medium\">Size/Collateral</TableHead>\n              <TableHead className=\"text-right font-medium\">Leverage</TableHead>\n              <TableHead className=\"text-right font-medium\">Time</TableHead>\n              <TableHead className=\"text-right font-medium\">Actions</TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {/* Limit Orders */}\n            {limitOrders.map((order) => {\n              const triggerPrice = parseFloat(formatUnits(order.triggerPrice, 8));\n              const collateral = parseFloat(formatUnits(order.collateral, 6));\n              const createdDate = new Date(Number(order.createdAt) * 1000);\n\n              return (\n                <TableRow\n                  key={`limit-${order.id.toString()}`}\n                  className=\"hover:bg-gray-800/30 transition-colors group border-gray-800/50\"\n                >\n                  <TableCell>\n                    <span className=\"px-2 py-0.5 rounded text-[10px] font-bold bg-blue-500/10 text-blue-400\">\n                      LIMIT\n                    </span>\n                  </TableCell>\n                  <TableCell className=\"text-white font-medium\">\n                    <div className=\"flex items-center gap-2\">\n                      <img\n                        src={getLogoUrl(order.symbol)}\n                        alt={order.symbol}\n                        className=\"w-5 h-5 rounded-full\"\n                        onError={(e) => {\n                          (e.target as HTMLImageElement).src =\n                            'https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/info/logo.png';\n                        }}\n                      />\n                      {formatMarketPair(order.symbol)}\n                    </div>\n                  </TableCell>\n                  <TableCell>\n                    <span\n                      className={`font-medium ${order.isLong ? 'text-green-400' : 'text-red-400'}`}\n                    >\n                      {order.isLong ? 'Long' : 'Short'}\n                    </span>\n                  </TableCell>\n                  <TableCell className=\"text-right text-white font-mono\">\n                    $\n                    {triggerPrice.toLocaleString(undefined, {\n                      minimumFractionDigits: 2,\n                      maximumFractionDigits: 2,\n                    })}\n                  </TableCell>\n                  <TableCell className=\"text-right text-white font-mono\">\n                    ${collateral.toFixed(2)}\n                  </TableCell>\n                  <TableCell className=\"text-right text-white font-mono\">\n                    {order.leverage}x\n                  </TableCell>\n                  <TableCell className=\"text-right text-xs text-gray-500\">\n                    {createdDate.toLocaleTimeString()}\n                  </TableCell>\n                  <TableCell className=\"text-right\">\n                    <button\n                      onClick={() => handleCancelLimit(order.id)}\n                      disabled={isCancellingLimit}\n                      className=\"text-red-500 hover:text-red-400 text-xs font-medium transition-colors disabled:opacity-50\"\n                    >\n                      {isCancellingLimit ? '...' : 'Cancel'}\n                    </button>\n                  </TableCell>\n                </TableRow>\n              );\n            })}\n\n            {/* Tap Orders */}\n            {pendingTapOrders.map((order) => {\n              const trigger = parseFloat(order.triggerPrice) / 100000000;\n              const collateral = parseFloat(order.collateral) / 1000000;\n              const startTime = new Date(order.startTime * 1000);\n\n              return (\n                <TableRow\n                  key={`tap-${order.id}`}\n                  className=\"hover:bg-gray-800/30 transition-colors group border-gray-800/50\"\n                >\n                  <TableCell>\n                    <span className=\"px-2 py-0.5 rounded text-[10px] font-bold bg-purple-500/10 text-purple-400\">\n                      TAP\n                    </span>\n                  </TableCell>\n                  <TableCell className=\"text-white font-medium\">\n                    <div className=\"flex items-center gap-2\">\n                      <img\n                        src={getLogoUrl(order.symbol)}\n                        alt={order.symbol}\n                        className=\"w-5 h-5 rounded-full\"\n                        onError={(e) => {\n                          (e.target as HTMLImageElement).src =\n                            'https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/info/logo.png';\n                        }}\n                      />\n                      {order.symbol}\n                    </div>\n                  </TableCell>\n                  <TableCell>\n                    <span\n                      className={`font-medium ${order.isLong ? 'text-green-400' : 'text-red-400'}`}\n                    >\n                      {order.isLong ? 'Long' : 'Short'}\n                    </span>\n                  </TableCell>\n                  <TableCell className=\"text-right text-white font-mono\">\n                    $\n                    {trigger.toLocaleString(undefined, {\n                      minimumFractionDigits: 2,\n                      maximumFractionDigits: 2,\n                    })}\n                  </TableCell>\n                  <TableCell className=\"text-right text-white font-mono\">\n                    ${collateral.toFixed(2)}\n                  </TableCell>\n                  <TableCell className=\"text-right text-white font-mono\">\n                    {order.leverage}x\n                  </TableCell>\n                  <TableCell className=\"text-right text-xs text-gray-500\">\n                    {startTime.toLocaleTimeString()}\n                  </TableCell>\n                  <TableCell className=\"text-right\">\n                    <button\n                      onClick={() => handleCancelTap(order.id)}\n                      disabled={cancellingOrders.has(order.id)}\n                      className=\"text-red-500 hover:text-red-400 text-xs font-medium transition-colors disabled:opacity-50\"\n                    >\n                      {cancellingOrders.has(order.id) ? '...' : 'Cancel'}\n                    </button>\n                  </TableCell>\n                </TableRow>\n              );\n            })}\n          </TableBody>\n        </Table>\n      </div>\n\n      {/* Mobile View: Cards */}\n      <div className=\"md:hidden space-y-4 p-4 overflow-y-auto flex-1\">\n        {/* Limit Orders Cards */}\n        {limitOrders.map((order) => (\n          <MobileOpenOrderCard\n            key={`limit-card-${order.id.toString()}`}\n            order={order}\n            type=\"LIMIT\"\n            onCancel={handleCancelLimit}\n            isCancelling={isCancellingLimit}\n          />\n        ))}\n\n        {/* Tap Orders Cards */}\n        {pendingTapOrders.map((order) => (\n          <MobileOpenOrderCard\n            key={`tap-card-${order.id}`}\n            order={order}\n            type=\"TAP\"\n            onCancel={handleCancelTap}\n            isCancelling={cancellingOrders.has(order.id)}\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 12783, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/hooks/useBinaryOrders.ts"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { useEmbeddedWallet } from '@/features/wallet/hooks/useEmbeddedWallet';\n\nconst BACKEND_URL = process.env.NEXT_PUBLIC_BACKEND_URL || 'http://localhost:3001';\n\nexport interface BinaryOrder {\n  betId: string;\n  symbol: string;\n  direction: 'UP' | 'DOWN';\n  betAmount: string | number;\n  targetPrice: string;\n  entryPrice: string;\n  entryTime: number;\n  targetTime: number;\n  multiplier: number;\n  status: 'ACTIVE' | 'WON' | 'LOST' | 'CANCELLED';\n  settledAt?: number;\n  settlePrice?: string;\n  createdAt: number;\n}\n\nexport function useBinaryOrders() {\n  const [orders, setOrders] = useState<BinaryOrder[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const { address } = useEmbeddedWallet();\n\n  const fetchOrders = async () => {\n    if (!address) {\n      setIsLoading(false);\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      const url = `${BACKEND_URL}/api/one-tap/bets?trader=${address}`;\n      const response = await fetch(url);\n\n      if (response.ok) {\n        const data = await response.json();\n\n        if (data.success && data.data) {\n          // Transform backend data to component format\n          const transformedOrders = data.data.map((bet: any) => {\n            const entryPrice = parseFloat(bet.entryPrice) / 100000000; // 8 decimals\n            const targetPrice = parseFloat(bet.targetPrice) / 100000000; // 8 decimals\n            const direction = targetPrice > entryPrice ? 'UP' : 'DOWN';\n\n            return {\n              ...bet,\n              direction,\n            };\n          });\n          setOrders(transformedOrders);\n        } else {\n          setOrders([]);\n        }\n      } else {\n        setOrders([]);\n      }\n    } catch (error) {\n      console.error('❌ Error fetching binary orders:', error);\n      setOrders([]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchOrders();\n\n    // Poll every 3 seconds to get updates\n    const interval = setInterval(fetchOrders, 3000);\n    return () => clearInterval(interval);\n  }, [address]);\n\n  return {\n    orders,\n    isLoading,\n    refetch: fetchOrders,\n  };\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,uBAAuB,IAAI;AAkBpD,SAAS;IACd,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAgB,EAAE;IACtD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,EAAE,OAAO,EAAE,GAAG,IAAA,4KAAiB;IAErC,MAAM,cAAc;QAClB,IAAI,CAAC,SAAS;YACZ,aAAa;YACb;QACF;QAEA,IAAI;YACF,aAAa;YACb,MAAM,MAAM,GAAG,YAAY,yBAAyB,EAAE,SAAS;YAC/D,MAAM,WAAW,MAAM,MAAM;YAE7B,IAAI,SAAS,EAAE,EAAE;gBACf,MAAM,OAAO,MAAM,SAAS,IAAI;gBAEhC,IAAI,KAAK,OAAO,IAAI,KAAK,IAAI,EAAE;oBAC7B,6CAA6C;oBAC7C,MAAM,oBAAoB,KAAK,IAAI,CAAC,GAAG,CAAC,CAAC;wBACvC,MAAM,aAAa,WAAW,IAAI,UAAU,IAAI,WAAW,aAAa;wBACxE,MAAM,cAAc,WAAW,IAAI,WAAW,IAAI,WAAW,aAAa;wBAC1E,MAAM,YAAY,cAAc,aAAa,OAAO;wBAEpD,OAAO;4BACL,GAAG,GAAG;4BACN;wBACF;oBACF;oBACA,UAAU;gBACZ,OAAO;oBACL,UAAU,EAAE;gBACd;YACF,OAAO;gBACL,UAAU,EAAE;YACd;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,mCAAmC;YACjD,UAAU,EAAE;QACd,SAAU;YACR,aAAa;QACf;IACF;IAEA,IAAA,kNAAS,EAAC;QACR;QAEA,sCAAsC;QACtC,MAAM,WAAW,YAAY,aAAa;QAC1C,OAAO,IAAM,cAAc;IAC7B,GAAG;QAAC;KAAQ;IAEZ,OAAO;QACL;QACA;QACA,SAAS;IACX;AACF"}},
    {"offset": {"line": 12850, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/MobileOneTapOrderCard.tsx"],"sourcesContent":["import React from 'react';\nimport { formatMarketPair } from '@/features/trading/lib/marketUtils';\nimport { calculateMultiplier } from '@/components/charts/PerSecondChart/utils';\nimport { ALL_MARKETS } from '@/features/trading/constants/markets';\n\ninterface MobileOneTapOrderCardProps {\n  order: any;\n}\n\nconst MobileOneTapOrderCard = ({ order }: MobileOneTapOrderCardProps) => {\n  const getLogoUrl = (symbol: string) => {\n    const market = ALL_MARKETS.find((m) => m.symbol === symbol || m.binanceSymbol === symbol);\n    return (\n      market?.logoUrl ||\n      `https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/info/logo.png`\n    );\n  };\n\n  // Parse bet amount\n  let betAmount = 0;\n  if (typeof order.betAmount === 'string') {\n    const parsed = parseFloat(order.betAmount);\n    betAmount = isNaN(parsed) ? 0 : parsed;\n  } else if (typeof order.betAmount === 'number') {\n    betAmount = order.betAmount;\n  }\n\n  // Parse prices for calculation\n  const entryPriceNum = parseFloat(order.entryPrice) / 100000000;\n  const targetPriceNum = parseFloat(order.targetPrice) / 100000000;\n\n  // Recalculate multiplier\n  const displayMultiplier = calculateMultiplier(\n    entryPriceNum,\n    targetPriceNum,\n    order.entryTime,\n    order.targetTime,\n  );\n\n  return (\n    <div className=\"bg-[#131B26] p-4 rounded-lg border border-gray-800 space-y-3\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-3\">\n          <img\n            src={getLogoUrl(order.symbol)}\n            alt={order.symbol}\n            className=\"w-8 h-8 rounded-full bg-slate-800\"\n            onError={(e) => {\n              (e.target as HTMLImageElement).style.visibility = 'hidden';\n            }}\n          />\n          <div>\n            <span className=\"font-bold text-white text-base block\">\n              {formatMarketPair(order.symbol)}\n            </span>\n          </div>\n        </div>\n        <div className=\"text-right\">\n          <div className=\"text-lg font-bold text-blue-300\">\n            {(displayMultiplier / 100).toFixed(2)}x\n          </div>\n          <div className=\"text-xs text-yellow-500 font-medium\">Active</div>\n        </div>\n      </div>\n\n      {/* Details */}\n      <div className=\"grid grid-cols-2 gap-4 text-xs border-t border-gray-800 pt-3\">\n        <div className=\"flex justify-between\">\n          <span className=\"text-gray-500\">Bet Amount</span>\n          <span className=\"text-white font-medium\">${betAmount.toFixed(2)}</span>\n        </div>\n        <div className=\"flex justify-between\">\n          <span className=\"text-gray-500\">Target Time</span>\n          <span className=\"text-white font-mono\">\n            {new Date(order.targetTime * 1000).toLocaleTimeString()}\n          </span>\n        </div>\n        <div className=\"flex justify-between\">\n          <span className=\"text-gray-500\">Entry Price</span>\n          <span className=\"text-white font-mono\">${entryPriceNum.toLocaleString()}</span>\n        </div>\n        <div className=\"flex justify-between\">\n          <span className=\"text-gray-500\">Target Price</span>\n          <span className=\"text-white font-mono\">${targetPriceNum.toLocaleString()}</span>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default MobileOneTapOrderCard;\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;;;;;AAMA,MAAM,wBAAwB,CAAC,EAAE,KAAK,EAA8B;IAClE,MAAM,aAAa,CAAC;QAClB,MAAM,SAAS,iKAAW,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,MAAM,KAAK,UAAU,EAAE,aAAa,KAAK;QAClF,OACE,QAAQ,WACR,CAAC,8FAA8F,CAAC;IAEpG;IAEA,mBAAmB;IACnB,IAAI,YAAY;IAChB,IAAI,OAAO,MAAM,SAAS,KAAK,UAAU;QACvC,MAAM,SAAS,WAAW,MAAM,SAAS;QACzC,YAAY,MAAM,UAAU,IAAI;IAClC,OAAO,IAAI,OAAO,MAAM,SAAS,KAAK,UAAU;QAC9C,YAAY,MAAM,SAAS;IAC7B;IAEA,+BAA+B;IAC/B,MAAM,gBAAgB,WAAW,MAAM,UAAU,IAAI;IACrD,MAAM,iBAAiB,WAAW,MAAM,WAAW,IAAI;IAEvD,yBAAyB;IACzB,MAAM,oBAAoB,IAAA,6KAAmB,EAC3C,eACA,gBACA,MAAM,SAAS,EACf,MAAM,UAAU;IAGlB,qBACE,8OAAC;QAAI,WAAU;;0BAEb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCACC,KAAK,WAAW,MAAM,MAAM;gCAC5B,KAAK,MAAM,MAAM;gCACjB,WAAU;gCACV,SAAS,CAAC;oCACP,EAAE,MAAM,CAAsB,KAAK,CAAC,UAAU,GAAG;gCACpD;;;;;;0CAEF,8OAAC;0CACC,cAAA,8OAAC;oCAAK,WAAU;8CACb,IAAA,oKAAgB,EAAC,MAAM,MAAM;;;;;;;;;;;;;;;;;kCAIpC,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;oCACZ,CAAC,oBAAoB,GAAG,EAAE,OAAO,CAAC;oCAAG;;;;;;;0CAExC,8OAAC;gCAAI,WAAU;0CAAsC;;;;;;;;;;;;;;;;;;0BAKzD,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAK,WAAU;0CAAgB;;;;;;0CAChC,8OAAC;gCAAK,WAAU;;oCAAyB;oCAAE,UAAU,OAAO,CAAC;;;;;;;;;;;;;kCAE/D,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAK,WAAU;0CAAgB;;;;;;0CAChC,8OAAC;gCAAK,WAAU;0CACb,IAAI,KAAK,MAAM,UAAU,GAAG,MAAM,kBAAkB;;;;;;;;;;;;kCAGzD,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAK,WAAU;0CAAgB;;;;;;0CAChC,8OAAC;gCAAK,WAAU;;oCAAuB;oCAAE,cAAc,cAAc;;;;;;;;;;;;;kCAEvE,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAK,WAAU;0CAAgB;;;;;;0CAChC,8OAAC;gCAAK,WAAU;;oCAAuB;oCAAE,eAAe,cAAc;;;;;;;;;;;;;;;;;;;;;;;;;AAKhF;uCAEe"}},
    {"offset": {"line": 13085, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/OneTapProfitTab.tsx"],"sourcesContent":["import { useBinaryOrders } from '@/features/trading/hooks/useBinaryOrders';\nimport { formatMarketPair } from '@/features/trading/lib/marketUtils';\nimport { calculateMultiplier } from '@/components/charts/PerSecondChart/utils';\nimport { ALL_MARKETS } from '@/features/trading/constants/markets';\nimport MobileOneTapOrderCard from './MobileOneTapOrderCard';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\n\nexport default function OneTapProfitTab() {\n  const { orders, isLoading } = useBinaryOrders();\n\n  // Filter for ACTIVE orders only\n  const activeOrders = orders.filter((o) => o.status === 'ACTIVE');\n\n  // Helper to get logo URL\n  const getLogoUrl = (symbol: string) => {\n    const market = ALL_MARKETS.find((m) => m.symbol === symbol || m.binanceSymbol === symbol);\n    return (\n      market?.logoUrl ||\n      `https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/info/logo.png`\n    );\n  };\n\n  if (isLoading && orders.length === 0) {\n    return <div className=\"text-center py-16 text-gray-500\">Loading active bets...</div>;\n  }\n\n  if (activeOrders.length === 0) {\n    return (\n      <div className=\"text-center py-16 text-gray-500\">\n        No active bets. Place a One Tap Profit bet to see it here.\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-full flex flex-col\">\n      {/* Desktop View: Table */}\n      <div className=\"hidden md:block overflow-x-auto\">\n        <Table>\n          <TableHeader className=\"bg-[#0B1017] sticky top-0 z-10\">\n            <TableRow className=\"border-b border-gray-800 hover:bg-transparent\">\n              <TableHead className=\"font-medium\">MARKET</TableHead>\n              <TableHead className=\"text-right font-medium\">BET AMOUNT</TableHead>\n              <TableHead className=\"text-right font-medium\">MULTIPLIER</TableHead>\n              <TableHead className=\"text-right font-medium\">STATUS</TableHead>\n              <TableHead className=\"text-right font-medium\">EXPIRES</TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {activeOrders.map((order) => {\n              // Parse bet amount\n              let betAmount = 0;\n              if (typeof order.betAmount === 'string') {\n                const parsed = parseFloat(order.betAmount);\n                betAmount = isNaN(parsed) ? 0 : parsed;\n              } else if (typeof order.betAmount === 'number') {\n                betAmount = order.betAmount;\n              }\n\n              // Parse prices for calculation\n              const entryPriceNum = parseFloat(order.entryPrice) / 100000000;\n              const targetPriceNum = parseFloat(order.targetPrice) / 100000000;\n\n              // Recalculate multiplier\n              const displayMultiplier = calculateMultiplier(\n                entryPriceNum,\n                targetPriceNum,\n                order.entryTime,\n                order.targetTime,\n              );\n\n              return (\n                <TableRow\n                  key={order.betId}\n                  className=\"hover:bg-gray-800/30 transition-colors border-gray-800/50\"\n                >\n                  {/* Market */}\n                  <TableCell>\n                    <div className=\"flex items-center gap-2\">\n                      <img\n                        src={getLogoUrl(order.symbol)}\n                        alt={order.symbol}\n                        className=\"w-5 h-5 rounded-full\"\n                        onError={(e) => {\n                          (e.target as HTMLImageElement).src =\n                            'https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/info/logo.png';\n                        }}\n                      />\n                      <div className=\"flex flex-col\">\n                        <span className=\"font-semibold text-white\">\n                          {formatMarketPair(order.symbol)}\n                        </span>\n                      </div>\n                    </div>\n                  </TableCell>\n\n                  {/* Bet Amount */}\n                  <TableCell className=\"text-right\">\n                    <span className=\"text-white font-medium\">\n                      ${betAmount > 0 ? betAmount.toFixed(2) : '0.00'}\n                    </span>\n                  </TableCell>\n\n                  {/* Multiplier */}\n                  <TableCell className=\"text-right\">\n                    <span className=\"text-blue-300 font-bold\">\n                      {(displayMultiplier / 100).toFixed(2)}x\n                    </span>\n                  </TableCell>\n\n                  {/* Status */}\n                  <TableCell className=\"text-right\">\n                    <span className=\"font-bold text-yellow-400 bg-yellow-400/10 px-2 py-0.5 rounded text-xs\">\n                      {order.status}\n                    </span>\n                  </TableCell>\n\n                  {/* Time */}\n                  <TableCell className=\"text-right\">\n                    <span className=\"text-yellow-400 text-xs font-mono\">\n                      {new Date(order.targetTime * 1000).toLocaleTimeString()}\n                    </span>\n                  </TableCell>\n                </TableRow>\n              );\n            })}\n          </TableBody>\n        </Table>\n      </div>\n\n      {/* Mobile View: Cards */}\n      <div className=\"md:hidden space-y-4 p-4 overflow-y-auto flex-1\">\n        {activeOrders.map((order) => (\n          <MobileOneTapOrderCard key={`onetap-card-${order.betId}`} order={order} />\n        ))}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 13369, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/MobileHistoryCard.tsx"],"sourcesContent":["import React from 'react';\nimport { formatMarketPair } from '@/features/trading/lib/marketUtils';\nimport { calculateMultiplier } from '@/components/charts/PerSecondChart/utils';\nimport { ALL_MARKETS } from '@/features/trading/constants/markets';\n\ninterface MobileHistoryCardProps {\n  item: any;\n}\n\nconst MobileHistoryCard = ({ item }: MobileHistoryCardProps) => {\n  const getLogoUrl = (symbol: string) => {\n    const market = ALL_MARKETS.find((m) => m.symbol === symbol || m.binanceSymbol === symbol);\n    return (\n      market?.logoUrl ||\n      `https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/info/logo.png`\n    );\n  };\n\n  const isTap = item.type === 'TAP';\n  const date = new Date(item.time * 1000);\n\n  let resultDisplay = '-';\n  let statusColor = 'text-gray-400';\n  let betMarginDisplay = '-';\n\n  // Status Logic\n  if (['WON', 'EXECUTED'].includes(item.status)) statusColor = 'text-green-400';\n  else if (['LOST', 'FAILED'].includes(item.status)) statusColor = 'text-red-400';\n  else if (['CANCELLED', 'EXPIRED'].includes(item.status)) statusColor = 'text-orange-400';\n\n  if (isTap) {\n    let amount = 0;\n    if (typeof item.collateral === 'string') amount = parseFloat(item.collateral) / 1000000;\n    else if (typeof item.collateral === 'bigint') amount = Number(item.collateral) / 1000000;\n    else if (typeof item.collateral === 'number') amount = item.collateral / 1000000;\n    betMarginDisplay = `$${amount.toFixed(2)}`;\n\n    if (item.status === 'EXECUTED' && item.executedTxHash) {\n      resultDisplay = 'View Tx';\n    }\n  } else {\n    let amount = 0;\n    if (typeof item.betAmount === 'string') amount = parseFloat(item.betAmount);\n    else if (typeof item.betAmount === 'number') amount = item.betAmount;\n    betMarginDisplay = `$${amount.toFixed(2)}`;\n\n    const entry = parseFloat(item.entryPrice) / 100000000;\n    const target = parseFloat(item.targetPrice) / 100000000;\n    const mult = calculateMultiplier(entry, target, item.entryTime, item.targetTime);\n    const multDisplay = (mult / 100).toFixed(2);\n\n    if (item.status === 'WON') {\n      const payout = amount * (mult / 100);\n      const profit = payout - amount;\n      resultDisplay = `+$${profit.toFixed(2)} (${multDisplay}x)`;\n    } else if (item.status === 'LOST') {\n      resultDisplay = `-$${amount.toFixed(2)}`;\n    }\n  }\n\n  return (\n    <div className=\"bg-[#131B26] p-4 rounded-lg border border-gray-800 space-y-3\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-3\">\n          <img\n            src={getLogoUrl(item.symbol)}\n            alt={item.symbol}\n            className=\"w-8 h-8 rounded-full bg-slate-800\"\n            onError={(e) => {\n              (e.target as HTMLImageElement).style.visibility = 'hidden';\n            }}\n          />\n          <div>\n            <span className=\"font-bold text-white text-base block\">\n              {formatMarketPair(item.symbol)}\n            </span>\n            <span\n              className={`text-[10px] font-bold px-1.5 py-0.5 rounded ${\n                isTap ? 'bg-purple-500/10 text-purple-400' : 'bg-orange-500/10 text-orange-400'\n              }`}\n            >\n              {isTap ? 'OPEN POS' : '1-TAP'}\n            </span>\n          </div>\n        </div>\n        <div className=\"text-right\">\n          <div className={`text-sm font-bold ${statusColor}`}>{item.status}</div>\n          <div className=\"text-xs text-gray-500\">{date.toLocaleTimeString()}</div>\n        </div>\n      </div>\n\n      {/* Details */}\n      <div className=\"grid grid-cols-2 gap-4 text-xs border-t border-gray-800 pt-3\">\n        <div className=\"flex justify-between\">\n          <span className=\"text-gray-500\">Margin/Bet</span>\n          <span className=\"text-white font-medium\">{betMarginDisplay}</span>\n        </div>\n        <div className=\"flex justify-between\">\n          <span className=\"text-gray-500\">Result</span>\n          <span\n            className={`${\n              item.status === 'WON'\n                ? 'text-green-400'\n                : item.status === 'LOST'\n                  ? 'text-red-400'\n                  : 'text-gray-400'\n            } font-medium`}\n          >\n            {resultDisplay === 'View Tx' ? (\n              <a\n                href={`https://sepolia.basescan.org/tx/${item.executedTxHash}`}\n                target=\"_blank\"\n                rel=\"noreferrer\"\n                className=\"text-blue-400 underline\"\n              >\n                Tx\n              </a>\n            ) : (\n              resultDisplay\n            )}\n          </span>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default MobileHistoryCard;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 13593, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/orders/HistoryTab.tsx"],"sourcesContent":["import { useState } from 'react';\nimport { useTapToTradeOrders } from '@/features/trading/hooks/useTapToTradeOrders';\nimport { useBinaryOrders } from '@/features/trading/hooks/useBinaryOrders';\nimport { formatMarketPair } from '@/features/trading/lib/marketUtils';\nimport { calculateMultiplier } from '@/components/charts/PerSecondChart/utils';\nimport { ALL_MARKETS } from '@/features/trading/constants/markets';\nimport MobileHistoryCard from './MobileHistoryCard';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\n\nexport default function HistoryTab() {\n  const { orders: tapOrders, isLoading: isLoadingTap } = useTapToTradeOrders();\n  const { orders: binaryOrders, isLoading: isLoadingBinary } = useBinaryOrders();\n\n  const [filter, setFilter] = useState<'ALL' | 'TAP' | 'BINARY'>('ALL');\n\n  // Filter Tap Orders (Executed, Cancelled, Expired, Failed)\n  const tapHistory = tapOrders.filter((o) =>\n    ['EXECUTED', 'CANCELLED', 'EXPIRED', 'FAILED'].includes(o.status),\n  );\n\n  // Filter Binary Orders (Won, Lost, Cancelled)\n  const binaryHistory = binaryOrders.filter((o) => ['WON', 'LOST', 'CANCELLED'].includes(o.status));\n\n  const isLoading = isLoadingTap || isLoadingBinary;\n\n  // Helper to get logo URL\n  const getLogoUrl = (symbol: string) => {\n    const market = ALL_MARKETS.find((m) => m.symbol === symbol || m.binanceSymbol === symbol);\n    return (\n      market?.logoUrl ||\n      `https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/info/logo.png`\n    );\n  };\n\n  if (isLoading && tapHistory.length === 0 && binaryHistory.length === 0) {\n    return <div className=\"text-center py-16 text-gray-500\">Loading history...</div>;\n  }\n\n  if (tapHistory.length === 0 && binaryHistory.length === 0) {\n    return <div className=\"text-center py-16 text-gray-500\">No history found.</div>;\n  }\n\n  // Combine and Sort by Created Date (Desc)\n  const combinedHistory = [\n    ...tapHistory.map((o) => ({ ...o, type: 'TAP', time: o.createdAt })),\n    ...binaryHistory.map((o) => ({ ...o, type: 'BINARY', time: o.createdAt })),\n  ].sort((a, b) => b.time - a.time);\n\n  const filteredHistory =\n    filter === 'ALL' ? combinedHistory : combinedHistory.filter((o) => o.type === filter);\n\n  return (\n    <div className=\"h-full flex flex-col\">\n      {/* Filter Bar */}\n      <div className=\"flex gap-4 p-4 border-b border-gray-800/50 overflow-x-auto no-scrollbar items-center\">\n        <button\n          onClick={() => setFilter('ALL')}\n          className={`px-4 py-2 text-sm rounded-lg font-bold transition-all shrink-0 ${\n            filter === 'ALL'\n              ? 'bg-blue-500 text-white shadow-lg shadow-blue-500/20'\n              : 'bg-gray-800/50 text-gray-400 hover:bg-gray-800 hover:text-gray-200'\n          }`}\n        >\n          All History\n        </button>\n        <button\n          onClick={() => setFilter('BINARY')}\n          className={`px-4 py-2 text-sm rounded-lg font-bold transition-all shrink-0 ${\n            filter === 'BINARY'\n              ? 'bg-orange-500 text-white shadow-lg shadow-orange-500/20'\n              : 'bg-gray-800/50 text-gray-400 hover:bg-gray-800 hover:text-gray-200'\n          }`}\n        >\n          One Tap Profit\n        </button>\n        <button\n          onClick={() => setFilter('TAP')}\n          className={`px-4 py-2 text-sm rounded-lg font-bold transition-all shrink-0 ${\n            filter === 'TAP'\n              ? 'bg-purple-500 text-white shadow-lg shadow-purple-500/20'\n              : 'bg-gray-800/50 text-gray-400 hover:bg-gray-800 hover:text-gray-200'\n          }`}\n        >\n          Open Position\n        </button>\n      </div>\n\n      {/* Desktop View: Table */}\n      <div className=\"hidden md:block overflow-x-auto\">\n        <Table>\n          <TableHeader className=\"bg-[#0B1017] sticky top-0 z-10\">\n            <TableRow className=\"border-b border-gray-800 hover:bg-transparent\">\n              <TableHead className=\"font-medium\">Type</TableHead>\n              <TableHead className=\"font-medium\">Symbol</TableHead>\n              <TableHead className=\"text-right font-medium\">Bet Margin</TableHead>\n              <TableHead className=\"text-right font-medium\">Result (Win)</TableHead>\n              <TableHead className=\"text-right font-medium\">Status</TableHead>\n              <TableHead className=\"text-right font-medium\">Time</TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {filteredHistory.map((item: any) => {\n              const isTap = item.type === 'TAP';\n              const date = new Date(item.time * 1000);\n\n              let resultDisplay = '-';\n              let statusColor = 'text-gray-400';\n\n              // Bet Margin / Size\n              let betMarginDisplay = '-';\n\n              // Status Color Logic\n              if (['WON', 'EXECUTED'].includes(item.status)) statusColor = 'text-green-400';\n              else if (['LOST', 'FAILED'].includes(item.status)) statusColor = 'text-red-400';\n              else if (['CANCELLED', 'EXPIRED'].includes(item.status))\n                statusColor = 'text-orange-400';\n\n              if (isTap) {\n                // Collateral for Tap\n                // Collateral comes as wei string usually\n                let amount = 0;\n                if (typeof item.collateral === 'string')\n                  amount = parseFloat(item.collateral) / 1000000;\n                else if (typeof item.collateral === 'bigint')\n                  amount = Number(item.collateral) / 1000000;\n                else if (typeof item.collateral === 'number') amount = item.collateral / 1000000;\n\n                betMarginDisplay = `$${amount.toFixed(2)}`;\n\n                // Tap: Show Tx Link or -\n                if (item.status === 'EXECUTED' && item.executedTxHash) {\n                  resultDisplay = 'View Tx';\n                }\n              } else {\n                // Bet Amount for Binary\n                let amount = 0;\n                if (typeof item.betAmount === 'string') amount = parseFloat(item.betAmount);\n                else if (typeof item.betAmount === 'number') amount = item.betAmount;\n\n                betMarginDisplay = `$${amount.toFixed(2)}`;\n\n                // Binary: Show Profit (Multiplier)\n                const entry = parseFloat(item.entryPrice) / 100000000;\n                const target = parseFloat(item.targetPrice) / 100000000;\n                const mult = calculateMultiplier(entry, target, item.entryTime, item.targetTime);\n                const multDisplay = (mult / 100).toFixed(2);\n\n                if (item.status === 'WON') {\n                  // Profit = Total Payout - Bet Amount\n                  // Payout = Amount * (Mult/100)\n                  const payout = amount * (mult / 100);\n                  const profit = payout - amount;\n                  resultDisplay = `+$${profit.toFixed(2)} (${multDisplay}x)`;\n                } else if (item.status === 'LOST') {\n                  resultDisplay = `-$${amount.toFixed(2)} (-1.00x)`;\n                }\n              }\n\n              return (\n                <TableRow\n                  key={`${item.type}-${item.id || item.betId}`}\n                  className=\"hover:bg-gray-800/30 transition-colors border-gray-800/50\"\n                >\n                  <TableCell>\n                    {isTap ? (\n                      <span className=\"px-2 py-0.5 rounded text-[10px] font-bold bg-purple-500/10 text-purple-400\">\n                        OPEN POS\n                      </span>\n                    ) : (\n                      <span className=\"px-2 py-0.5 rounded text-[10px] font-bold bg-orange-500/10 text-orange-400\">\n                        1-TAP\n                      </span>\n                    )}\n                  </TableCell>\n                  <TableCell className=\"text-white font-medium\">\n                    <div className=\"flex items-center gap-2\">\n                      <img\n                        src={getLogoUrl(item.symbol)}\n                        alt={item.symbol}\n                        className=\"w-5 h-5 rounded-full\"\n                        onError={(e) => {\n                          (e.target as HTMLImageElement).src =\n                            'https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/info/logo.png';\n                        }}\n                      />\n                      {formatMarketPair(item.symbol)}\n                    </div>\n                  </TableCell>\n\n                  {/* Bet Margin */}\n                  <TableCell className=\"text-right font-mono text-white\">\n                    {betMarginDisplay}\n                  </TableCell>\n\n                  {/* Result */}\n                  <TableCell className=\"text-right font-mono text-white\">\n                    {resultDisplay === 'View Tx' ? (\n                      <a\n                        href={`https://sepolia.basescan.org/tx/${item.executedTxHash}`}\n                        target=\"_blank\"\n                        rel=\"noreferrer\"\n                        className=\"text-blue-400 underline hover:text-blue-300\"\n                      >\n                        View Tx\n                      </a>\n                    ) : (\n                      <span\n                        className={\n                          item.status === 'WON'\n                            ? 'text-green-400'\n                            : item.status === 'LOST'\n                              ? 'text-red-400'\n                              : 'text-gray-500'\n                        }\n                      >\n                        {resultDisplay}\n                      </span>\n                    )}\n                  </TableCell>\n                  <TableCell className={`text-right font-bold text-xs ${statusColor}`}>\n                    {item.status}\n                  </TableCell>\n                  <TableCell className=\"text-right text-xs text-gray-500\">\n                    {date.toLocaleString()}\n                  </TableCell>\n                </TableRow>\n              );\n            })}\n          </TableBody>\n        </Table>\n      </div>\n\n      {/* Mobile View: Cards */}\n      <div className=\"md:hidden space-y-4 p-4 overflow-y-auto flex-1\">\n        {filteredHistory.map((item: any) => (\n          <MobileHistoryCard\n            key={`history-card-${item.type}-${item.id || item.betId}`}\n            item={item}\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 13983, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/trade-content/MobileMarketDetails.tsx"],"sourcesContent":["import Image from 'next/image';\nimport React from 'react';\n\ninterface MarketData {\n  priceChangePercent?: string;\n  high24h?: string;\n  low24h?: string;\n  volume24h?: string;\n  openInterestValue?: string;\n}\n\ninterface ActiveMarket {\n  symbol?: string;\n  logoUrl?: string;\n}\n\ninterface MobileMarketDetailsProps {\n  isOpen: boolean;\n  marketData: MarketData | null;\n  activeMarket: ActiveMarket | null;\n  currentPrice: string | null;\n}\n\nexport default function MobileMarketDetails({\n  isOpen,\n  marketData,\n  activeMarket,\n  currentPrice,\n}: MobileMarketDetailsProps) {\n  if (!isOpen) return null;\n\n  return (\n    <div\n      className=\"lg:hidden absolute left-0 right-0 bg-trading-panel border-b border-border-default shadow-lg z-20 animate-slide-down\"\n      style={{ top: '60px' }}\n    >\n      {/* Market Info Content */}\n      <div className=\"p-3 relative\">\n        {/* Coin Logo - Top Right */}\n        {activeMarket && (\n          <Image\n            src={`${activeMarket.logoUrl}`}\n            alt={`${activeMarket.symbol}`}\n            className=\"absolute top-2 right-2 w-10 h-10 rounded-full bg-trading-surface ring-2 ring-border-light\"\n            onError={(e) => {\n              const target = e.currentTarget;\n              target.onerror = null;\n              target.style.visibility = 'hidden';\n            }}\n          />\n        )}\n\n        {/* Price Info Grid */}\n        <div className=\"grid grid-cols-2 gap-3\">\n          <div>\n            <div className=\"text-xs text-text-secondary mb-1\">Current Price</div>\n            <div className=\"text-sm font-mono font-semibold text-text-primary\">\n              {currentPrice\n                ? `$${parseFloat(currentPrice).toLocaleString('en-US', {\n                    minimumFractionDigits: 2,\n                    maximumFractionDigits: 2,\n                  })}`\n                : '$--'}\n            </div>\n          </div>\n          <div>\n            <div className=\"text-xs text-text-secondary mb-1\">24h Change</div>\n            <div\n              className={`text-sm font-mono font-semibold ${\n                marketData?.priceChangePercent\n                  ? parseFloat(marketData.priceChangePercent) >= 0\n                    ? 'text-success'\n                    : 'text-error'\n                  : 'text-text-muted'\n              }`}\n            >\n              {marketData?.priceChangePercent\n                ? `${parseFloat(marketData.priceChangePercent) >= 0 ? '+' : ''}${parseFloat(\n                    marketData.priceChangePercent,\n                  ).toFixed(2)}%`\n                : '+0.00%'}\n            </div>\n          </div>\n          <div>\n            <div className=\"text-xs text-text-secondary mb-1\">24h High</div>\n            <div className=\"text-xs font-mono text-text-primary\">\n              {marketData?.high24h\n                ? `$${parseFloat(marketData.high24h).toLocaleString('en-US', {\n                    minimumFractionDigits: 2,\n                    maximumFractionDigits: 2,\n                  })}`\n                : '$--'}\n            </div>\n          </div>\n          <div>\n            <div className=\"text-xs text-text-secondary mb-1\">24h Low</div>\n            <div className=\"text-xs font-mono text-text-primary\">\n              {marketData?.low24h\n                ? `$${parseFloat(marketData.low24h).toLocaleString('en-US', {\n                    minimumFractionDigits: 2,\n                    maximumFractionDigits: 2,\n                  })}`\n                : '$--'}\n            </div>\n          </div>\n          <div>\n            <div className=\"text-xs text-text-secondary mb-1\">24h Volume</div>\n            <div className=\"text-xs font-mono text-text-primary\">\n              {marketData?.volume24h\n                ? (() => {\n                    const vol = parseFloat(marketData.volume24h);\n                    if (vol >= 1e9) return `$${(vol / 1e9).toFixed(2)}B`;\n                    if (vol >= 1e6) return `$${(vol / 1e6).toFixed(2)}M`;\n                    if (vol >= 1e3) return `$${(vol / 1e3).toFixed(2)}K`;\n                    return `$${vol.toFixed(2)}`;\n                  })()\n                : '--'}\n            </div>\n          </div>\n          <div>\n            <div className=\"text-xs text-text-secondary mb-1\">Open Interest</div>\n            <div className=\"text-xs font-mono text-text-primary\">\n              {marketData?.openInterestValue\n                ? (() => {\n                    const oi = parseFloat(marketData.openInterestValue);\n                    if (oi >= 1e9) return `$${(oi / 1e9).toFixed(2)}B`;\n                    if (oi >= 1e6) return `$${(oi / 1e6).toFixed(2)}M`;\n                    if (oi >= 1e3) return `$${(oi / 1e3).toFixed(2)}K`;\n                    return `$${oi.toFixed(2)}`;\n                  })()\n                : '--'}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 14205, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/trade-content/MobileOrderTabs.tsx"],"sourcesContent":["import React from 'react';\nimport { MousePointerClick, TrendingUp } from 'lucide-react';\n\ninterface MobileOrderTabsProps {\n  mobileActiveTab?: 'long' | 'short' | 'swap';\n  onTabClick?: (tab: 'long' | 'short' | 'swap') => void;\n  mode?: 'market' | 'trade';\n  activeTradeMode?: 'open-position' | 'one-tap-profit';\n  onTradeModeClick?: (mode: 'open-position' | 'one-tap-profit') => void;\n}\n\nexport default function MobileOrderTabs({\n  mobileActiveTab,\n  onTabClick,\n  mode = 'market',\n  activeTradeMode,\n  onTradeModeClick,\n}: MobileOrderTabsProps) {\n  if (mode === 'trade') {\n    return (\n      <div className=\"flex items-center bg-trading-panel\">\n        <button\n          onClick={() => onTradeModeClick && onTradeModeClick('one-tap-profit')}\n          className={`flex-1 py-3.5 font-semibold text-sm transition-colors flex items-center justify-center gap-2 ${\n            activeTradeMode === 'one-tap-profit'\n              ? 'bg-success/20 text-success border-t-2 border-success'\n              : 'bg-trading-surface text-text-secondary hover:bg-button-hover border-t-2 border-transparent'\n          }`}\n        >\n          <MousePointerClick size={16} />\n          One Tap Profit\n        </button>\n        <button\n          onClick={() => onTradeModeClick && onTradeModeClick('open-position')}\n          className={`flex-1 py-3.5 font-semibold text-sm transition-colors flex items-center justify-center gap-2 ${\n            activeTradeMode === 'open-position'\n              ? 'bg-info/20 text-info border-t-2 border-info'\n              : 'bg-trading-surface text-text-secondary hover:bg-button-hover border-t-2 border-transparent'\n          }`}\n        >\n          <TrendingUp size={16} />\n          Open Position\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex items-center bg-trading-panel\">\n      <button\n        onClick={() => onTabClick && onTabClick('long')}\n        className={`flex-1 py-3.5 font-semibold text-sm transition-colors flex items-center justify-center gap-2 ${\n          mobileActiveTab === 'long'\n            ? 'bg-long text-text-primary hover:bg-long-active'\n            : 'bg-trading-surface text-text-secondary hover:bg-button-hover'\n        }`}\n      >\n        <svg\n          width=\"16\"\n          height=\"16\"\n          viewBox=\"0 0 24 24\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          strokeWidth=\"2\"\n        >\n          <polyline points=\"23 6 13.5 15.5 8.5 10.5 1 18\"></polyline>\n          <polyline points=\"17 6 23 6 23 12\"></polyline>\n        </svg>\n        Long\n      </button>\n      <button\n        onClick={() => onTabClick && onTabClick('short')}\n        className={`flex-1 py-3.5 font-semibold text-sm transition-colors flex items-center justify-center gap-2 ${\n          mobileActiveTab === 'short'\n            ? 'bg-short text-text-primary hover:bg-short-active'\n            : 'bg-trading-surface text-text-secondary hover:bg-button-hover'\n        }`}\n      >\n        <svg\n          width=\"16\"\n          height=\"16\"\n          viewBox=\"0 0 24 24\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          strokeWidth=\"2\"\n        >\n          <polyline points=\"23 18 13.5 8.5 8.5 13.5 1 6\"></polyline>\n          <polyline points=\"17 18 23 18 23 12\"></polyline>\n        </svg>\n        Short\n      </button>\n      <button\n        onClick={() => onTabClick && onTabClick('swap')}\n        className={`flex-1 py-3.5 font-semibold text-sm transition-colors flex items-center justify-center gap-2 ${\n          mobileActiveTab === 'swap'\n            ? 'bg-swap text-text-primary hover:bg-swap-active'\n            : 'bg-trading-surface text-text-secondary hover:bg-button-hover'\n        }`}\n      >\n        <svg\n          width=\"16\"\n          height=\"16\"\n          viewBox=\"0 0 24 24\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          strokeWidth=\"2\"\n        >\n          <path d=\"M13 2L3 14h9l-1 8 10-12h-9l1-8z\"></path>\n        </svg>\n        Swap\n      </button>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AAAA;;;AAUe,SAAS,gBAAgB,EACtC,eAAe,EACf,UAAU,EACV,OAAO,QAAQ,EACf,eAAe,EACf,gBAAgB,EACK;IACrB,IAAI,SAAS,SAAS;QACpB,qBACE,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBACC,SAAS,IAAM,oBAAoB,iBAAiB;oBACpD,WAAW,CAAC,6FAA6F,EACvG,oBAAoB,mBAChB,yDACA,8FACJ;;sCAEF,8OAAC,yPAAiB;4BAAC,MAAM;;;;;;wBAAM;;;;;;;8BAGjC,8OAAC;oBACC,SAAS,IAAM,oBAAoB,iBAAiB;oBACpD,WAAW,CAAC,6FAA6F,EACvG,oBAAoB,kBAChB,gDACA,8FACJ;;sCAEF,8OAAC,gOAAU;4BAAC,MAAM;;;;;;wBAAM;;;;;;;;;;;;;IAKhC;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBACC,SAAS,IAAM,cAAc,WAAW;gBACxC,WAAW,CAAC,6FAA6F,EACvG,oBAAoB,SAChB,mDACA,gEACJ;;kCAEF,8OAAC;wBACC,OAAM;wBACN,QAAO;wBACP,SAAQ;wBACR,MAAK;wBACL,QAAO;wBACP,aAAY;;0CAEZ,8OAAC;gCAAS,QAAO;;;;;;0CACjB,8OAAC;gCAAS,QAAO;;;;;;;;;;;;oBACb;;;;;;;0BAGR,8OAAC;gBACC,SAAS,IAAM,cAAc,WAAW;gBACxC,WAAW,CAAC,6FAA6F,EACvG,oBAAoB,UAChB,qDACA,gEACJ;;kCAEF,8OAAC;wBACC,OAAM;wBACN,QAAO;wBACP,SAAQ;wBACR,MAAK;wBACL,QAAO;wBACP,aAAY;;0CAEZ,8OAAC;gCAAS,QAAO;;;;;;0CACjB,8OAAC;gCAAS,QAAO;;;;;;;;;;;;oBACb;;;;;;;0BAGR,8OAAC;gBACC,SAAS,IAAM,cAAc,WAAW;gBACxC,WAAW,CAAC,6FAA6F,EACvG,oBAAoB,SAChB,mDACA,gEACJ;;kCAEF,8OAAC;wBACC,OAAM;wBACN,QAAO;wBACP,SAAQ;wBACR,MAAK;wBACL,QAAO;wBACP,aAAY;kCAEZ,cAAA,8OAAC;4BAAK,GAAE;;;;;;;;;;;oBACJ;;;;;;;;;;;;;AAKd"}},
    {"offset": {"line": 14384, "column": 0}, "map": {"version":3,"sources":["file:///home/naufalfzml/Projects/Hackathon/dash-baseindo/dash-fe/src/features/trading/components/market-content/MarketPageContent.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport Sidebar from '@/components/layout/ResponsiveSidebar';\nimport SidebarContent from '@/components/layout/SidebarContent';\nimport MobileHeader from '@/components/layout/MobileHeader';\nimport TradingChart from '@/features/trading/components/charts/TradingChart';\nimport OrderPanel from '@/features/trading/components/orders/OrderPanel';\nimport BottomTrading from '@/components/layout/BottomTrading';\nimport WalletConnectButton from '@/components/layout/WalletConnectButton';\nimport { useDynamicTitle } from '@/hooks/utils/useDynamicTitle';\nimport PriceTicker from '@/components/layout/PriceTicker';\nimport { useMarket } from '@/features/trading/contexts/MarketContext';\nimport MobileMarketDetails from '../trade-content/MobileMarketDetails';\nimport MobileOrderTabs from '../trade-content/MobileOrderTabs';\n\ninterface MarketData {\n  priceChangePercent?: string;\n  high24h?: string;\n  low24h?: string;\n  volume24h?: string;\n  openInterestValue?: string;\n}\n\ninterface ActiveMarket {\n  symbol?: string;\n  logoUrl?: string;\n}\n\nexport default function MarketPageContent() {\n  const { activeMarket, currentPrice } = useMarket();\n  const [isMobileOrderPanelOpen, setIsMobileOrderPanelOpen] = useState(false);\n  const [isMobileCoinInfoOpen, setIsMobileCoinInfoOpen] = useState(false);\n  const [mobileActiveTab, setMobileActiveTab] = useState<'long' | 'short' | 'swap'>('long');\n  const [marketDataState, setMarketDataState] = useState<MarketData | null>(null);\n  const [activeMarketState, setActiveMarketState] = useState<ActiveMarket | null>(null);\n\n  // Dynamic title with price and pair\n  const priceValue = currentPrice ? parseFloat(currentPrice) : null;\n  const pairName = activeMarket?.symbol || 'BTC/USDT';\n  useDynamicTitle(priceValue, pairName);\n\n  // Listen for mobile coin info toggle event\n  useEffect(() => {\n    const handleToggleCoinInfo = (event: CustomEvent) => {\n      setIsMobileCoinInfoOpen((prev) => !prev);\n      if (event.detail?.marketData) {\n        setMarketDataState(event.detail.marketData);\n      }\n      if (event.detail?.activeMarket) {\n        setActiveMarketState(event.detail.activeMarket);\n      }\n    };\n\n    window.addEventListener('toggleMobileCoinInfo', handleToggleCoinInfo as EventListener);\n    return () =>\n      window.removeEventListener('toggleMobileCoinInfo', handleToggleCoinInfo as EventListener);\n  }, []);\n\n  return (\n    <main className=\"bg-trading-dark text-text-primary h-screen flex flex-col relative lg:p-2 p-2 lg:overflow-hidden overflow-auto\">\n      {/* Mobile Header */}\n      <MobileHeader rightContent={<WalletConnectButton />} />\n\n      <div\n        className=\"flex flex-col lg:flex-row w-full flex-1 lg:gap-2 gap-2 lg:overflow-hidden\"\n        style={{ minHeight: 0 }}\n      >\n        {/* Left Sidebar - Responsive */}\n        <Sidebar>\n          <SidebarContent />\n        </Sidebar>\n\n        {/* Center - Chart and Bottom Trading */}\n        <div\n          className=\"lg:flex-1 flex flex-col min-w-0 relative lg:gap-2\"\n          style={{ minHeight: 0, gap: '0.5rem' }}\n        >\n          {/* Trading Chart */}\n          <div\n            className=\"transition-all duration-300 relative flex-1\"\n            style={{\n              minHeight: '400px',\n              display: 'flex',\n              flexDirection: 'column',\n            }}\n          >\n            <TradingChart />\n\n            {/* Mobile Market Details Dropdown - Below Chart Header */}\n            <MobileMarketDetails\n              isOpen={isMobileCoinInfoOpen}\n              marketData={marketDataState}\n              activeMarket={activeMarketState || activeMarket}\n              currentPrice={currentPrice}\n            />\n          </div>\n\n          {/* Bottom Trading Panel - Regular layout */}\n          <div\n            className=\"lg:flex-1 transition-all duration-300 mb-20 lg:mb-0\"\n            style={{\n              minHeight: '400px',\n              maxHeight: '40vh',\n            }}\n          >\n            <BottomTrading />\n          </div>\n        </div>\n\n        {/* Right Order Panel - Hidden on mobile */}\n        <div\n          className=\"hidden lg:flex shrink-0 flex-col\"\n          style={{\n            width: '30vw',\n            minWidth: '300px',\n            maxWidth: '520px',\n          }}\n        >\n          <OrderPanel mode=\"market\" />\n        </div>\n\n        {/* Mobile Order Panel - Bottom Sheet */}\n        <div className=\"lg:hidden fixed bottom-0 left-0 right-0 z-50\">\n          {/* Long/Short/Swap Tabs */}\n          {!isMobileOrderPanelOpen && (\n            <MobileOrderTabs\n              mobileActiveTab={mobileActiveTab}\n              onTabClick={(tab) => {\n                setMobileActiveTab(tab);\n                setIsMobileOrderPanelOpen(true);\n              }}\n            />\n          )}\n\n          {/* Bottom Sheet Panel */}\n          {isMobileOrderPanelOpen && (\n            <>\n              {/* Backdrop - Click to close */}\n              <div\n                className=\"fixed inset-0 bg-black/40 -z-10\"\n                onClick={() => setIsMobileOrderPanelOpen(false)}\n              />\n\n              {/* Panel */}\n              <div\n                className=\"bg-[#0B1017] shadow-2xl animate-slide-up rounded-t-lg\"\n                style={{ maxHeight: '85vh', overflowY: 'auto' }}\n              >\n                {/* Order Panel Content */}\n                <OrderPanel mobileActiveTab={mobileActiveTab} mode=\"market\" />\n              </div>\n            </>\n          )}\n        </div>\n      </div>\n\n      {/* Price Ticker at bottom */}\n      <PriceTicker />\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;AAee,SAAS;IACtB,MAAM,EAAE,YAAY,EAAE,YAAY,EAAE,GAAG,IAAA,qKAAS;IAChD,MAAM,CAAC,wBAAwB,0BAA0B,GAAG,IAAA,iNAAQ,EAAC;IACrE,MAAM,CAAC,sBAAsB,wBAAwB,GAAG,IAAA,iNAAQ,EAAC;IACjE,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,iNAAQ,EAA4B;IAClF,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,iNAAQ,EAAoB;IAC1E,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,iNAAQ,EAAsB;IAEhF,oCAAoC;IACpC,MAAM,aAAa,eAAe,WAAW,gBAAgB;IAC7D,MAAM,WAAW,cAAc,UAAU;IACzC,IAAA,2JAAe,EAAC,YAAY;IAE5B,2CAA2C;IAC3C,IAAA,kNAAS,EAAC;QACR,MAAM,uBAAuB,CAAC;YAC5B,wBAAwB,CAAC,OAAS,CAAC;YACnC,IAAI,MAAM,MAAM,EAAE,YAAY;gBAC5B,mBAAmB,MAAM,MAAM,CAAC,UAAU;YAC5C;YACA,IAAI,MAAM,MAAM,EAAE,cAAc;gBAC9B,qBAAqB,MAAM,MAAM,CAAC,YAAY;YAChD;QACF;QAEA,OAAO,gBAAgB,CAAC,wBAAwB;QAChD,OAAO,IACL,OAAO,mBAAmB,CAAC,wBAAwB;IACvD,GAAG,EAAE;IAEL,qBACE,8OAAC;QAAK,WAAU;;0BAEd,8OAAC,uJAAY;gBAAC,4BAAc,8OAAC,8JAAmB;;;;;;;;;;0BAEhD,8OAAC;gBACC,WAAU;gBACV,OAAO;oBAAE,WAAW;gBAAE;;kCAGtB,8OAAC,4JAAO;kCACN,cAAA,8OAAC,yJAAc;;;;;;;;;;kCAIjB,8OAAC;wBACC,WAAU;wBACV,OAAO;4BAAE,WAAW;4BAAG,KAAK;wBAAS;;0CAGrC,8OAAC;gCACC,WAAU;gCACV,OAAO;oCACL,WAAW;oCACX,SAAS;oCACT,eAAe;gCACjB;;kDAEA,8OAAC,8KAAY;;;;;kDAGb,8OAAC,+LAAmB;wCAClB,QAAQ;wCACR,YAAY;wCACZ,cAAc,qBAAqB;wCACnC,cAAc;;;;;;;;;;;;0CAKlB,8OAAC;gCACC,WAAU;gCACV,OAAO;oCACL,WAAW;oCACX,WAAW;gCACb;0CAEA,cAAA,8OAAC,wJAAa;;;;;;;;;;;;;;;;kCAKlB,8OAAC;wBACC,WAAU;wBACV,OAAO;4BACL,OAAO;4BACP,UAAU;4BACV,UAAU;wBACZ;kCAEA,cAAA,8OAAC,4KAAU;4BAAC,MAAK;;;;;;;;;;;kCAInB,8OAAC;wBAAI,WAAU;;4BAEZ,CAAC,wCACA,8OAAC,2LAAe;gCACd,iBAAiB;gCACjB,YAAY,CAAC;oCACX,mBAAmB;oCACnB,0BAA0B;gCAC5B;;;;;;4BAKH,wCACC;;kDAEE,8OAAC;wCACC,WAAU;wCACV,SAAS,IAAM,0BAA0B;;;;;;kDAI3C,8OAAC;wCACC,WAAU;wCACV,OAAO;4CAAE,WAAW;4CAAQ,WAAW;wCAAO;kDAG9C,cAAA,8OAAC,4KAAU;4CAAC,iBAAiB;4CAAiB,MAAK;;;;;;;;;;;;;;;;;;;;;;;;;0BAQ7D,8OAAC,sJAAW;;;;;;;;;;;AAGlB"}}]
}